<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [jdev] That presence problem again
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:jdev%40jabber.org?Subject=Re%3A%20%5Bjdev%5D%20That%20presence%20problem%20again&In-Reply-To=%3C20070420215631.GA9100%40elmex%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="084781.html">
   <LINK REL="Next"  HREF="084783.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[jdev] That presence problem again</H1>
    <B>Robin Redeker</B> 
    <A HREF="mailto:jdev%40jabber.org?Subject=Re%3A%20%5Bjdev%5D%20That%20presence%20problem%20again&In-Reply-To=%3C20070420215631.GA9100%40elmex%3E"
       TITLE="[jdev] That presence problem again">elmex at x-paste.de
       </A><BR>
    <I>Fri Apr 20 16:56:31 CDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="084781.html">[jdev] That presence problem again
</A></li>
        <LI>Next message: <A HREF="084783.html">[jdev] That presence problem again
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#84782">[ date ]</a>
              <a href="thread.html#84782">[ thread ]</a>
              <a href="subject.html#84782">[ subject ]</a>
              <a href="author.html#84782">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Sat, Apr 21, 2007 at 04:38:02AM +1000, Bruce Campbell wrote:
&gt;<i> 
</I>&gt;<i> This more of a 'what are people doing now' question, not a 'what should 
</I>&gt;<i> the implementations be doing'.
</I>&gt;<i> 
</I>&gt;<i> Lets say that my Jabber client has an avid desire to know the accurate 
</I>&gt;<i> online status of remote JIDs, and the roster subscriptions are 'both'.
</I>
I don't think there is anything wrong or weird with that desire :-)
It seems to me that this is what XMPP (Extensible Messaging and &gt;Presence&lt; Protocol)
was invented for...

If it is not possible to know a mostly accurate status if anything unexpected
happens (even if the TCP connection breaks I at least know that
I don't know the presence state), then there is something deeply broken :-)

&gt;<i> To that end, my client makes the assumption that if no update to the status 
</I>&gt;<i> has been received in an hour, then something has possibly happened to the 
</I>&gt;<i> remote JID that hasn't been properly pushed to my client (remote server 
</I>&gt;<i> restart normally ).
</I>&gt;<i> 
</I>&gt;<i> How should my Jabber _client_ get the latest news about the remote JID?
</I>
That is an interesting problem. I'm currently also writing a client
but I haven't thought of that problem yet. If the remote server reboots
noone will be noticed of any presence changes (eg. client became
unavailable).

That indeed means clients have to probe on their own. But the
RFC unfortunately says: 'probe -- A request for an entity's current
presence; SHOULD be generated only by a server on behalf of a user.'
(RFC 3921 2.2.1 Types of Presence)


&gt;<i> The solutions that I've tried to get this information are:
</I>&gt;<i> 
</I>&gt;<i>   A) Presence probes.  Swallowed by some servers.
</I>&gt;<i> 	&lt;presence to='<A HREF="http://mail.jabber.org/mailman/listinfo/jdev">remoteJID at some.where</A>' type='probe'/&gt;
</I>&gt;<i>       or
</I>&gt;<i> 	&lt;presence to='<A HREF="http://mail.jabber.org/mailman/listinfo/jdev">remoteJID at some.where</A>' from='<A HREF="http://mail.jabber.org/mailman/listinfo/jdev">me at my.domain</A>' 
</I>&gt;<i> 	type='probe'/&gt;
</I>&gt;<i> 
</I>&gt;<i>   B) Directed presence saying unavailable then available again.
</I>&gt;<i> 	&lt;presence to='<A HREF="http://mail.jabber.org/mailman/listinfo/jdev">remoteJID at some.where</A>' type='unavailable'/&gt;
</I>&gt;<i> 	&lt;presence to='<A HREF="http://mail.jabber.org/mailman/listinfo/jdev">remoteJID at some.where</A>'/&gt;
</I>&gt;<i> 
</I>&gt;<i>   C) Subscribe to their presence again.
</I>&gt;<i> 	&lt;presence to='<A HREF="http://mail.jabber.org/mailman/listinfo/jdev">remoteJID at some.where</A>' type='subscribe'/&gt;
</I>
Uh, thats ugly but I like that more than B) or D) :-)

&gt;<i>   D) Unavailable then available again to the entire roster.
</I>&gt;<i> 	&lt;presence type='unavailable/&gt;&lt;presence/&gt;
</I>&gt;<i> 
</I>&gt;<i> Of these, the 'subscribe' trick seems to be the most consistent at 
</I>&gt;<i> returning the desired information.  'probe's seem to get swallowed by a 
</I>&gt;<i> number of servers, and appearing to go offline and online again just 
</I>&gt;<i> irritates the remote users.
</I>
Heh, I agree completly that this is indeed not very nice.

&gt;<i> Any other tricks that people use?
</I>
I would rather see this issue resolved than seeing 'tricks' that
'somehow' work or introduce weird behaviour (like D) or B)).


Greetings,
   Robin

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="084781.html">[jdev] That presence problem again
</A></li>
	<LI>Next message: <A HREF="084783.html">[jdev] That presence problem again
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#84782">[ date ]</a>
              <a href="thread.html#84782">[ thread ]</a>
              <a href="subject.html#84782">[ subject ]</a>
              <a href="author.html#84782">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://mail.jabber.org/mailman/listinfo/jdev">More information about the JDev
mailing list</a><br>
</body></html>
