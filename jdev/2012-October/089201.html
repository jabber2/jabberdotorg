<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [jdev] Question on Presence, Invisibility and MUC
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:jdev%40jabber.org?Subject=Re%3A%20%5Bjdev%5D%20Question%20on%20Presence%2C%20Invisibility%20and%20MUC&In-Reply-To=%3CCAGYOVV0ezY3_yYReq4xYTPqCvg6C7HGMCmvM4bU6%2BfP5QPqhLg%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="089200.html">
   <LINK REL="Next"  HREF="089202.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[jdev] Question on Presence, Invisibility and MUC</H1>
    <B>Daniel Dormont</B> 
    <A HREF="mailto:jdev%40jabber.org?Subject=Re%3A%20%5Bjdev%5D%20Question%20on%20Presence%2C%20Invisibility%20and%20MUC&In-Reply-To=%3CCAGYOVV0ezY3_yYReq4xYTPqCvg6C7HGMCmvM4bU6%2BfP5QPqhLg%40mail.gmail.com%3E"
       TITLE="[jdev] Question on Presence, Invisibility and MUC">dan at greywallsoftware.com
       </A><BR>
    <I>Fri Oct 12 14:39:22 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="089200.html">[jdev] Strange Smack SASL response encoding implementation
</A></li>
        <LI>Next message: <A HREF="089202.html">[jdev] Question on Presence, Invisibility and MUC
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#89201">[ date ]</a>
              <a href="thread.html#89201">[ thread ]</a>
              <a href="subject.html#89201">[ subject ]</a>
              <a href="author.html#89201">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi all,

In my XMPP application, users can exchange both private messages and
presence and join MUCs. Ok, simple enough. I've implemented invisibility
according to XEP-0126. I'd like the users to be still able to join MUCs
while invisible, though. The issue I'm running into is that the first step
in going invisible is sending an unavailable presence for broadcasting to
all contacts: &lt;presence type='unavailable'/&gt;

Unfortunately for me, this has the additional effect of kicking the user
out of any MUCs they'd joined in that particular session. I've already
figured out how to tweak the privacy list so users can join MUCs while
invisible to individual contacts, basically it just looks like

    &lt;list name='invisible'&gt;
      &lt;item type='jid'
            value='conference.mydomain'
            action='allow'
            order='1'&gt;
        &lt;presence-out/&gt;
      &lt;/item&gt;
      &lt;item action='deny' order='2'&gt;
        &lt;presence-out/&gt;
      &lt;/item&gt;
    &lt;/list&gt;

But I'm running into this problem when the user tries to go &quot;globally&quot;
invisible while already in one or more MUCs. Is there any way around this?
My initial thought was to direct the unavailable presence to only the
primary (IM) domain rather than having no &quot;to&quot; as indicated in the XEP, but
that doesn't seem to broadcast to anybody, so contacts who already thought
the user was online will continue to think so.

Is there any way around this? Or will I have to change my approach to
invisibility?

thanks,
Dan
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="https://www.jabber.org/jdev/attachments/20121012/18182d1f/attachment.html">https://www.jabber.org/jdev/attachments/20121012/18182d1f/attachment.html</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="089200.html">[jdev] Strange Smack SASL response encoding implementation
</A></li>
	<LI>Next message: <A HREF="089202.html">[jdev] Question on Presence, Invisibility and MUC
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#89201">[ date ]</a>
              <a href="thread.html#89201">[ thread ]</a>
              <a href="subject.html#89201">[ subject ]</a>
              <a href="author.html#89201">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://mail.jabber.org/mailman/listinfo/jdev">More information about the JDev
mailing list</a><br>
</body></html>
