<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [jdev] The future of Jabber/XMPP?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:jdev%40jabber.org?Subject=Re%3A%20%5Bjdev%5D%20The%20future%20of%20Jabber/XMPP%3F&In-Reply-To=%3C4C77EEB6.9040204%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="088392.html">
   <LINK REL="Next"  HREF="088396.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[jdev] The future of Jabber/XMPP?</H1>
    <B>Evgeniy Khramtsov</B> 
    <A HREF="mailto:jdev%40jabber.org?Subject=Re%3A%20%5Bjdev%5D%20The%20future%20of%20Jabber/XMPP%3F&In-Reply-To=%3C4C77EEB6.9040204%40gmail.com%3E"
       TITLE="[jdev] The future of Jabber/XMPP?">xramtsov at gmail.com
       </A><BR>
    <I>Fri Aug 27 11:58:30 CDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="088392.html">[jdev] The future of Jabber/XMPP?
</A></li>
        <LI>Next message: <A HREF="088396.html">[jdev] The future of Jabber/XMPP?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#88393">[ date ]</a>
              <a href="thread.html#88393">[ thread ]</a>
              <a href="subject.html#88393">[ subject ]</a>
              <a href="author.html#88393">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>28.08.2010 02:36, Waqas Hussain wrote:
&gt;<i> Let's see.. 1M PEP nodes, with say.. 1K subscribers each. And server2
</I>&gt;<i> has max 2M resources.
</I>&gt;<i>
</I>&gt;<i> On top, let's assume 10K different client configurations (i.e., 10K
</I>&gt;<i> caps hashes).
</I>&gt;<i>
</I>&gt;<i> Here's what it might look like in Prosody:
</I>&gt;<i>
</I>&gt;<i> 1. A table of strings with all JIDs (2M resources * 3KB maximum JID
</I>&gt;<i> size = 6GB maximum).
</I>&gt;<i> 2. A table of local accounts mapped to list of subscriptions. Each
</I>&gt;<i> subscription is just two pointers (one to a shared caps hash table,
</I>&gt;<i> and one to a JID). 1M * 64 bytes = 64MB (just roughly picked 64
</I>&gt;<i> bytes).
</I>&gt;<i> 3. The caps hash table, mapping caps hashes to a list of +notify
</I>&gt;<i> namespaces. Assume one caps hash and list takes 4KB, we have 4KB * 10K
</I>&gt;<i> = 40MB (strings are shared, so this is likely a lot less).
</I>&gt;<i>
</I>&gt;<i> This is a simplistic view, and the string table for example is strings
</I>&gt;<i> interned by Lua. I've tried to pick larger values than I actually
</I>&gt;<i> expect to see in the wild (e.g., I assumed everyone has 3KB JIDs).
</I>&gt;<i>
</I>&gt;<i> But still, that's only a bit more than 6GB for a massive number of
</I>&gt;<i> nodes and subscriptions. I could even try simulating this, and don't
</I>&gt;<i> expect it to kill a server with hardware like jabber.org's.
</I>&gt;<i>
</I>&gt;<i> I made the assumption that there are 10K different caps hashes. Let's
</I>&gt;<i> drop that now. Every resource has a unique caps hash (they are
</I>&gt;<i> malicious or crazy or something). That's.. 2M * 4K = 8GB of caps data.
</I>&gt;<i> The total is still under the 16GB of physical RAM jabber.org has :)
</I>&gt;<i>
</I>&gt;<i> Mind you, this was only a quick back of the envelope calculation :)
</I>&gt;<i>    
</I>
Good point :) And now lets take a PEP message, encapsulate it in a 
multicast message with all subscribers and it will target at least one 
subscriber with very high probability. Of course, I'm not in a very 
comfortable position, because it is not so simple to count traffic, but 
nowadays I can't say if the overhead will be really great because of 
TLS-compressed links and the fact that lots of clients support PEP :)

-- 
Regards,
Evgeniy Khramtsov, ProcessOne.
xmpp:<A HREF="http://mail.jabber.org/mailman/listinfo/jdev">xram at jabber.ru.</A>

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="https://www.jabber.org/jdev/attachments/20100828/e7fcadbd/attachment.htm">https://www.jabber.org/jdev/attachments/20100828/e7fcadbd/attachment.htm</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="088392.html">[jdev] The future of Jabber/XMPP?
</A></li>
	<LI>Next message: <A HREF="088396.html">[jdev] The future of Jabber/XMPP?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#88393">[ date ]</a>
              <a href="thread.html#88393">[ thread ]</a>
              <a href="subject.html#88393">[ subject ]</a>
              <a href="author.html#88393">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://mail.jabber.org/mailman/listinfo/jdev">More information about the JDev
mailing list</a><br>
</body></html>
