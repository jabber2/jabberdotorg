<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [JDEV] xdb_mysql question
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:jdev%40jabber.org?Subject=Re%3A%20%5BJDEV%5D%20xdb_mysql%20question&In-Reply-To=%3C006501c24dec%242af1de70%240300a8c0%40FRAN%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="043342.html">
   <LINK REL="Next"  HREF="043345.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[JDEV] xdb_mysql question</H1>
    <B>PpDorApa</B> 
    <A HREF="mailto:jdev%40jabber.org?Subject=Re%3A%20%5BJDEV%5D%20xdb_mysql%20question&In-Reply-To=%3C006501c24dec%242af1de70%240300a8c0%40FRAN%3E"
       TITLE="[JDEV] xdb_mysql question">jabbermail at fibertel.com.ar
       </A><BR>
    <I>Tue Aug 27 12:07:04 CDT 2002</I>
    <P><UL>
        <LI>Previous message: <A HREF="043342.html">[JDEV] xdb_mysql question
</A></li>
        <LI>Next message: <A HREF="043345.html">[JDEV] xdb_mysql question
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#43344">[ date ]</a>
              <a href="thread.html#43344">[ thread ]</a>
              <a href="subject.html#43344">[ subject ]</a>
              <a href="author.html#43344">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Samer.. thanks i read the readme several times..  but im not an english
speaker so sometimes its more difficult 4 the rest of the non english
speaker... (maybe everybody has to know that)

if anyone install xdb_mysql and can tell me how they install it, i will be
very appreciate..
thanks in advice..
PPd

PD:cause i install it but i cannot run jabberd..


----- Original Message -----
From: &quot;Sameer Verma&quot; &lt;<A HREF="http://mail.jabber.org/mailman/listinfo/jdev">sverma at sfsu.edu</A>&gt;
To: &lt;<A HREF="http://mail.jabber.org/mailman/listinfo/jdev">jdev at jabber.org</A>&gt;
Sent: Tuesday, August 27, 2002 1:34 PM
Subject: Re: [JDEV] xdb_mysql question


&gt;<i> PpDorApa wrote:
</I>&gt;<i>
</I>&gt;<i> &gt;i am trying to install jadc2s.. 4 that i have to change xdb_file to
</I>&gt;<i> &gt;xdb_mysql..
</I>&gt;<i> &gt;i install xdb_mysql but jabberd doesnt run it gave me this error:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;Error: invalid  tag type xdb_sql
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;4 sure i am making something wrong.. if anyone can help me i will be
</I>&gt;<i> &gt;appreciate..
</I>&gt;<i> &gt;thanks in advice..
</I>&gt;<i> &gt;Ppdorapa
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;_______________________________________________
</I>&gt;<i> &gt;jdev mailing list
</I>&gt;<i> &gt;<A HREF="http://mail.jabber.org/mailman/listinfo/jdev">jdev at jabber.org</A>
</I>&gt;<i> &gt;<A HREF="http://mailman.jabber.org/listinfo/jdev">http://mailman.jabber.org/listinfo/jdev</A>
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> <A HREF="http://download.jabber.org/contrib/">http://download.jabber.org/contrib/</A>
</I>&gt;<i>
</I>&gt;<i> Here's the Readme:
</I>&gt;<i>
</I>&gt;<i> Sameer
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> Sameer Verma, Ph.D.
</I>&gt;<i> Asst. Professor of Information Systems
</I>&gt;<i> San Francisco State University
</I>&gt;<i> San Francisco CA 94132 USA
</I>&gt;<i> <A HREF="http://verma.sfsu.edu/">http://verma.sfsu.edu/</A>
</I>&gt;<i>
</I>&gt;<i>
</I>++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
&gt;<i> $Id: README,v 1.5 2001/03/19 17:08:45 jpinon Exp $
</I>&gt;<i>
</I>&gt;<i> xdb_sql
</I>&gt;<i>
</I>&gt;<i> Release 1.0
</I>&gt;<i>
</I>&gt;<i> This an xdb implementation for Jabber 1.4 and later using an SQL database.
</I>&gt;<i> It is heavily based on xdb_mysql (by the Jabber Team) from Jabber 1.0.
</I>&gt;<i>
</I>&gt;<i> xdb_sql is standalone, to keep MySQL/Postgresql/... details outside
</I>Jabber.
&gt;<i>
</I>&gt;<i>
</I>&gt;<i> This code was developped by IDEALX (<A HREF="http://www.IDEALX.org">http://www.IDEALX.org</A>), for
</I>&gt;<i> LibertySurf T&#233;l&#233;com (<A HREF="http://www.libertysurftelecom.fr">http://www.libertysurftelecom.fr</A>).
</I>&gt;<i>
</I>&gt;<i> This program is Open Source software and is subject to specific
</I>&gt;<i> conditions of distribution and modification (see the COPYING file).
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ***
</I>&gt;<i> Installation:
</I>&gt;<i>
</I>&gt;<i> &quot;Standard&quot; installs of mysql and postgres should be found automatically.
</I>&gt;<i>
</I>&gt;<i> Use xdb_sql.xml as config file for xdb_sql (it contains explanations
</I>&gt;<i> on how to use it from jabber.xml).  The database can be created with
</I>&gt;<i> the help of sample_database.sql for mysql or sample_database.pg.sql
</I>&gt;<i>
</I>&gt;<i> ***
</I>&gt;<i>
</I>&gt;<i> In xdb_mysql, SQL requests were not hardcoded, but instead given in a
</I>&gt;<i> configuration file. Thus entire liberty is given for the tables layout.
</I>&gt;<i>
</I>&gt;<i> The sample SQL tables and related XML config are from xdb_mysql,
</I>&gt;<i> with slight modifications for the new functionnalities.
</I>&gt;<i>
</I>&gt;<i> Supported namespaces:
</I>&gt;<i> * jabber:iq:register
</I>&gt;<i> * jabber:iq:auth
</I>&gt;<i>
</I>&gt;<i> * jabber:iq:roster
</I>&gt;<i>     Store user and group roster
</I>&gt;<i>
</I>&gt;<i> * jabber:x:offline
</I>&gt;<i>     Store offline messages
</I>&gt;<i>
</I>&gt;<i> * jabber:iq:filter
</I>&gt;<i>     Support the &quot;from&quot; condition, without action (blacklist)
</I>&gt;<i>
</I>&gt;<i> ***
</I>&gt;<i> General note on querydefs :
</I>&gt;<i>
</I>&gt;<i> querydefs are given in the config file, and handle the SQL/XML mapping.
</I>&gt;<i> Usually, an xdb_get translate to a SELECT, and an xdb_set
</I>&gt;<i> translates to a DELETE or UPDATE, followed with an
</I>&gt;<i> INSERT or UPDATE. But it depends on your particular
</I>&gt;<i> database layout, and the concerned namespace.
</I>&gt;<i>
</I>&gt;<i> In the &lt;text&gt; node, you have the SQL query, with special
</I>&gt;<i> words which will be substitued atr query time (these are
</I>&gt;<i> the $$foo$$ words).
</I>&gt;<i>
</I>&gt;<i> &lt;bindvar&gt; substitutes a query parameter.
</I>&gt;<i> &lt;bindcol&gt; allows to retrieve an SQL result field (after a SELECT query)
</I>&gt;<i>
</I>&gt;<i> ***
</I>&gt;<i> Configuration and extensibility :
</I>&gt;<i>
</I>&gt;<i> There's the old, powerful but painful way, and the new,
</I>&gt;<i> simple, generic way.
</I>&gt;<i>
</I>&gt;<i> 1. The old, powerful, painful way :
</I>&gt;<i>
</I>&gt;<i> xdb_mysql, then xdb_sql, used both a config file and C code
</I>&gt;<i> to handle SQL/XML mapping.
</I>&gt;<i> To add a new namespace, go to xdb_sql_config.c :
</I>&gt;<i> * check if existing validators (validate_xxx)
</I>&gt;<i>   can fit your queries (validate_simple_user is often useful)
</I>&gt;<i>    * if yes :
</I>&gt;<i>       * good !
</I>&gt;<i>    * if not :
</I>&gt;<i>       * add new validator function
</I>&gt;<i>       * add validator declaration with others
</I>&gt;<i> * insert query name and validator ptr into s_query_table array
</I>&gt;<i> * create a new source file with the set/get functions
</I>&gt;<i> * insert the source name in Makefile.am
</I>&gt;<i> * insert functions declarations in xdb_sql.h
</I>&gt;<i> * insert functions ptrs and namespace into static_modules
</I>&gt;<i> * insert queries in the XML config file
</I>&gt;<i>
</I>&gt;<i> 2. The new, simple, generic way (dtd=&quot;2&quot;)
</I>&gt;<i>
</I>&gt;<i> In xdb_sql, a new query config format has been added,
</I>&gt;<i> which allow to support moderatly complex processing on xml nodes
</I>&gt;<i> without adding C code (before, a small part of code was needed to
</I>&gt;<i> fetch/store SQL params/results from/to XML nodes).
</I>&gt;<i> These are the &lt;querydef&gt; with attribute dtd=&quot;2&quot;.
</I>&gt;<i>
</I>&gt;<i> On a xdb_set, it will try to execute N queries if N query datas
</I>&gt;<i> are supplied. On a xdb_set, the N tuples will be stored
</I>&gt;<i> in a given top node and optionnaly a per-tuple node.
</I>&gt;<i>
</I>&gt;<i> Example 1:
</I>&gt;<i> xdb_set on a &quot;jabber:iq:url&quot; namespace to store an URL
</I>&gt;<i> associated with an user:
</I>&gt;<i>
</I>&gt;<i>       &lt;querydef name=&quot;url-set&quot; dtd=&quot;2&quot; type=&quot;set&quot;
</I>namespace=&quot;jabber:iq:url&quot;&gt;
&gt;<i>         &lt;text&gt;
</I>&gt;<i>           UPDATE user SET site = '$$domain$$',
</I>&gt;<i>                               page = '$$file$$'
</I>&gt;<i>           WHERE jid = '$$user$$'&lt;/text&gt;
</I>&gt;<i>         &lt;user&gt;$$user$$&lt;/user&gt;
</I>&gt;<i>         &lt;bindvar tag=&quot;domain&quot;&gt;$$domain$$&lt;/bindvar&gt;
</I>&gt;<i>         &lt;bindvar tag=&quot;file&quot;&gt;$$file$$&lt;/bindvar&gt;
</I>&gt;<i> &lt;purge&gt;url-remove&lt;/purge&gt;
</I>&gt;<i>       &lt;/querydef&gt;
</I>&gt;<i>
</I>&gt;<i> querydef:
</I>&gt;<i>   name is mostly for humans and referencing;
</I>&gt;<i>   dtd will allow correct handling of the configuration;
</I>&gt;<i>   type is important for query dispatch, as is namespace;
</I>&gt;<i>
</I>&gt;<i> text: SQL query template;
</I>&gt;<i> user: to substitute in text;
</I>&gt;<i> bindvar: will retrieve the cdata of the given tag in the
</I>&gt;<i> supplied xmlnode (this is used in an xdb_set), and substitute
</I>&gt;<i> this value in the text;
</I>&gt;<i> purge: name of a querydef executed prior to any set query.
</I>&gt;<i>
</I>&gt;<i> Example 2:
</I>&gt;<i> xdb_get:
</I>&gt;<i>
</I>&gt;<i>       &lt;querydef name=&quot;url-get&quot; dtd=&quot;2&quot; type=&quot;get&quot;
</I>namespace=&quot;jabber:iq:url&quot;&gt;
&gt;<i>         &lt;text&gt;
</I>&gt;<i>           SELECT site, page FROM user WHERE jid = '$$u$$'
</I>&gt;<i>         &lt;/text&gt;
</I>&gt;<i>         &lt;user&gt;$$u$$&lt;/user&gt;
</I>&gt;<i>         &lt;top-result&gt;
</I>&gt;<i>            &lt;x xmlns='jabber:iq:url'/&gt;
</I>&gt;<i>         &lt;/top-result&gt;
</I>&gt;<i>         &lt;bindcol tag=&quot;domain&quot; offset=&quot;0&quot;/&gt;
</I>&gt;<i>         &lt;bindcol tag=&quot;file&quot; offset=&quot;1&quot;/&gt;
</I>&gt;<i>       &lt;/querydef&gt;
</I>&gt;<i>
</I>&gt;<i> top-result: node created to contain query results
</I>&gt;<i> bindcol: will store the value found in field 0 of each tuple
</I>&gt;<i> as cdata for a node domain inserted in top-result.
</I>&gt;<i>
</I>&gt;<i> It is possible to specify a node created for each tuple,
</I>&gt;<i> using tuple-node as child of the querydef.
</I>&gt;<i> Example: &lt;tuple-node&gt;&lt;item/&gt;&lt;/tuple-node&gt;
</I>&gt;<i>
</I>&gt;<i> Values will be inserted in the tuple-related node, and if
</I>&gt;<i> none exists, they will be inserted in the top-result node
</I>&gt;<i> (because the inner node is tried first).
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> jdev mailing list
</I>&gt;<i> <A HREF="http://mail.jabber.org/mailman/listinfo/jdev">jdev at jabber.org</A>
</I>&gt;<i> <A HREF="http://mailman.jabber.org/listinfo/jdev">http://mailman.jabber.org/listinfo/jdev</A>
</I>&gt;<i>
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="043342.html">[JDEV] xdb_mysql question
</A></li>
	<LI>Next message: <A HREF="043345.html">[JDEV] xdb_mysql question
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#43344">[ date ]</a>
              <a href="thread.html#43344">[ thread ]</a>
              <a href="subject.html#43344">[ subject ]</a>
              <a href="author.html#43344">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://mail.jabber.org/mailman/listinfo/jdev">More information about the JDev
mailing list</a><br>
</body></html>
