<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [jdev] XEP-0115 Caps Verification
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:jdev%40jabber.org?Subject=Re%3A%20%5Bjdev%5D%20XEP-0115%20Caps%20Verification&In-Reply-To=%3CAANLkTinsBR92foumgyntODyjW%2Bys7Rhm%2Bj-ne7w0RdWU%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="088416.html">
   <LINK REL="Next"  HREF="088421.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[jdev] XEP-0115 Caps Verification</H1>
    <B>Matthew Wild</B> 
    <A HREF="mailto:jdev%40jabber.org?Subject=Re%3A%20%5Bjdev%5D%20XEP-0115%20Caps%20Verification&In-Reply-To=%3CAANLkTinsBR92foumgyntODyjW%2Bys7Rhm%2Bj-ne7w0RdWU%40mail.gmail.com%3E"
       TITLE="[jdev] XEP-0115 Caps Verification">mwild1 at gmail.com
       </A><BR>
    <I>Mon Sep 20 14:02:50 CST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="088416.html">[jdev] XEP-0115 Caps Verification
</A></li>
        <LI>Next message: <A HREF="088421.html">[jdev] XEP-0115 Caps Verification
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#88420">[ date ]</a>
              <a href="thread.html#88420">[ thread ]</a>
              <a href="subject.html#88420">[ subject ]</a>
              <a href="author.html#88420">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>(forgot to send this at the weekend)

2010/9/18 Remko Tron&#231;on &lt;<A HREF="http://mail.jabber.org/mailman/listinfo/jdev">remko at el-tramo.be</A>&gt;:
&gt;&gt;<i> As far as I know, Tkabber, Gajim and telepathy-gabble have correct
</I>&gt;&gt;<i> implementation (in TCL, Python and C).
</I>&gt;<i>
</I>&gt;<i> Yes, that I noticed. I'm asking about *in*correct implementations
</I>&gt;<i> though. We've been getting reports of failing verification for some
</I>&gt;<i> clients/libraries, and I wanted to double check if others also had the
</I>&gt;<i> same problem before reporting it (to make sure the problem isn't on
</I>&gt;<i> our side).
</I>&gt;<i>
</I>
Since this is something I've been curious about for a while as well, I
just wrote a quick script to test caps hashes. It's based on Prosody's
100% correct caps calculation code (just ask Waqas).

Running it logged into my own account received presence from 48
contacts. 32 had valid hashes, 14 had legacy caps, 6 had no caps at
all (mostly bots), and 2 had invalid caps. Of those with invalid caps,
one was a bot (mine, using gloox), the other was an N900 - but it may
be that it returned an error or empty disco result rather than an
invalid hash as such.

The repo is at <A HREF="http://code.matthewwild.co.uk/xmpp-capscan">http://code.matthewwild.co.uk/xmpp-capscan</A> but if you
don't have Verse installed already you can grab a standalone version
from <A HREF="http://matthewwild.co.uk/uploads/capscan.min.lua">http://matthewwild.co.uk/uploads/capscan.min.lua</A> . Depends on
LuaSocket and LuaExpat, liblua5.1-socket2 and liblua5.1-expat0 in
Debian/Ubuntu. If you want TLS you also need LuaSec (liblua5.1-sec1).
You also of course need Lua 5.1 (lua5.1) if you don't have it already.

Run with &quot;lua capscan <A HREF="http://mail.jabber.org/mailman/listinfo/jdev">you at yourdomain</A>&quot;, enter your password, and when
you think it has been running long enough just Ctrl+C it (give it half
a minute or so depending on the size of your roster). It will then
write out statistics to report.html in the current directory and exit.

If it wasn't clear, running this script actively queries the
disco#info and jabber:iq:version of each contact/client it receives
presence for (only once per full JID). Just making sure nobody can say
I didn't warn them :)

Regards,
Matthew

PS. It might be worth doing the same for vCard/avatar hashes at some
stage - I'm pretty sure I've seen a few clients get that wrong.
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="088416.html">[jdev] XEP-0115 Caps Verification
</A></li>
	<LI>Next message: <A HREF="088421.html">[jdev] XEP-0115 Caps Verification
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#88420">[ date ]</a>
              <a href="thread.html#88420">[ thread ]</a>
              <a href="subject.html#88420">[ subject ]</a>
              <a href="author.html#88420">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://mail.jabber.org/mailman/listinfo/jdev">More information about the JDev
mailing list</a><br>
</body></html>
