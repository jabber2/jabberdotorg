<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [jdev] XMPP on Android, Round #2
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:jdev%40jabber.org?Subject=Re%3A%20%5Bjdev%5D%20XMPP%20on%20Android%2C%20Round%20%232&In-Reply-To=%3C092a01cb7b65%2478233e00%246869ba00%24%40com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="088536.html">
   <LINK REL="Next"  HREF="088543.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[jdev] XMPP on Android, Round #2</H1>
    <B>Stephen Pendleton</B> 
    <A HREF="mailto:jdev%40jabber.org?Subject=Re%3A%20%5Bjdev%5D%20XMPP%20on%20Android%2C%20Round%20%232&In-Reply-To=%3C092a01cb7b65%2478233e00%246869ba00%24%40com%3E"
       TITLE="[jdev] XMPP on Android, Round #2">pendleto at movsoftware.com
       </A><BR>
    <I>Wed Nov  3 08:43:23 CST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="088536.html">[jdev] XMPP on Android, Round #2
</A></li>
        <LI>Next message: <A HREF="088543.html">[jdev] XMPP on Android, Round #2
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#88537">[ date ]</a>
              <a href="thread.html#88537">[ thread ]</a>
              <a href="subject.html#88537">[ subject ]</a>
              <a href="author.html#88537">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>

-----Original Message-----
From: <A HREF="http://mail.jabber.org/mailman/listinfo/jdev">jdev-bounces at jabber.org</A> [mailto:<A HREF="http://mail.jabber.org/mailman/listinfo/jdev">jdev-bounces at jabber.org</A>] On Behalf Of
Rene Treffer
Sent: Wednesday, November 03, 2010 5:16 AM
To: Jabber/XMPP software development list
Subject: Re: [jdev] XMPP on Android, Round #2
&gt;&gt;<i> -----Original Message-----
</I>&gt;&gt;<i> From: <A HREF="http://mail.jabber.org/mailman/listinfo/jdev">jdev-bounces at jabber.org</A> [mailto:<A HREF="http://mail.jabber.org/mailman/listinfo/jdev">jdev-bounces at jabber.org</A>] On Behalf
</I>&gt;<i> Of
</I>&gt;&gt;<i> Rene Treffer
</I>&gt;&gt;<i> Sent: Tuesday, November 02, 2010 4:09 PM
</I>&gt;&gt;<i> To: <A HREF="http://mail.jabber.org/mailman/listinfo/jdev">jdev at jabber.org</A>
</I>&gt;&gt;<i> Subject: Re: [jdev] XMPP on Android, Round #2
</I>&gt;<i>There is no wake lock for GSM/TCP. It simply doesn't exist. And you
</I>&gt;<i>*have* a TCP connection in your pocket, in the background, it's called
</I>&gt;<i>Cloud to Device. Wake Lock keeps your system in an awake state as if the
</I>&gt;<i>user would actually use it. Usefull e.g. for in-game animations. Useless
</I>&gt;<i>for network or general IO wait. It's usually held because you can't rely
</I>&gt;<i>e.g. on Thread.sleep, but you CAN reply on read() to terminate as soon
</I>&gt;<i>as there is data available. I've build everything to not rely on timing
</I>&gt;<i>but on events / wakeups caused by external sources.
</I>
&gt;<i>TCP gets killed after weeks on old kernels and after days for new
</I>&gt;<i>kernels. Where did you get the assumption that TCP would get killed all
</I>&gt;<i>the time?
</I>
I'm not sure what you mean by wake lock for GSM/TCP, nothing exists for
that. There is only wake locks that keep the CPU from sleeping, display from
turning off/etc. If you are using a time tick intent then you are implicitly
doing a CPU wake lock every tick. This is done automatically by the system
and isn't released until your onReceive is called. I am guessing you are
doing this every 60s or so along with a whitespace ping. Unless you do this
the TCP connection will get killed when the device CPU sleeps. If you aren't
seeing that on your device then there is some other process doing a partial
wake lock. In particular, certain versions of the Facebook client had a bug
where it never released the wake lock. Several (bad) Twitter clients also
maintain an open wake lock. There is a good app called Spare Parts in the
market that will give you insight into partial wake usage battery
information.

&gt;<i>You are assuming a 19:1 ratio. Thus you are doing feature negotation
</I>&gt;<i>with tls, zlib initialization and sasl.
</I>&gt;<i>- 3 stream header roundtrips / 6 xml openings,
</I>&gt;<i>- 4 Sasl stanzas
</I>&gt;<i>- 4 negotiation elements
</I>&gt;<i>- 1 resume
</I>
That's true, that is a lot of overhead for just resuming a stream! The other
point I mentioned that you are probably doing this anyway with a long lived
connection scheme as the device moves and loses and restores connectivity.
Plus the whitespace pings.

Anyway, the one great thing about open source is that different schemes can
be built relatively easily and compared.



</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="088536.html">[jdev] XMPP on Android, Round #2
</A></li>
	<LI>Next message: <A HREF="088543.html">[jdev] XMPP on Android, Round #2
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#88537">[ date ]</a>
              <a href="thread.html#88537">[ thread ]</a>
              <a href="subject.html#88537">[ subject ]</a>
              <a href="author.html#88537">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://mail.jabber.org/mailman/listinfo/jdev">More information about the JDev
mailing list</a><br>
</body></html>
