<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [jdev] Understanding target SOCKS5 connection flow with	streamhost/requester
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:jdev%40jabber.org?Subject=Re%3A%20%5Bjdev%5D%20Understanding%20target%20SOCKS5%20connection%20flow%20with%0A%09streamhost/requester&In-Reply-To=%3C404751.93045.qm%40web31805.mail.mud.yahoo.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="088545.html">
   <LINK REL="Next"  HREF="088548.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[jdev] Understanding target SOCKS5 connection flow with	streamhost/requester</H1>
    <B>Abhinav Singh</B> 
    <A HREF="mailto:jdev%40jabber.org?Subject=Re%3A%20%5Bjdev%5D%20Understanding%20target%20SOCKS5%20connection%20flow%20with%0A%09streamhost/requester&In-Reply-To=%3C404751.93045.qm%40web31805.mail.mud.yahoo.com%3E"
       TITLE="[jdev] Understanding target SOCKS5 connection flow with	streamhost/requester">abhinavsingh at ymail.com
       </A><BR>
    <I>Tue Nov  9 15:22:59 CST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="088545.html">[jdev] XSF membership application period Q4/2010
</A></li>
        <LI>Next message: <A HREF="088548.html">[jdev] Understanding target SOCKS5 connection flow with streamhost/requester
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#88546">[ date ]</a>
              <a href="thread.html#88546">[ thread ]</a>
              <a href="subject.html#88546">[ subject ]</a>
              <a href="author.html#88546">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

While going through XEP-0065 and related RFC's i decided to play around with the 
debug window of Pidgin. Here is what I found when a connected account tries to 
accept a file:

(01:56:47) jabber:Recv (572): <A HREF="http://jabber.org/protocol/bytestreams'">http://jabber.org/protocol/bytestreams'</A> 
sid='purplee6c1c0cb'&gt;
(01:56:47) dnsquery: Performing DNS lookup for 192.168.2.103
(01:56:47) dnsquery: IP resolved for 192.168.2.103
(01:56:47) proxy: Attempting connection to 192.168.2.103
(01:56:47) proxy: Connecting to 50c0abe90692f69b56e49a53334daf8c6ad26f9e:0 via 
192.168.2.103:58919 using SOCKS5
(01:56:47) socks5 proxy: Connection in progress
(01:56:47) jabber: in jabber_si_xfer_bytestreams_send_connected_cb
(01:56:47) socks5 proxy: Connected.
(01:56:47) jabber: in jabber_si_xfer_bytestreams_send_read_cb
(01:56:47) jabber: reading those first two bytes
(01:56:47) jabber: in jabber_si_xfer_bytestreams_send_read_cb
(01:56:47) jabber: reading 1 bytes for auth methods (trying to read 1 now)
(01:56:47) jabber: checking to make sure we're socks FIVE
(01:56:47) jabber: going to test 1 different methods
(01:56:47) jabber: testing 0
(01:56:47) socks5 proxy: Able to read.
(01:56:47) jabber: in jabber_si_xfer_bytestreams_send_read_again_cb
(01:56:47) jabber: reading the first 5 bytes
(01:56:47) jabber: in jabber_si_xfer_bytestreams_send_read_again_cb
(01:56:47) jabber: reading 42 bytes for DST.ADDR + port num (trying to read 42 
now)
(01:56:47) stun: using server 
(01:56:47) jabber: SOCKS5 connection negotiation completed. Waiting for IQ 
result to start file transfer.
(01:56:47) s5: reallocing from 5 to 18
(01:56:47) s5: reallocing from 18 to 20
(01:56:47) proxy: Connected to 50c0abe90692f69b56e49a53334daf8c6ad26f9e:0.
(01:56:47) jabber:Sending (<A HREF="http://mail.jabber.org/mailman/listinfo/jdev">1 at dev.jaxl.im</A>/2557233831289334472350031): 
<A HREF="http://jabber.org/protocol/bytestreams'">http://jabber.org/protocol/bytestreams'</A>&gt;

 
Now as per section 5.3.2. of XEP-0065 here is how Pidgin should have calculated 
hash for DST.ADDR:
sha1(&quot;<A HREF="http://mail.jabber.org/mailman/listinfo/jdev">purplee6c1c0cbjaxl at dev.jaxl.im</A>/<A HREF="http://mail.jabber.org/mailman/listinfo/jdev">5859500411289328645518583jaxl at dev.jaxl.im</A>/5859500411289328645518583&quot;)
 which equates to 59aadec011bdb96cb0f2fea5e6f6596e5a0d6f93 and not 
50c0abe90692f69b56e49a53334daf8c6ad26f9e as shown in the logs.

Am i missing something from the XEP doc?

--
Abhinav Singh,
Founder, Jaxl Inc.
Bangalore, India
<A HREF="http://abhinavsingh.com/blog">http://abhinavsingh.com/blog</A>



      
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="https://www.jabber.org/jdev/attachments/20101109/89ca85ad/attachment.htm">https://www.jabber.org/jdev/attachments/20101109/89ca85ad/attachment.htm</A>&gt;
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="088545.html">[jdev] XSF membership application period Q4/2010
</A></li>
	<LI>Next message: <A HREF="088548.html">[jdev] Understanding target SOCKS5 connection flow with streamhost/requester
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#88546">[ date ]</a>
              <a href="thread.html#88546">[ thread ]</a>
              <a href="subject.html#88546">[ subject ]</a>
              <a href="author.html#88546">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://mail.jabber.org/mailman/listinfo/jdev">More information about the JDev
mailing list</a><br>
</body></html>
