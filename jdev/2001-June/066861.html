<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [JDEV] some questions about xdb and transport
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:jdev%40jabber.org?Subject=Re%3A%20%5BJDEV%5D%20some%20questions%20about%20xdb%20and%20transport&In-Reply-To=%3C200106041355.f54DtwW15959%40dev.vista.internal%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="066858.html">
   <LINK REL="Next"  HREF="066862.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[JDEV] some questions about xdb and transport</H1>
    <B>Gang Liu</B> 
    <A HREF="mailto:jdev%40jabber.org?Subject=Re%3A%20%5BJDEV%5D%20some%20questions%20about%20xdb%20and%20transport&In-Reply-To=%3C200106041355.f54DtwW15959%40dev.vista.internal%3E"
       TITLE="[JDEV] some questions about xdb and transport">gang_l at 21cn.com
       </A><BR>
    <I>Mon Jun  4 08:43:18 CDT 2001</I>
    <P><UL>
        <LI>Previous message: <A HREF="066858.html">[JDEV] 1.4.1 server often hangup.
</A></li>
        <LI>Next message: <A HREF="066862.html">[JDEV] Signed &amp; encrypted messages
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#66861">[ date ]</a>
              <a href="thread.html#66861">[ thread ]</a>
              <a href="subject.html#66861">[ subject ]</a>
              <a href="author.html#66861">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

	I use RedHat 6.1 and Jabber server 1.4.1 from cvs.
	I am doing some study in xdb backend and my own transport.I have changed xdb config in jabber.xml.
  &lt;xdb id=&quot;xdblinker&quot;&gt;
     &lt;host&gt;vista.internal&lt;/host&gt;
     &lt;ns&gt;jabber:iq:auth&lt;/ns&gt;
     &lt;accept&gt;
        &lt;ip/&gt;
        &lt;port&gt;5280&lt;/port&gt;
        &lt;secret&gt;secret&lt;/secret&gt;
     &lt;/accept&gt;
  &lt;/xdb&gt;
   The xdblinker is a program in another host.It can handle &quot;jabber:iq:auth&quot; correctlly. I also add a transport to jabberd.The transport reveives message packets from user A, reply the packet and forward to another user B.

	I found jabberd always huangup servel seconds when user b is offline.I have used tcpdump to view the network traffic.
I found that jabberd sent nothing to xdblinker.Xdblinker received those packets together after severl seconds,but the xdb_get() already timed out.

Mon Jun  4 18:55:55 2001  users.c:137 js_user(<A HREF="http://mail.jabber.org/mailman/listinfo/jdev">11111 at vista.internal</A>,8120678)
Mon Jun  4 18:55:55 2001  users.c:144 js_user not current
Mon Jun  4 18:55:55 2001  deliver.c:460 DELIVER 2:vista.internal &lt;xdb type='get'
 to='<A HREF="http://mail.jabber.org/mailman/listinfo/jdev">11111 at vista.internal</A>' from='sessions' ns='jabber:iq:auth' id='10'/&gt;
Mon Jun  4 18:55:55 2001  deliver.c:649 delivering to instance 'xdblinker'
Mon Jun  4 18:55:55 2001  mio.c:929 mio_write called on x: 81D7A28 buffer: (null
)
Mon Jun  4 18:55:55 2001  xdb.c:201 xdb_get() waiting for <A HREF="http://mail.jabber.org/mailman/listinfo/jdev">11111 at vista.internal</A> j
abber:iq:auth
Mon Jun  4 18:56:09 2001  deliver.c:460 DELIVER 2:vista.internal &lt;xdb type='get'
 to='<A HREF="http://mail.jabber.org/mailman/listinfo/jdev">11111 at vista.internal</A>' from='sessions' ns='jabber:iq:auth' id='10'/&gt;
Mon Jun  4 18:56:09 2001  deliver.c:649 delivering to instance 'xdblinker'
Mon Jun  4 18:56:09 2001  mio.c:929 mio_write called on x: 81EC630 buffer: (null
)
Mon Jun  4 18:56:20 2001  deliver.c:460 DELIVER 2:vista.internal &lt;xdb type='get'
 to='<A HREF="http://mail.jabber.org/mailman/listinfo/jdev">11111 at vista.internal</A>' from='sessions' ns='jabber:iq:auth' id='10'/&gt;
Mon Jun  4 18:56:20 2001  deliver.c:649 delivering to instance 'xdblinker'
Mon Jun  4 18:56:20 2001  mio.c:929 mio_write called on x: 81D9FA0 buffer: (null

I am looking forward for suggestions from you all... Thanks.
   
Regards,

- Lg

2001-6-4 21:18:00

--
  Gang Liu / Vista Team / ShenZhen City / China
  Email: <A HREF="http://mail.jabber.org/mailman/listinfo/jdev">gang_l at 21cn.com</A>  &amp;  <A HREF="http://mail.jabber.org/mailman/listinfo/jdev">gdlg at 163.net</A>
  Phone: +86 13923425035   
  ICQ: 70670666
--
  &quot;Java Club&quot;&lt;<A HREF="http://mail.jabber.org/mailman/listinfo/jdev">javaclub at list.sohu.com</A>&gt;
  <A HREF="http://list.sohu.com/mailinglist/javaclub/">http://list.sohu.com/mailinglist/javaclub/</A>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="066858.html">[JDEV] 1.4.1 server often hangup.
</A></li>
	<LI>Next message: <A HREF="066862.html">[JDEV] Signed &amp; encrypted messages
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#66861">[ date ]</a>
              <a href="thread.html#66861">[ thread ]</a>
              <a href="subject.html#66861">[ subject ]</a>
              <a href="author.html#66861">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://mail.jabber.org/mailman/listinfo/jdev">More information about the JDev
mailing list</a><br>
</body></html>
