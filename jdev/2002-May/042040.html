<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [JDEV] Dialup and laptop users, lost packets, and faulty presence info
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:jdev%40jabber.org?Subject=Re%3A%20%5BJDEV%5D%20Dialup%20and%20laptop%20users%2C%20lost%20packets%2C%20and%20faulty%20presence%20info&In-Reply-To=%3CA136ACB4-6940-11D6-B347-003065E5F91E%40mac.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="042041.html">
   <LINK REL="Next"  HREF="042042.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[JDEV] Dialup and laptop users, lost packets, and faulty presence info</H1>
    <B>tom_waters at mac.com</B> 
    <A HREF="mailto:jdev%40jabber.org?Subject=Re%3A%20%5BJDEV%5D%20Dialup%20and%20laptop%20users%2C%20lost%20packets%2C%20and%20faulty%20presence%20info&In-Reply-To=%3CA136ACB4-6940-11D6-B347-003065E5F91E%40mac.com%3E"
       TITLE="[JDEV] Dialup and laptop users, lost packets, and faulty presence info">tom_waters at mac.com
       </A><BR>
    <I>Thu May 16 21:48:55 CDT 2002</I>
    <P><UL>
        <LI>Previous message: <A HREF="042041.html">[JDEV] Dialup and laptop users, lost packets, and faulty presence info
</A></li>
        <LI>Next message: <A HREF="042042.html">[JDEV] Dialup and laptop users, lost packets, and faulty presence info
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#42040">[ date ]</a>
              <a href="thread.html#42040">[ thread ]</a>
              <a href="subject.html#42040">[ subject ]</a>
              <a href="author.html#42040">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>does SO_KEEPALIVE have any application here?

if the server had KEEPALIVE set on every socket, it would notice the 
broken connection and could close cleanly...

no?


On Thursday, May 16, 2002, at 02:59  PM, Nathan Sharp wrote:

&gt;<i> David,
</I>&gt;<i>   I had originally thought that, but was having difficulty parsing
</I>&gt;<i> through the jabberd code, plus I figured an external component would be
</I>&gt;<i> a configurable tool that I could publish back somewhere, if it worked.
</I>&gt;<i>  Regardless, your message gave me inspiration to parse through more code
</I>&gt;<i> and once I found the right place - pthsock/client.c - it was incredibly
</I>&gt;<i> easy to add just that in.  I've added it in as a configurable option and
</I>&gt;<i> am pretty sure that with just a little more work I can even have it skip
</I>&gt;<i> heartbeats when there has been recent activity on the socket (saving
</I>&gt;<i> bandwidth and resources).  Once I have a chance to set up a test server
</I>&gt;<i> and run it for a while to prove the point, I'll submit a patch back 
</I>&gt;<i> here.
</I>&gt;<i>   So the questions become:
</I>&gt;<i> 1) How different is the 1.5 code?  (don't answer that, I can take a look
</I>&gt;<i> later myself )
</I>&gt;<i> 2) What does it take to get my patch into the main distribution?
</I>&gt;<i>
</I>&gt;<i>   Anyhow, thanks for the thoughts!
</I>&gt;<i>    Nathan (aka tinman on <A HREF="http://mail.jabber.org/mailman/listinfo/jdev">jdev at conference.jabber.org</A>)
</I>&gt;<i>
</I>&gt;<i> David Waite wrote:
</I>&gt;<i>
</I>&gt;<i> &gt; I would recommend a heartbeat which instead does what clients have
</I>&gt;<i> &gt; done for a while - sends a whitespace character in-between XML
</I>&gt;<i> &gt; packets. You would need to modify the client connection piece to do
</I>&gt;<i> &gt; this (c2s/jadc2s/jpoll/dpsm/whatever); but it would be significantly
</I>&gt;<i> &gt; less intrusive to a client than a separate component sending new XML
</I>&gt;<i> &gt; elements. Rather than having the clients reply to this message, their
</I>&gt;<i> &gt; TCP/IP stack will just ACK the new packet. Failure will result in the
</I>&gt;<i> &gt; stack of the server recognising the socket as dead, which will be
</I>&gt;<i> &gt; treated just like a (clean) disconnect is now.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; -David Waite
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> -- Nathan P Sharp
</I>&gt;<i> Phoenix Integration
</I>&gt;<i> 1715 Pratt Dr
</I>&gt;<i> Suite 2000
</I>&gt;<i> 540-961-7215
</I>&gt;<i> 540-961-5831 (fax)
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> jdev mailing list
</I>&gt;<i> <A HREF="http://mail.jabber.org/mailman/listinfo/jdev">jdev at jabber.org</A>
</I>&gt;<i> <A HREF="http://mailman.jabber.org/listinfo/jdev">http://mailman.jabber.org/listinfo/jdev</A>
</I>&gt;<i>
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="042041.html">[JDEV] Dialup and laptop users, lost packets, and faulty presence info
</A></li>
	<LI>Next message: <A HREF="042042.html">[JDEV] Dialup and laptop users, lost packets, and faulty presence info
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#42040">[ date ]</a>
              <a href="thread.html#42040">[ thread ]</a>
              <a href="subject.html#42040">[ subject ]</a>
              <a href="author.html#42040">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://mail.jabber.org/mailman/listinfo/jdev">More information about the JDev
mailing list</a><br>
</body></html>
