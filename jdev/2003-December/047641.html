<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [JDEV] Videoconferencing with jabber / Re:[speex-dev]Videoconferencing with speex and jabber
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:jdev%40jabber.org?Subject=Re%3A%20%5BJDEV%5D%20Videoconferencing%20with%20jabber%20/%20Re%3A%5Bspeex-dev%5DVideoconferencing%20with%20speex%20and%20jabber&In-Reply-To=%3Coprzj3qtxmn9nte4%40smtp.chello.nl%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="047640.html">
   <LINK REL="Next"  HREF="047671.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[JDEV] Videoconferencing with jabber / Re:[speex-dev]Videoconferencing with speex and jabber</H1>
    <B>Tijl Houtbeckers</B> 
    <A HREF="mailto:jdev%40jabber.org?Subject=Re%3A%20%5BJDEV%5D%20Videoconferencing%20with%20jabber%20/%20Re%3A%5Bspeex-dev%5DVideoconferencing%20with%20speex%20and%20jabber&In-Reply-To=%3Coprzj3qtxmn9nte4%40smtp.chello.nl%3E"
       TITLE="[JDEV] Videoconferencing with jabber / Re:[speex-dev]Videoconferencing with speex and jabber">thoutbeckers at splendo.com
       </A><BR>
    <I>Tue Dec  2 07:57:55 CST 2003</I>
    <P><UL>
        <LI>Previous message: <A HREF="047640.html">[JDEV] Videoconferencing with jabber / Re:[speex-dev]Videoconferencing with speex and jabber
</A></li>
        <LI>Next message: <A HREF="047671.html">[JDEV] Videoconferencing with jabber / Re:[speex-dev]Videoconferencing with speex and jabber
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#47641">[ date ]</a>
              <a href="thread.html#47641">[ thread ]</a>
              <a href="subject.html#47641">[ subject ]</a>
              <a href="author.html#47641">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Tue, 2 Dec 2003 10:50:36 -0000, Richard Dobson &lt;<A HREF="http://mail.jabber.org/mailman/listinfo/jdev">richard at dobson-i.net</A>&gt; 
wrote:

&gt;<i> I didnt intend to say that we should not have server based conferencing 
</I>&gt;<i> at
</I>&gt;<i> all, all I originally meant to object to was putting that into a client
</I>&gt;<i> rather than just using a dedicated server, and in cases where you can 
</I>&gt;<i> that
</I>&gt;<i> you should use p2p. Now I can see that p2p wont cover all cases, but 
</I>&gt;<i> also I
</I>&gt;<i> am unconvinced server based will cover all uses either, so as I 
</I>&gt;<i> suggested at
</I>&gt;<i> the bottom of the email is a hybrid cs/p2p mechanism that can take the 
</I>&gt;<i> best
</I>&gt;<i> of both worlds and cover more situations that either one of them alone 
</I>&gt;<i> plus
</I>&gt;<i> being more flexable.
</I>
I would suggest still using the c/s model as a basis for the spec, since 
you can use as the basis for person to person over a direct link, person 
to person via a server, conferencing over direct links (with each &quot;peer&quot; 
acting as server, as described in an additional spec) and of course, 
conferencing on a server.

However, it should also allow for an additional spec where there is more 
than one server hosting the conference.

There's different approaches you can take for this, you could create a 
persistant network of &quot;public&quot; &quot;supernodes&quot;, but this ofcourse brings it's 
security issues (since you can't encrypt if there has to be mixing on the 
supernodes) or you could create a network of &quot;supernodes&quot; for each 
conversation.

Ideally a client that only implements the &quot;base&quot; c/s spec should be able 
to work transparently with such an &quot;upgraded&quot; network. For example I can 
imagine the &quot;clients&quot; will have to disco the &quot;server&quot; for wich server 
address to connect their audiostream to (wether this a JID or IP I 
wouldn't know yet). The server could also provide them with fallback 
servers (wich could ofcourse be updated as well during the conference as 
new &quot;clients&quot; connect that are able/willing to take the role of such a 
&quot;supernode&quot;). This distributes bandwith and CPU load amongst servers. The 
spec would mostly focus on how &quot;supernodes&quot; amongst themselves regulate 
the network (including stuff like in-sync mixing).

However, I think there's still a lot of cases where at least I myself 
would just prefer to host everything on my own connection (if that's the 
fastest one avaible). It's also important person to person conversations 
over direct links will work. This still leaves the problem of NAT 
traversal, which is really what Skype is all about.

&gt;&gt;<i> Skype uses UDP NAT travelsal based on getting it's IP from someone 
</I>&gt;&gt;<i> outside
</I>&gt;&gt;<i> the NAT (at least, so it was suggested either here or on SJIG), wich is
</I>&gt;&gt;<i> currently being rejected by the jabber server folks
</I>&gt;<i>
</I>&gt;<i> I was under the impression it was asking your server for the IP address 
</I>&gt;<i> that
</I>&gt;<i> they are objecting to not other methods of obtaining it.
</I>
What I heard suggested was uPnP and SOCKS settings. I'm just pointing out 
the difference between that approach (relying on the client to figure it 
out) and Skype (whatever way will work, use it, and the jabber server 
telling you will cover it in a lot of cases to start with)

&gt;&gt;<i> SOCKS5 is hardly integrated with an excisting mechanism
</I>&gt;<i>
</I>&gt;<i> Well it is using an existing protocol rather than baking our own,
</I>
As I understand it, it basically just uses it for the connection 
initiation part so it can pass some meta-data.

&gt;<i> I was
</I>&gt;<i> suggesting that maybe we could do the same in this case and see if there 
</I>&gt;<i> is
</I>&gt;<i> an existing protocol/system that we could integrate with rather than
</I>&gt;<i> possibly duplicating effort and saving us time.
</I>
I already named JXTA a few times. Though I have to admit it's been years 
probably since I looked at it, it will probably support opening binary 
streams over it's decentralized network (support for UDP I don't know).

But I think all existing solutions will depend on running a decentralized 
peer network independant of Jabber. Wheter this is something we want I 
don't know :)


&gt;&gt;<i> Well, I agree that, just like with the bandwith requirments, demands on
</I>&gt;&gt;<i> the server will be higher than on a node in a direct link conference. 
</I>&gt;&gt;<i> Just
</I>&gt;&gt;<i> not THAT much higher
</I>&gt;<i>
</I>&gt;<i> Sorry but it is much higher because of the fact that in p2p clients do 
</I>&gt;<i> not
</I>&gt;<i> need to do any re-encoding at all, plus the fact that you need 
</I>&gt;<i> individually
</I>&gt;<i> mix the streams before re-encoding them to send out, this IS much more 
</I>&gt;<i> of a
</I>&gt;<i> requirement since using p2p you dont necessarly even have to do the 
</I>&gt;<i> mixing
</I>&gt;<i> step, let alone the re-encoding step (which will be the most CPU 
</I>&gt;<i> intensive
</I>&gt;<i> part). Plus remember to prevent echoing you really need to mix/encode 
</I>&gt;<i> each
</I>&gt;<i> of the outgoing streams individually.
</I>
Unless you use client side echo removal (which ofcourse will put some 
extra burden on the client, what I'm indeed trying to avoid all along, but 
it's still a compromise). But agreed, this is one of the main advantages 
of using a direct link based conference. Again, you'll benifit the most 
(and the disadvantages will be the least obvious) if all clients have 
somewhat equal specs, while in most cases I doubt this is true for Joe 
Consumer.

&gt;&gt;<i>
</I>&gt;&gt;<i> Ofcourse you still have to mix when you use DirectX ;)
</I>&gt;<i>
</I>&gt;<i> Playing two (or more) streams simultaneously is not mixing as far as I am
</I>&gt;<i> concerned, so no you dont necessarly have to even mix.
</I>
Ofcourse the streams are mixed, just by DirectX/ALSA/whatever instead of 
you. If your soundcard has some Direct X compatible hardware for this the 
soundcard can do the mixing. (Which is still true in many cases if you use 
a server that uses DirectX for mixing too)

&gt;&gt;<i> Servers can use
</I>&gt;&gt;<i> existing technology too ofcourse.. Servers (components) specializing in
</I>&gt;&gt;<i> hosting this kind for companies or paying customers could even use DSP
</I>&gt;&gt;<i> hardware and such.
</I>&gt;<i>
</I>&gt;<i> Sure but using hardware such as that will be out of reach for the vast
</I>&gt;<i> majority of people.
</I>
The vast majority of people won't need to mix several thousend streams at 
once either ;)

&gt;<i> I doubt it would be very clean and pretty hard to do, the only way I can 
</I>&gt;<i> see
</I>&gt;<i> it really working is by individually encoding each outgoing stream on the
</I>&gt;<i> server.
</I>
Then we both don't know ;) But most implementations probably won't be so 
advanced, if this is even possible (and you made a good point about 
re-encoding, which I more seriously doubt you can optimize much)

&gt;<i> Ok but isnt that really an issue with you consuming so much of your 
</I>&gt;<i> outgoing
</I>&gt;<i> bandwidth that the TCP replies are having a hard job getting back which
</I>&gt;<i> slows down the particular TCP socket, I would expect that we would use a 
</I>&gt;<i> UDP
</I>&gt;<i> transport like RTP which wouldnt have this problem as there are no 
</I>&gt;<i> replies
</I>&gt;<i> to return in UDP, the packets will just get dropped if there is a problem
</I>&gt;<i> and the audio transport should be able to transparently handle this 
</I>&gt;<i> easily.
</I>
No, packets will just be send out slower, wich means latency will increase.
If you want to send 100 bytes and you have 20 bytes a sec. available, it 
will take 5 sec. If you have 10 bytes a sec. it will take 10 sec. Wich 
means your latency just increased by 5 seconds, wether you use UDP or TCP. 
UDP is more effective for audio (espc if you're willing to tolerate lost 
packets), so you can build a more effective stream control mechanism 
(which is already build in for TCP). Escp. in case of IP-packetloss on the 
connection this will indeed help decrease latency a lot, but it doesn't 
change the effect that as available bandwith shrinks latency will jump.. a 
lot!

&gt;&gt;<i> This problem doesn't occur when you make long distance phonecalls..??? 
</I>&gt;&gt;<i> How
</I>&gt;&gt;<i> could it? It doesn't even happen in a long distance *conference* call!
</I>&gt;<i>
</I>&gt;<i> Because you will hear yourself echo from the other end, that is I thought
</I>&gt;<i> what you meant, but overall I doubt syncing is something we really need 
</I>&gt;<i> to
</I>&gt;<i> concentrate on or worry about too much.
</I>
Out of sync mixing is *the* biggest annoyance about direct-link based 
conferencing if you ask me. Escp. when participants have severly different 
connections. I find this unbareable to work with.

&gt;<i> If you think supernodes are good then you must like my compromise 
</I>&gt;<i> solution
</I>&gt;<i> below, since in the supernode model each supernode commuicates p2p with
</I>&gt;<i> other supernodes, and clients talk to the supernodes.
</I>
True, and I think the idea is intresting. But I still think in most cases 
1 &quot;supernode&quot; will do (the host), and in many cases it won't be a problem 
to find one (broadband with a somewhat recent budget CPU will do I think).

&gt;&gt;<i> In previous email I already briefly touched the subject, and some in 
</I>&gt;&gt;<i> this
</I>&gt;&gt;<i> email. I definatly think most of this could be handeled in the SI layer
</I>&gt;&gt;<i> though (with a little cheating), a c/s based spec will not rule this out
</I>&gt;&gt;<i> at all.
</I>&gt;<i>
</I>&gt;<i> Im not sure how my solution above can be handled in the SI layer,
</I>
I wasn't exactly clear I was talking about bandwith here (where you can 
use some kind of peer network you connect to with SI that acts as a 
proxy/multicaster for your stream in a direct-link conference). Since then 
you pointed out CPU req. might be a bigger issue than I assumed at first.

&gt;<i> its a
</I>&gt;<i> modified version of your model where instead of having a single server 
</I>&gt;<i> you
</I>&gt;<i> could have as many as possible which communicate with each other via p2p,
</I>&gt;<i> but anyone who is incapable due to platform issues, bandwidth, CPU, 
</I>&gt;<i> firewall
</I>&gt;<i> etc to act as a server itself connects to one of these servers, this
</I>&gt;<i> provides the benefit of more evenly load balancing the CPU/bandwidth use 
</I>&gt;<i> of
</I>&gt;<i> the chat over several nodes rather than concentrating on one, provides
</I>&gt;<i> instant fall back to another server if one has problems or leaves, and
</I>&gt;<i> provides your primary benefit of being able to support dialup users or
</I>&gt;<i> simple clients like pocket pc's or people who cant go p2p because of
</I>&gt;<i> firewalls.
</I>
I think my idea as decribed more at the beginning of this email and here 
are pretty much alike. Are you suggesting a persistant network or these 
servers (which is p2p I suppose) or a per-conference network? (which I'd 
rather just call clustering of the servers)

Do you feel such a system should be part of the &quot;base&quot; spec for (audio) 
conferncing or an extention? And what do you feel should be done for NAT 
traversel in person to person? In case you suggest a peristant network of 
these nodes is that what should be used for that?

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="047640.html">[JDEV] Videoconferencing with jabber / Re:[speex-dev]Videoconferencing with speex and jabber
</A></li>
	<LI>Next message: <A HREF="047671.html">[JDEV] Videoconferencing with jabber / Re:[speex-dev]Videoconferencing with speex and jabber
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#47641">[ date ]</a>
              <a href="thread.html#47641">[ thread ]</a>
              <a href="subject.html#47641">[ subject ]</a>
              <a href="author.html#47641">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://mail.jabber.org/mailman/listinfo/jdev">More information about the JDev
mailing list</a><br>
</body></html>
