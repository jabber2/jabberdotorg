<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [jdev] How do I know when a MUC server restarts?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:jdev%40jabber.org?Subject=Re%3A%20%5Bjdev%5D%20How%20do%20I%20know%20when%20a%20MUC%20server%20restarts%3F&In-Reply-To=%3C20160303131956.GA2740%40singpolyma-liberty%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="090207.html">
   <LINK REL="Next"  HREF="090209.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[jdev] How do I know when a MUC server restarts?</H1>
    <B>Stephen Paul Weber</B> 
    <A HREF="mailto:jdev%40jabber.org?Subject=Re%3A%20%5Bjdev%5D%20How%20do%20I%20know%20when%20a%20MUC%20server%20restarts%3F&In-Reply-To=%3C20160303131956.GA2740%40singpolyma-liberty%3E"
       TITLE="[jdev] How do I know when a MUC server restarts?">singpolyma at singpolyma.net
       </A><BR>
    <I>Thu Mar  3 13:19:56 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="090207.html">[jdev] [ANN] Swift 3.0 released!
</A></li>
        <LI>Next message: <A HREF="090209.html">[jdev] How do I know when a MUC server restarts?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#90208">[ date ]</a>
              <a href="thread.html#90208">[ thread ]</a>
              <a href="subject.html#90208">[ subject ]</a>
              <a href="author.html#90208">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I am writing a external component (using it with Prosody right now) that 
allows users to join MUCs on other servers.  When a remote server restarts, 
I see this is my prosody log:

info    outgoing s2s stream singpolyma.net-&gt;chat.yax.im closed: system-shutdown (Received SIGTERM)

Now, my component is not running on singpolyma.net (that is a different 
domain on the same Prosody instance), but either maybe all s2s were incoming 
at the time since no one had said anything recently?

Anyway, looking at the logs on my component, I don't see any stanza 
indicating anything about this.  I mean, I guess that makes sense.  Server 
restarts don't generate stanzas.

The problem is that when they restart the server, it comes back up with all 
MUCs empty and I need to get everyone on my component to re-join.  But as it 
the component actually thinks they are still in the MUC!

Other XMPP clients I use seem to (sometimes after awhile) detect this 
situation somehow and tell me I'm no longer in the room (or try to re-join).  
How are they doing this?  Is this some quirk of the external component 
protocol where normally Prosody would generate this kind of stanza to 
a client?  Or what else could I be missing?  I really need to solve this 
issue...

Many thanks for any help!

-- 
Stephen Paul Weber, @singpolyma
See &lt;<A HREF="http://singpolyma.net">http://singpolyma.net</A>&gt; for how I prefer to be contacted
edition right joseph
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 819 bytes
Desc: Digital signature
URL: &lt;<A HREF="https://www.jabber.org/jdev/attachments/20160303/d8d180b2/attachment.sig">https://www.jabber.org/jdev/attachments/20160303/d8d180b2/attachment.sig</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="090207.html">[jdev] [ANN] Swift 3.0 released!
</A></li>
	<LI>Next message: <A HREF="090209.html">[jdev] How do I know when a MUC server restarts?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#90208">[ date ]</a>
              <a href="thread.html#90208">[ thread ]</a>
              <a href="subject.html#90208">[ subject ]</a>
              <a href="author.html#90208">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://mail.jabber.org/mailman/listinfo/jdev">More information about the JDev
mailing list</a><br>
</body></html>
