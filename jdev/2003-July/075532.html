<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [JDEV] [SECURITY] Remote roster manipulation bug in various Jabber clients
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:jdev%40jabber.org?Subject=Re%3A%20%5BJDEV%5D%20%5BSECURITY%5D%20Remote%20roster%20manipulation%20bug%20in%20various%20Jabber%20clients&In-Reply-To=%3C882C749F-ACCD-11D7-A28E-00039386381C%40jabber.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="075531.html">
   <LINK REL="Next"  HREF="075539.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[JDEV] [SECURITY] Remote roster manipulation bug in various Jabber clients</H1>
    <B>Dave Smith</B> 
    <A HREF="mailto:jdev%40jabber.org?Subject=Re%3A%20%5BJDEV%5D%20%5BSECURITY%5D%20Remote%20roster%20manipulation%20bug%20in%20various%20Jabber%20clients&In-Reply-To=%3C882C749F-ACCD-11D7-A28E-00039386381C%40jabber.org%3E"
       TITLE="[JDEV] [SECURITY] Remote roster manipulation bug in various Jabber clients">dizzyd at jabber.org
       </A><BR>
    <I>Wed Jul  2 15:41:18 CDT 2003</I>
    <P><UL>
        <LI>Previous message: <A HREF="075531.html">[JDEV] [SECURITY] Remote roster manipulation bug in various Jabber clients
</A></li>
        <LI>Next message: <A HREF="075539.html">[JDEV] [SECURITY] Remote roster manipulation bug in various Jabber clients
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#75532">[ date ]</a>
              <a href="thread.html#75532">[ thread ]</a>
              <a href="subject.html#75532">[ subject ]</a>
              <a href="author.html#75532">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1


On Wednesday, Jul 2, 2003, at 14:05 America/Denver, Jacek Konieczny 
wrote:

&gt;<i> By using this vulnerability and modifying someone's roster one may make
</I>&gt;<i> him start chat or send file to a person user doesn't intend contact
</I>&gt;<i> with. This would require send one &lt;iq/&gt; to remove original entry, 
</I>&gt;<i> second
</I>&gt;<i> one to add new entry with the same name and usually &lt;presence/&gt; to show
</I>&gt;<i> the contact available. The new JID will usually be visible in chat
</I>&gt;<i> window or in roster item details, but users usually care about contact
</I>&gt;<i> name only.
</I>&gt;<i>
</I>&gt;<i> This method changes roster copy in client only and doesn't change
</I>&gt;<i> original roster on server. But if victim changes the forged entry
</I>&gt;<i> (eg. to fix a typo) it will be sent to his server. However subscription
</I>&gt;<i> information cannot be changed this way.
</I>
I'm not certain what level of vulnerability this really is -- sending 
an IQ to the client does not make any permanent changes to the users 
roster. At worst, I see a new person on my roster (a cosmetic issue) 
for the duration of my session; when I logout/login the user would be 
gone (since the server-side roster was not updated).

Also note that people can already send messages (and request file 
transfers) to others without being on the recipients roster.

&gt;<i> 5. Proposed fix
</I>&gt;<i>
</I>&gt;<i> In clients before handling roster pushes check &quot;from&quot; attribute and 
</I>&gt;<i> drop
</I>&gt;<i> the request if &quot;from&quot; is set and is not session's full JID.
</I>
Sure -- that's a reasonable way to avoid the fix.

&gt;<i> 6. Possible workaround
</I>&gt;<i>
</I>&gt;<i> On server drop all &lt;iq/&gt; stanzas from &quot;outside&quot; containing
</I>&gt;<i> &quot;jabber:iq:roster&quot; namespace. However, this breaks normal XMPP stanza
</I>&gt;<i> routing rules.
</I>
As noted, that would break routing for a variety of reasons -- I 
strongly discourage anyone from trying this approach.

D.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.1 (Darwin)

iD8DBQE/A0NuYNE3chVHHsMRAmrjAJ47TePw0iu3A8hN9jnzVcaQAdEr+QCfbBCM
ktw7MtBl07OW8Ydk94TQwu0=
=3ohT
-----END PGP SIGNATURE-----


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="075531.html">[JDEV] [SECURITY] Remote roster manipulation bug in various Jabber clients
</A></li>
	<LI>Next message: <A HREF="075539.html">[JDEV] [SECURITY] Remote roster manipulation bug in various Jabber clients
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#75532">[ date ]</a>
              <a href="thread.html#75532">[ thread ]</a>
              <a href="subject.html#75532">[ subject ]</a>
              <a href="author.html#75532">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://mail.jabber.org/mailman/listinfo/jdev">More information about the JDev
mailing list</a><br>
</body></html>
