<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [jdev] File xfer gone wrong?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:jdev%40jabber.org?Subject=Re%3A%20%5Bjdev%5D%20File%20xfer%20gone%20wrong%3F&In-Reply-To=%3Cd55e29bf05030914391268a1a1%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="079888.html">
   <LINK REL="Next"  HREF="079878.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[jdev] File xfer gone wrong?</H1>
    <B>Anthony Ortiz</B> 
    <A HREF="mailto:jdev%40jabber.org?Subject=Re%3A%20%5Bjdev%5D%20File%20xfer%20gone%20wrong%3F&In-Reply-To=%3Cd55e29bf05030914391268a1a1%40mail.gmail.com%3E"
       TITLE="[jdev] File xfer gone wrong?">anthonypaulo at gmail.com
       </A><BR>
    <I>Wed Mar  9 16:39:13 CST 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="079888.html">[jdev] XIFF development
</A></li>
        <LI>Next message: <A HREF="079878.html">[jdev] File xfer gone wrong?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#79877">[ date ]</a>
              <a href="thread.html#79877">[ thread ]</a>
              <a href="subject.html#79877">[ subject ]</a>
              <a href="author.html#79877">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello everyone!

I posted a message on the exodus newsgroup a while back but I think
it's dead as I haven't seen any activity in weeks. Maybe someone has
been thought this before or can spot the obvious and point me in the
right direction, so I'm reposting most of it here.

Thanks!!

Anthony

=== repost from exodus newsgroup ===
I've written a simple java applet that implements the Jabber protocol in very
much the same way yahoo chat works. Right now things are going smoothly, I can
log in, do rostering, chatting, and bytestream file transfers. I have been
testing so far against the PSI client, and I am able to transfer files back and
forth no problem. However, I seem to be having a problem with the Exodus client.
I am able to receive a file from an Exodous client just fine (though I had to
use the latest development build 0.9.0.39; 0.9.0.0 resulted in a corrupted
file), but for some reason I can't seem to send a file to Exodus, it gives me
the error &quot;Exodus was unable to connect to any file transfer proxies or the
sender.&quot; This is what happens :

1) I do the usual stream initiation stuff
2) I create a server socket on host:port
3) I send the iq containing the streamhost stanza with the host:port
4) I accept the connection on the serversocket

At this point the Exodus client is sending me a SOCKS5 version 
identifier/method selection message, stating that it 
supports &quot;no authentication&quot;

5) I send 2 bytes in response, the first byte being the version (5) and the
second being &quot;no authentication&quot; (0).

At this point the Exodus client is sending me a socks5 request message
containing :

version 5
cmd 1
type 3
host = SHA1 hash
port 0

So far so good!

6) hash matches great, so I send the Exodus client a reply message with
status = 0 meaning we're good to go

It is at this point that I believe I have nothing left to do but wait for an
iq response from the exodus client, but instead it immediately pops up an
error message stating that it was unable to connect. How can that be when
everything seemed to be going so well?? Is Exodus expecting something else?
Or maybe I should be setting the other fields in my reply besides setting the
status field to 0?? I tried filling in the reply message fields with :

version : 5
reply (status) : 0
reserved : 0
type = 3
addr = host
port = port

and this doesn't work either. What am I doing wrong?? What's weird is that I
can transfer files both ways against a PSI client, and PSI and Exodus work
fine against each other as well, but it's only when I try to send a file to
Exodus that I have this problem. Heeeeeeeeelp!!

Thank you for your time!! :)

Anthony

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="079888.html">[jdev] XIFF development
</A></li>
	<LI>Next message: <A HREF="079878.html">[jdev] File xfer gone wrong?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#79877">[ date ]</a>
              <a href="thread.html#79877">[ thread ]</a>
              <a href="subject.html#79877">[ subject ]</a>
              <a href="author.html#79877">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://mail.jabber.org/mailman/listinfo/jdev">More information about the JDev
mailing list</a><br>
</body></html>
