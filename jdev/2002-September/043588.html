<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [JDEV] Playing with xdb files while jabberd is running.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:jdev%40jabber.org?Subject=Re%3A%20%5BJDEV%5D%20Playing%20with%20xdb%20files%20while%20jabberd%20is%20running.&In-Reply-To=%3C20020927161411.GA10387%40box5.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="043587.html">
   <LINK REL="Next"  HREF="043590.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[JDEV] Playing with xdb files while jabberd is running.</H1>
    <B>Thomas Muldowney</B> 
    <A HREF="mailto:jdev%40jabber.org?Subject=Re%3A%20%5BJDEV%5D%20Playing%20with%20xdb%20files%20while%20jabberd%20is%20running.&In-Reply-To=%3C20020927161411.GA10387%40box5.net%3E"
       TITLE="[JDEV] Playing with xdb files while jabberd is running.">temas at box5.net
       </A><BR>
    <I>Fri Sep 27 11:14:11 CDT 2002</I>
    <P><UL>
        <LI>Previous message: <A HREF="043587.html">[JDEV] Playing with xdb files while jabberd is running.
</A></li>
        <LI>Next message: <A HREF="043590.html">[JDEV] nested group
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#43588">[ date ]</a>
              <a href="thread.html#43588">[ thread ]</a>
              <a href="subject.html#43588">[ subject ]</a>
              <a href="author.html#43588">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>This all depends on your cache settings, and even with no cacheing I
would call it risky.  Generally the server is an aggressive cacher
because the XDB is used fairly often.  I don't believe the server keeps
file handles open though.  So if the cacheing is in place and you move
or delete the file the cache will be written out to the file when it is
ready, and the user will be back.  Otherwise, the setup might work, but
I wouldn't count on that type of functionality.  It might be better to
hack the transport and just add an admin capability that stores a flag
in the xdb.


--temas


On Fri, Sep 27, 2002 at 11:24:28AM -0500, <A HREF="http://mail.jabber.org/mailman/listinfo/jdev">worklists at dovkatz.net</A> wrote:
&gt;<i> Hello, don't ask why this is necessary, but I have a production jabberd process using file-based xdb to store registration info for remote transports (such as toc,yahoo,etc).
</I>&gt;<i> 
</I>&gt;<i> Is there a deterministic behavior of jabberd if I were to move/delete an xdb file while everything is running?  I need to immediately remove users from a remote transport/gateway and while I can boot them by admin-ing the gateway, I need them to be temporarily unregistered so they cannot log back in.  The best solution I can think of is moving the xdb files, without stopping jabberd.
</I>&gt;<i> 
</I>&gt;<i> So, this is really 2 questions.
</I>&gt;<i> 
</I>&gt;<i> 1) Does jabberd keep file handles open (thus will be connected to the inode on disk) to the xdb's even when it's done reading them? If so, moving the file won't help me.
</I>&gt;<i> 
</I>&gt;<i> 2) If [1] is false, then what happens if I move the file? 
</I>&gt;<i> 
</I>&gt;<i> 3) if [1] is true, what happens if i delete the file?
</I>&gt;<i> 
</I>&gt;<i> Thanks in advance
</I>&gt;<i> -Dov
</I>&gt;<i> _______________________________________________
</I>&gt;<i> jdev mailing list
</I>&gt;<i> <A HREF="http://mail.jabber.org/mailman/listinfo/jdev">jdev at jabber.org</A>
</I>&gt;<i> <A HREF="http://mailman.jabber.org/listinfo/jdev">http://mailman.jabber.org/listinfo/jdev</A>
</I>-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
URL: &lt;<A HREF="https://www.jabber.org/jdev/attachments/20020927/f2ac5774/attachment-0001.pgp">https://www.jabber.org/jdev/attachments/20020927/f2ac5774/attachment-0001.pgp</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="043587.html">[JDEV] Playing with xdb files while jabberd is running.
</A></li>
	<LI>Next message: <A HREF="043590.html">[JDEV] nested group
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#43588">[ date ]</a>
              <a href="thread.html#43588">[ thread ]</a>
              <a href="subject.html#43588">[ subject ]</a>
              <a href="author.html#43588">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://mail.jabber.org/mailman/listinfo/jdev">More information about the JDev
mailing list</a><br>
</body></html>
