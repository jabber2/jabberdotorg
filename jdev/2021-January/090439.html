<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [jdev] Omemo: confused by devicelist via pep
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:jdev%40jabber.org?Subject=Re%3A%20%5Bjdev%5D%20Omemo%3A%20confused%20by%20devicelist%20via%20pep&In-Reply-To=%3CCAL30P%2BbRKBMmftTs-Xxa%3DusWAByAjSbUsL82QDno4Pn9Hd7j2Q%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   
   <LINK REL="Next"  HREF="090440.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[jdev] Omemo: confused by devicelist via pep</H1>
    <B>george b</B> 
    <A HREF="mailto:jdev%40jabber.org?Subject=Re%3A%20%5Bjdev%5D%20Omemo%3A%20confused%20by%20devicelist%20via%20pep&In-Reply-To=%3CCAL30P%2BbRKBMmftTs-Xxa%3DusWAByAjSbUsL82QDno4Pn9Hd7j2Q%40mail.gmail.com%3E"
       TITLE="[jdev] Omemo: confused by devicelist via pep">scooterschorschi at gmail.com
       </A><BR>
    <I>Tue Jan 26 19:36:57 UTC 2021</I>
    <P><UL>
        
        <LI>Next message: <A HREF="090440.html">[jdev] Omemo: confused by devicelist via pep
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#90439">[ date ]</a>
              <a href="thread.html#90439">[ thread ]</a>
              <a href="subject.html#90439">[ subject ]</a>
              <a href="author.html#90439">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello all

I had included omemo in shmoose [1] by using libomemo with axc and
integrated lurch [2] by implementing an adapter to use without libpurple.
So far so good, it is working as expected.

The only thing wich does not work is deploying the devicelist via pep. I
had to ask for devicelist manually to use omemo encryption.

According to omemo xep [3] 5.2: &quot;Devices MUST subscribe to
urn:xmpp:omemo:1:devices via PEP&quot;. But pep state [4] 1.2: &quot;because they are
subscribed to your presence, they automatically receive your events&quot;. I
would expect, as long as the users are subscribed to the others presence,
they will automatically receive the devicelist nodes and updates? That does
not work for me.

This is the pep node shmoose client sends during add of devicelist entry:

&lt;iq xmlns=&quot;jabber:client&quot; id=&quot;d0093daf-8c93-4c3c-8382-68d0d1454295&quot; type=&quot;
set&quot;&gt;

&lt;pubsub xmlns=&quot;<A HREF="http://jabber.org/protocol/pubsub">http://jabber.org/protocol/pubsub</A>&quot;&gt;

&lt;publish node=&quot;eu.siacs.conversations.axolotl.devicelist&quot;&gt;

&lt;item&gt;

&lt;list xmlns=&quot;eu.siacs.conversations.axolotl&quot;&gt;

&lt;device id=&quot;339564329&quot;&gt;&lt;/device&gt;

&lt;/list&gt;

&lt;/item&gt;

&lt;/publish&gt;

&lt;/pubsub&gt;

&lt;/iq&gt;

As far as I understood it, this should trigger an automated message stanza
update to all presence-subscribed users. But it doesn't.

Any hints on this issue are appreciated.

Best regards
geobra

[1] <A HREF="https://github.com/geobra/harbour-shmoose">https://github.com/geobra/harbour-shmoose</A>
[2] <A HREF="https://github.com/gkdr/lurch/">https://github.com/gkdr/lurch/</A>
[3] <A HREF="https://xmpp.org/extensions/xep-0384.html">https://xmpp.org/extensions/xep-0384.html</A>
[4] <A HREF="https://xmpp.org/extensions/xep-0163.html">https://xmpp.org/extensions/xep-0163.html</A>

P.S.
I am aware that this is not the latest omemo version. But this is what the
lurch plugin currently implements.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="https://www.jabber.org/jdev/attachments/20210126/f89ea9e8/attachment.html">https://www.jabber.org/jdev/attachments/20210126/f89ea9e8/attachment.html</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	
	<LI>Next message: <A HREF="090440.html">[jdev] Omemo: confused by devicelist via pep
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#90439">[ date ]</a>
              <a href="thread.html#90439">[ thread ]</a>
              <a href="subject.html#90439">[ subject ]</a>
              <a href="author.html#90439">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://mail.jabber.org/mailman/listinfo/jdev">More information about the JDev
mailing list</a><br>
</body></html>
