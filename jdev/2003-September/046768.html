<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [JDEV] xdb_sql suggestions
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:jdev%40jabber.org?Subject=Re%3A%20%5BJDEV%5D%20xdb_sql%20suggestions&In-Reply-To=%3C3F58C2FD.2030703%40raditha.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="046767.html">
   <LINK REL="Next"  HREF="046770.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[JDEV] xdb_sql suggestions</H1>
    <B>Raditha Dissanayake</B> 
    <A HREF="mailto:jdev%40jabber.org?Subject=Re%3A%20%5BJDEV%5D%20xdb_sql%20suggestions&In-Reply-To=%3C3F58C2FD.2030703%40raditha.com%3E"
       TITLE="[JDEV] xdb_sql suggestions">jabber at raditha.com
       </A><BR>
    <I>Fri Sep  5 12:08:13 CDT 2003</I>
    <P><UL>
        <LI>Previous message: <A HREF="046767.html">[JDEV] xdb_sql suggestions
</A></li>
        <LI>Next message: <A HREF="046770.html">[JDEV] HTML Transport - Proof of concept - www.outintheuk.com
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#46768">[ date ]</a>
              <a href="thread.html#46768">[ thread ]</a>
              <a href="subject.html#46768">[ subject ]</a>
              <a href="author.html#46768">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Matthias,

You could be right about the index being forgotten :-) and you are right 
about making an index with a smaller width than the full column. But i 
haven't seen such a drastic drop in performance as you seem to have 
encountered without indices.

One other point that i noted is that most of the key fields are not 
numeric this also leads to a big drop in performance both for inserts 
and retrievals.

best regards
raditha


Matthias Wimmer wrote:

&gt;<i>Hi Raditha!
</I>&gt;<i>
</I>&gt;<i>Raditha Dissanayake schrieb am 2003-09-05 19:20:00:
</I>&gt;<i>  
</I>&gt;<i>
</I>&gt;&gt;<i>I guess Bentoit and Co might have left the tables without indices 
</I>&gt;&gt;<i>because there's a large number of inserts being done on these tables.  
</I>&gt;&gt;<i>That's because mod_roster passes the entire roster to XDB when a change 
</I>&gt;&gt;<i>occurs. xdb_sql deletes the whole lot and inserts them anew.
</I>&gt;&gt;<i>I did a patch for this sometime back but never got around to 
</I>&gt;&gt;<i>contributing it. With that patch the roster entries just get updated 
</I>&gt;&gt;<i>instead of delete/insert.   Let me try to dig it up and send it in.
</I>&gt;&gt;<i>    
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i>I don't know if it is faster without an index on small databases, but on
</I>&gt;<i>amessage the difference is enormous. Without the index it was not really
</I>&gt;<i>usable. It the insert operation would get that expensive with the
</I>&gt;<i>indexes, I don't think it would exist on the rosterusers table. It think
</I>&gt;<i>the index has just been forgotten.
</I>&gt;<i>
</I>&gt;<i>And on the rosterusers table the index could get smaller and wouldn't
</I>&gt;<i>decrease performance if it is limited to maybe the first 32 characters
</I>&gt;<i>of username and jid.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>Tot kijk
</I>&gt;<i>    Matthias
</I>&gt;<i>  
</I>&gt;<i>
</I>

-- 
<A HREF="http://www.radinks.com/upload">http://www.radinks.com/upload</A>
Drag and Drop File Uploader.



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="046767.html">[JDEV] xdb_sql suggestions
</A></li>
	<LI>Next message: <A HREF="046770.html">[JDEV] HTML Transport - Proof of concept - www.outintheuk.com
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#46768">[ date ]</a>
              <a href="thread.html#46768">[ thread ]</a>
              <a href="subject.html#46768">[ subject ]</a>
              <a href="author.html#46768">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://mail.jabber.org/mailman/listinfo/jdev">More information about the JDev
mailing list</a><br>
</body></html>
