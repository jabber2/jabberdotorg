<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [jdev] MUC Presence: force history even if already joined
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:jdev%40jabber.org?Subject=Re%3A%20%5Bjdev%5D%20MUC%20Presence%3A%20force%20history%20even%20if%20already%20joined&In-Reply-To=%3CCALm9TZ9SRk0kimthFPc6snrQhXmCLWon2O9HWBF91kE9QC1jfA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="089924.html">
   <LINK REL="Next"  HREF="089927.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[jdev] MUC Presence: force history even if already joined</H1>
    <B>Waqas Hussain</B> 
    <A HREF="mailto:jdev%40jabber.org?Subject=Re%3A%20%5Bjdev%5D%20MUC%20Presence%3A%20force%20history%20even%20if%20already%20joined&In-Reply-To=%3CCALm9TZ9SRk0kimthFPc6snrQhXmCLWon2O9HWBF91kE9QC1jfA%40mail.gmail.com%3E"
       TITLE="[jdev] MUC Presence: force history even if already joined">waqas20 at gmail.com
       </A><BR>
    <I>Wed Mar 26 20:58:02 UTC 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="089924.html">[jdev] MUC Presence: force history even if already joined
</A></li>
        <LI>Next message: <A HREF="089927.html">[jdev] MUC Presence: force history even if already joined
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#89925">[ date ]</a>
              <a href="thread.html#89925">[ thread ]</a>
              <a href="subject.html#89925">[ subject ]</a>
              <a href="author.html#89925">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Wed, Mar 26, 2014 at 2:05 PM, Dave Cridland &lt;<A HREF="http://mail.jabber.org/mailman/listinfo/jdev">dave at cridland.net</A>&gt; wrote:
&gt;<i>
</I>&gt;<i> On 26 Mar 2014 17:49, &quot;Daniel Dormont&quot; &lt;<A HREF="http://mail.jabber.org/mailman/listinfo/jdev">dan at greywallsoftware.com</A>&gt; wrote:
</I>&gt;&gt;<i> I have a use case where I would like to send a presence to a MUC that
</I>&gt;&gt;<i> I may have already joined and, even if I have, I want it to send me
</I>&gt;&gt;<i> the message history no matter what. Is there a way to do that or would
</I>&gt;&gt;<i> it require a protocol extension of some sort?
</I>&gt;<i>
</I>&gt;<i> Yes and no.
</I>&gt;<i>
</I>&gt;<i> Technically speaking, simply sending presence to a MUC and joining (thus
</I>&gt;<i> getting the history and participants) are not the same thing. Sending a
</I>&gt;<i> proper MUC join (with the &lt;x/&gt; and the history control optionally inside it)
</I>&gt;<i> to M-Link[*] will, therefore, give you the history you asked for, and all
</I>&gt;<i> the occupant presence, even if you're already in the room.
</I>&gt;<i>
</I>&gt;<i> I find this *extremely* useful - which is why I did things that way. A
</I>&gt;<i> use-case for this is where an S2S link is down when you reconnect your C2S,
</I>&gt;<i> or the server crashes, or ... - all arguably edge cases, but they're solved
</I>&gt;<i> very nicely this way.
</I>&gt;<i>
</I>&gt;<i> Other servers don't do this, though - I think they should.
</I>&gt;<i>
</I>&gt;<i> If you wanted to avoid the occupant presence, you'd want an extension which
</I>&gt;<i> signalled this in much the same way that the history controls work.
</I>&gt;<i>
</I>&gt;<i> Dave.
</I>&gt;<i> --
</I>&gt;<i> * - Note that I left Isode over a year ago and so may well be out of date.
</I>&gt;<i>
</I>
Prosody was (AFAIK) the first server to do this. We specifically
checked for &lt;x xmlns=muc&gt;, and assumed it was a MUC join, even if the
user was already in the room. It worked wonderfully, but we had to
comment that out because of Gtalk resending directed presence every
few minutes.

Did Google ever fix that? Or do Gtalk users joining M-Link chatrooms
get history sent over and over? We never removed the code from Prosody
in the hope that Google would fix their behavior and we would reenable
the feature.

--
Waqas Hussain
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="089924.html">[jdev] MUC Presence: force history even if already joined
</A></li>
	<LI>Next message: <A HREF="089927.html">[jdev] MUC Presence: force history even if already joined
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#89925">[ date ]</a>
              <a href="thread.html#89925">[ thread ]</a>
              <a href="subject.html#89925">[ subject ]</a>
              <a href="author.html#89925">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://mail.jabber.org/mailman/listinfo/jdev">More information about the JDev
mailing list</a><br>
</body></html>
