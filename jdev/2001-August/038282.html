<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [JDEV] Zerok Authentication
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:jdev%40jabber.org?Subject=Re%3A%20%5BJDEV%5D%20Zerok%20Authentication&In-Reply-To=%3C5.1.0.14.0.20010809203713.00a94660%40mail.btinternet.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="038279.html">
   <LINK REL="Next"  HREF="038283.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[JDEV] Zerok Authentication</H1>
    <B>Al Sutton</B> 
    <A HREF="mailto:jdev%40jabber.org?Subject=Re%3A%20%5BJDEV%5D%20Zerok%20Authentication&In-Reply-To=%3C5.1.0.14.0.20010809203713.00a94660%40mail.btinternet.com%3E"
       TITLE="[JDEV] Zerok Authentication">al at alsutton.com
       </A><BR>
    <I>Thu Aug  9 14:40:28 CDT 2001</I>
    <P><UL>
        <LI>Previous message: <A HREF="038279.html">[JDEV] Zerok Authentication
</A></li>
        <LI>Next message: <A HREF="038283.html">[JDEV] Zerok Authentication
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#38282">[ date ]</a>
              <a href="thread.html#38282">[ thread ]</a>
              <a href="subject.html#38282">[ subject ]</a>
              <a href="author.html#38282">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Heres the code from the Java Jabber server that agrees with the zerok 
digests generated by a number of clients. sessionId ad correctPassword are 
both Strings;

     MessageDigest sha;
     try
     {
       sha = MessageDigest.getInstance(&quot;SHA&quot;);
     }
     catch( NoSuchAlgorithmException e )
     {
       throw new RuntimeException( &quot;Unable to handle digest passwords&quot; );
     }

     String stringToHash = sessionId + correctPassword;
     byte[] bytesToHash = stringToHash.getBytes();
     byte[] hashedBytes = sha.digest( bytesToHash );

     StringBuffer shaValueBuffer = new StringBuffer( 40 );
     for( int i = 0 ; i &lt; 20 ; i++ )
     {
       int value = (int) (hashedBytes[i] &amp; 0xff);
       String hexValue = Integer.toHexString( value );
       if( value &lt; 16 )
         shaValueBuffer.append( &quot;0&quot; );
       shaValueBuffer.append( hexValue );
     }

     String shaValue = shaValueBuffer.toString();


Hope it's useful.

A.


At 11:54 09/08/2001 -0700, you wrote:
&gt;<i>Did anyone write a client that is using zerok authentication?? I have 
</I>&gt;<i>tried to do it in Java, but somehow it's just not working... Here's my 
</I>&gt;<i>code for creating zerok.. can anyone tell me if I am implementing the 
</I>&gt;<i>algorithm correctly?
</I>&gt;<i>
</I>&gt;<i>         //cache digest so no need to go through calculation again
</I>&gt;<i>         if (hash != null) return hash;
</I>&gt;<i>         //instantiate a SHA1 hash
</I>&gt;<i>         try {
</I>&gt;<i>             MessageDigest md = MessageDigest.getInstance(&quot;SHA&quot;);
</I>&gt;<i>             //hash password first
</I>&gt;<i>             md.update(context.getPassword().getBytes());
</I>&gt;<i>             byte[] hashA = md.digest();
</I>&gt;<i>           //now hash hashA + zerokToken
</I>&gt;<i>             md.reset();
</I>&gt;<i>             md.update(hashA);
</I>&gt;<i>             md.update(zerokToken.getBytes());
</I>&gt;<i>           byte[] hash0 = md.digest();
</I>&gt;<i>             byte[] hashSeq = new byte[hash0.length];
</I>&gt;<i>             System.arraycopy(hash0, 0, hashSeq, 0, hash0.length);
</I>&gt;<i>             //now loop the number of times specified by (zerokToken - 1)
</I>&gt;<i>             for (int i = 0;i &lt; (zerokSeq - 1);i++) {
</I>&gt;<i>                     md.reset();
</I>&gt;<i>                 //just start hashing
</I>&gt;<i>                         hashSeq = md.digest(hashSeq);
</I>&gt;<i>             }
</I>&gt;<i>             //convert to hex representation
</I>&gt;<i>             hash = HexDec.convertBytesToHexString(hashSeq);
</I>&gt;<i>         } catch (NoSuchAlgorithmException ex) {
</I>&gt;<i>             //no algorithm, just return null
</I>&gt;<i>             return &quot;&quot;;
</I>&gt;<i>         }
</I>&gt;<i>         return hash;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>Thanks,
</I>&gt;<i>Chris
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>PGP at <A HREF="ldap://certserver.pgp.com/">ldap://certserver.pgp.com/</A>
</I>&gt;<i>
</I>&gt;<i>_______________________________________________
</I>&gt;<i>jdev mailing list
</I>&gt;<i><A HREF="http://mail.jabber.org/mailman/listinfo/jdev">jdev at jabber.org</A>
</I>&gt;<i><A HREF="http://mailman.jabber.org/listinfo/jdev">http://mailman.jabber.org/listinfo/jdev</A>
</I>
-- 
Al Sutton
Email/Jabber: <A HREF="http://mail.jabber.org/mailman/listinfo/jdev">al at alsutton.com</A>
Web: <A HREF="http://www.alsutton.com/">http://www.alsutton.com/</A>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="038279.html">[JDEV] Zerok Authentication
</A></li>
	<LI>Next message: <A HREF="038283.html">[JDEV] Zerok Authentication
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#38282">[ date ]</a>
              <a href="thread.html#38282">[ thread ]</a>
              <a href="subject.html#38282">[ subject ]</a>
              <a href="author.html#38282">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://mail.jabber.org/mailman/listinfo/jdev">More information about the JDev
mailing list</a><br>
</body></html>
