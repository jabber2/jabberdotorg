<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [JDEV] Server modules
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:jdev%40jabber.org?Subject=%5BJDEV%5D%20Server%20modules&In-Reply-To=005001c12fd7%243e4ea4a0%244d00a8c0%40catamount">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009160.html">
   <LINK REL="Next"  HREF="009163.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[JDEV] Server modules</H1>
    <B>Thomas Charron</B> 
    <A HREF="mailto:jdev%40jabber.org?Subject=%5BJDEV%5D%20Server%20modules&In-Reply-To=005001c12fd7%243e4ea4a0%244d00a8c0%40catamount"
       TITLE="[JDEV] Server modules">tcharron at ductape.net
       </A><BR>
    <I>Tue Aug 28 11:56:20 CDT 2001</I>
    <P><UL>
        <LI>Previous message: <A HREF="009160.html">[JDEV] Server modules
</A></li>
        <LI>Next message: <A HREF="009163.html">[JDEV] Jabberd + NetBSD execution problems
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9162">[ date ]</a>
              <a href="thread.html#9162">[ thread ]</a>
              <a href="subject.html#9162">[ subject ]</a>
              <a href="author.html#9162">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Quoting Glenn MacGregor &lt;<A HREF="http://mail.jabber.org/mailman/listinfo/jdev">gtm at oracom.com</A>&gt;:
&gt;<i> I am writing a server module to answer certain iq namespace query's.  I
</I>&gt;<i> need to malloc memory here for a file I am sending back over IM.
</I>
  Alrighty, but thats still kind of vague..  You reading in the file, and then 
going to add it as cdata to a tag in the result?

&gt;<i> First
</I>&gt;<i> question, should I create a new jpacket or use the incoming and reset it
</I>&gt;<i> (I need to hide nodes on that as well)?
</I>
  You could do pretty much what mod_time does, which is to use jutil_iqresult 
on the packet, set the namespace for the query, then reset the packet for 
delivery.  That way your reusing the already created tag, but up to you, 
really, either way will work, be it make a new one, or resuse the existing one..

&gt;<i> Second, When I malloc the mem,
</I>&gt;<i> I get a server core dump in _pool_free.  I tried to use malloc and free
</I>&gt;<i> and create a pool and use pmalloc and pool_free.  Neither seem to
</I>&gt;<i> work?
</I>
  Need more data on this one, your question confuses me a bit.  Can you paste 
some psuedo code or snippets to show what you did that caused the core dump?

  Take a look at mod_time, which is a really good SHORT example of a module 
that replies to an iq message, it may help a bit if what you are doing is 
relativly simple..  Seems to me all it sounds like your doing is reading a 
file, and attaching it as a cdata segment, but that might not be what your 
trying to do..

--- 
Thomas Charron
&lt;&lt; Wanted: One decent sig &gt;&gt;
&lt;&lt; Preferably litle used  &gt;&gt;

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="009160.html">[JDEV] Server modules
</A></li>
	<LI>Next message: <A HREF="009163.html">[JDEV] Jabberd + NetBSD execution problems
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9162">[ date ]</a>
              <a href="thread.html#9162">[ thread ]</a>
              <a href="subject.html#9162">[ subject ]</a>
              <a href="author.html#9162">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://mail.jabber.org/mailman/listinfo/jdev">More information about the JDev
mailing list</a><br>
</body></html>
