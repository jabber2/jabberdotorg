<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [JDEV] Zerok Authentication
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:jdev%40jabber.org?Subject=Re%3A%20%5BJDEV%5D%20Zerok%20Authentication&In-Reply-To=%3C5.1.0.14.2.20010809134926.052de168%40mail.echomine.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="067567.html">
   <LINK REL="Next"  HREF="067570.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[JDEV] Zerok Authentication</H1>
    <B>Chris Chen</B> 
    <A HREF="mailto:jdev%40jabber.org?Subject=Re%3A%20%5BJDEV%5D%20Zerok%20Authentication&In-Reply-To=%3C5.1.0.14.2.20010809134926.052de168%40mail.echomine.com%3E"
       TITLE="[JDEV] Zerok Authentication">ckchris at idream.net
       </A><BR>
    <I>Thu Aug  9 15:50:22 CDT 2001</I>
    <P><UL>
        <LI>Previous message: <A HREF="067567.html">[JDEV] Zerok Authentication
</A></li>
        <LI>Next message: <A HREF="067570.html">[JDEV] xdb expertise, please
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#67568">[ date ]</a>
              <a href="thread.html#67568">[ thread ]</a>
              <a href="subject.html#67568">[ subject ]</a>
              <a href="author.html#67568">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hmm.. this seems to be the code for Digest only, not Zerok..   I have this 
implemented already, but thanks for letting me know though.. I appreciate 
your efforts...  Maybe you have something else that does show you the Zerok 
side that you can possibly share with me...

Thanks,
Chris

At 12:40 PM 8/9/2001, you wrote:
&gt;<i>Heres the code from the Java Jabber server that agrees with the zerok 
</I>&gt;<i>digests generated by a number of clients. sessionId ad correctPassword are 
</I>&gt;<i>both Strings;
</I>&gt;<i>
</I>&gt;<i>     MessageDigest sha;
</I>&gt;<i>     try
</I>&gt;<i>     {
</I>&gt;<i>       sha = MessageDigest.getInstance(&quot;SHA&quot;);
</I>&gt;<i>     }
</I>&gt;<i>     catch( NoSuchAlgorithmException e )
</I>&gt;<i>     {
</I>&gt;<i>       throw new RuntimeException( &quot;Unable to handle digest passwords&quot; );
</I>&gt;<i>     }
</I>&gt;<i>
</I>&gt;<i>     String stringToHash = sessionId + correctPassword;
</I>&gt;<i>     byte[] bytesToHash = stringToHash.getBytes();
</I>&gt;<i>     byte[] hashedBytes = sha.digest( bytesToHash );
</I>&gt;<i>
</I>&gt;<i>     StringBuffer shaValueBuffer = new StringBuffer( 40 );
</I>&gt;<i>     for( int i = 0 ; i &lt; 20 ; i++ )
</I>&gt;<i>     {
</I>&gt;<i>       int value = (int) (hashedBytes[i] &amp; 0xff);
</I>&gt;<i>       String hexValue = Integer.toHexString( value );
</I>&gt;<i>       if( value &lt; 16 )
</I>&gt;<i>         shaValueBuffer.append( &quot;0&quot; );
</I>&gt;<i>       shaValueBuffer.append( hexValue );
</I>&gt;<i>     }
</I>&gt;<i>
</I>&gt;<i>     String shaValue = shaValueBuffer.toString();
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>Hope it's useful.
</I>&gt;<i>
</I>&gt;<i>A.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>At 11:54 09/08/2001 -0700, you wrote:
</I>&gt;&gt;<i>Did anyone write a client that is using zerok authentication?? I have 
</I>&gt;&gt;<i>tried to do it in Java, but somehow it's just not working... Here's my 
</I>&gt;&gt;<i>code for creating zerok.. can anyone tell me if I am implementing the 
</I>&gt;&gt;<i>algorithm correctly?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>         //cache digest so no need to go through calculation again
</I>&gt;&gt;<i>         if (hash != null) return hash;
</I>&gt;&gt;<i>         //instantiate a SHA1 hash
</I>&gt;&gt;<i>         try {
</I>&gt;&gt;<i>             MessageDigest md = MessageDigest.getInstance(&quot;SHA&quot;);
</I>&gt;&gt;<i>             //hash password first
</I>&gt;&gt;<i>             md.update(context.getPassword().getBytes());
</I>&gt;&gt;<i>             byte[] hashA = md.digest();
</I>&gt;&gt;<i>           //now hash hashA + zerokToken
</I>&gt;&gt;<i>             md.reset();
</I>&gt;&gt;<i>             md.update(hashA);
</I>&gt;&gt;<i>             md.update(zerokToken.getBytes());
</I>&gt;&gt;<i>           byte[] hash0 = md.digest();
</I>&gt;&gt;<i>             byte[] hashSeq = new byte[hash0.length];
</I>&gt;&gt;<i>             System.arraycopy(hash0, 0, hashSeq, 0, hash0.length);
</I>&gt;&gt;<i>             //now loop the number of times specified by (zerokToken - 1)
</I>&gt;&gt;<i>             for (int i = 0;i &lt; (zerokSeq - 1);i++) {
</I>&gt;&gt;<i>                     md.reset();
</I>&gt;&gt;<i>                 //just start hashing
</I>&gt;&gt;<i>                         hashSeq = md.digest(hashSeq);
</I>&gt;&gt;<i>             }
</I>&gt;&gt;<i>             //convert to hex representation
</I>&gt;&gt;<i>             hash = HexDec.convertBytesToHexString(hashSeq);
</I>&gt;&gt;<i>         } catch (NoSuchAlgorithmException ex) {
</I>&gt;&gt;<i>             //no algorithm, just return null
</I>&gt;&gt;<i>             return &quot;&quot;;
</I>&gt;&gt;<i>         }
</I>&gt;&gt;<i>         return hash;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>Thanks,
</I>&gt;&gt;<i>Chris
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>PGP at <A HREF="ldap://certserver.pgp.com/">ldap://certserver.pgp.com/</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>_______________________________________________
</I>&gt;&gt;<i>jdev mailing list
</I>&gt;&gt;<i><A HREF="http://mail.jabber.org/mailman/listinfo/jdev">jdev at jabber.org</A>
</I>&gt;&gt;<i><A HREF="http://mailman.jabber.org/listinfo/jdev">http://mailman.jabber.org/listinfo/jdev</A>
</I>&gt;<i>
</I>&gt;<i>--
</I>&gt;<i>Al Sutton
</I>&gt;<i>Email/Jabber: <A HREF="http://mail.jabber.org/mailman/listinfo/jdev">al at alsutton.com</A>
</I>&gt;<i>Web: <A HREF="http://www.alsutton.com/">http://www.alsutton.com/</A>
</I>&gt;<i>
</I>&gt;<i>_______________________________________________
</I>&gt;<i>jdev mailing list
</I>&gt;<i><A HREF="http://mail.jabber.org/mailman/listinfo/jdev">jdev at jabber.org</A>
</I>&gt;<i><A HREF="http://mailman.jabber.org/listinfo/jdev">http://mailman.jabber.org/listinfo/jdev</A>
</I>
PGP at <A HREF="ldap://certserver.pgp.com/">ldap://certserver.pgp.com/</A>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="067567.html">[JDEV] Zerok Authentication
</A></li>
	<LI>Next message: <A HREF="067570.html">[JDEV] xdb expertise, please
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#67568">[ date ]</a>
              <a href="thread.html#67568">[ thread ]</a>
              <a href="subject.html#67568">[ subject ]</a>
              <a href="author.html#67568">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://mail.jabber.org/mailman/listinfo/jdev">More information about the JDev
mailing list</a><br>
</body></html>
