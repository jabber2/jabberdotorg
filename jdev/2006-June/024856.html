<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [jdev] XMPP Ping/Keepalive: Recommended method ?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:jdev%40jabber.org?Subject=%5Bjdev%5D%20XMPP%20Ping/Keepalive%3A%20Recommended%20method%20%3F&In-Reply-To=f60b7eb60606190015h6810cea1v6d3ac6a0b6ee9b82%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="024855.html">
   <LINK REL="Next"  HREF="024871.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[jdev] XMPP Ping/Keepalive: Recommended method ?</H1>
    <B>Michal vorner Vaner</B> 
    <A HREF="mailto:jdev%40jabber.org?Subject=%5Bjdev%5D%20XMPP%20Ping/Keepalive%3A%20Recommended%20method%20%3F&In-Reply-To=f60b7eb60606190015h6810cea1v6d3ac6a0b6ee9b82%40mail.gmail.com"
       TITLE="[jdev] XMPP Ping/Keepalive: Recommended method ?">michal.vaner at kdemail.net
       </A><BR>
    <I>Mon Jun 19 02:40:38 CDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="024855.html">[jdev] XMPP Ping/Keepalive: Recommended method ?
</A></li>
        <LI>Next message: <A HREF="024871.html">[jdev] XMPP Ping/Keepalive: Recommended method ?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24856">[ date ]</a>
              <a href="thread.html#24856">[ thread ]</a>
              <a href="subject.html#24856">[ subject ]</a>
              <a href="author.html#24856">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Mon, Jun 19, 2006 at 11:15:40AM +0400, Sergei Golovan wrote:
&gt;<i> On 6/19/06, Michal vorner Vaner &lt;<A HREF="http://mail.jabber.org/mailman/listinfo/jdev">michal.vaner at kdemail.net</A>&gt; wrote:
</I>&gt;<i> &gt;On Sun, Jun 18, 2006 at 10:47:19PM -0700, <A HREF="http://mail.jabber.org/mailman/listinfo/jdev">ennova2005-jabber at yahoo.com</A> 
</I>&gt;<i> &gt;wrote:
</I>&gt;<i> &gt;&gt;    Given that the protocol itself does not seem to have a defined 
</I>&gt;<i> &gt;keep-alive
</I>&gt;<i> &gt;&gt;    element, what is the recommended way for a client to keep its 
</I>&gt;<i> &gt;connection
</I>&gt;<i> &gt;&gt;    alive to a XMPP server ?
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;Since XML allows any number of whitespace between elements that is just
</I>&gt;<i> &gt;ignored, you can send a whitespace if you are not in the middle of
</I>&gt;<i> &gt;stanza. It will do, NATs and other beasts will see data flowing,
</I>&gt;<i> 
</I>&gt;<i> The problem is that this &quot;ping&quot; is not a ping at all because it only
</I>&gt;<i> sends data and does not expect reply.
</I>&gt;<i> 
</I>&gt;<i> So, some NATs and proxies still break connection if they don't see
</I>&gt;<i> bidirectional flow.
</I>
Then the thing is even more broken. That thing should be thrown out of
window and not expect software to work around its bugs.

Strictly speaking, in my opinion, NATs are disease and should be
exterminated, but that is another story.

&gt;<i> Another issue is that with this &quot;ping&quot; you can't control the
</I>&gt;<i> connection. If TCP connection breaks (but before TCP timeout reaches -
</I>&gt;<i> and it is a quite long timeout) both messages and &quot;pings&quot; goes to
</I>&gt;<i> black hole and there's no way to work around this (to set some short
</I>&gt;<i> internal timeout or whatever).
</I>&gt;<i> 
</I>Theoretically, you should get some ICMP packet telling you the machine
is gone or the connection was closed. I know, the reality is different.

There is some work (I hope there still is) how to add stanza acking, so
you know when it does not get through.

If you really want some workaround, client can ping its server by
sending a stanza to its own JID. The server should take it and send back
like it is. I would prefer a &lt;message&gt; stanza containing some extension
I would make myself (maybe even undocumented, since you do not need
anyone to understand it and cooperate).

-- 
One semi-random fortune:

Einstein argued that there must be simplified explanations of nature, because
God is not capricious or arbitrary.  No such faith comforts the software
engineer.
                -- Fred Brooks

Michal &quot;vorner&quot; Vaner
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : <A HREF="https://www.jabber.org/jdev/attachments/20060619/94a7d436/attachment.pgp">https://www.jabber.org/jdev/attachments/20060619/94a7d436/attachment.pgp</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="024855.html">[jdev] XMPP Ping/Keepalive: Recommended method ?
</A></li>
	<LI>Next message: <A HREF="024871.html">[jdev] XMPP Ping/Keepalive: Recommended method ?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24856">[ date ]</a>
              <a href="thread.html#24856">[ thread ]</a>
              <a href="subject.html#24856">[ subject ]</a>
              <a href="author.html#24856">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://mail.jabber.org/mailman/listinfo/jdev">More information about the JDev
mailing list</a><br>
</body></html>
