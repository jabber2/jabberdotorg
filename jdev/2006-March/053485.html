<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [jdev] JID and X.509
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:jdev%40jabber.org?Subject=Re%3A%20%5Bjdev%5D%20JID%20and%20X.509&In-Reply-To=%3C200603081041.41857.justin-keyword-jabber.093179%40affinix.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="053483.html">
   <LINK REL="Next"  HREF="053484.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[jdev] JID and X.509</H1>
    <B>Justin Karneges</B> 
    <A HREF="mailto:jdev%40jabber.org?Subject=Re%3A%20%5Bjdev%5D%20JID%20and%20X.509&In-Reply-To=%3C200603081041.41857.justin-keyword-jabber.093179%40affinix.com%3E"
       TITLE="[jdev] JID and X.509">justin-keyword-jabber.093179 at affinix.com
       </A><BR>
    <I>Wed Mar  8 12:41:41 CST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="053483.html">[jdev] JID and X.509
</A></li>
        <LI>Next message: <A HREF="053484.html">[jdev] project news feeds
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#53485">[ date ]</a>
              <a href="thread.html#53485">[ thread ]</a>
              <a href="subject.html#53485">[ subject ]</a>
              <a href="author.html#53485">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Wednesday 08 March 2006 05:39, Heiner Wolf wrote:
&gt;<i> I understand that the certificate holds keys as OIDs. Any idea how this
</I>&gt;<i> fits to the mentioned key-value pairs? I doubt that X.509 APIs know the
</I>&gt;<i> OID for id-on-xmppAddr. So I doubt that putting
</I>&gt;<i> &quot;id-on-xmppAddr&quot;-&quot;<A HREF="http://mail.jabber.org/mailman/listinfo/jdev">node at domain.tld</A>&quot; into my API does any good. Ideas?
</I>
You are correct.  Many APIs work with a set of known keys.  You need an API 
that is either aware of xmppAddr, or one that will allow you to set an 
otherName extension with an OID (that dotted string thing) and everything.  
Some APIs won't even have this, in which case adding xmppAddr would be 
impossible.  However, even if you're able to set an extension, you'll still 
need to create the &quot;value&quot; part, which would be some sort of binary packed 
ASN.1 (but fortunately for xmppAddr, it is rather simple).

Below is a snippet of one of my mails with Jack Lloyd (of Botan) last November 
discussing the otherName support in QCA (my security library).  I had to 
learn up on ASN.1 to get this right.  Maybe it will be useful:

--
To be sure that I'm doing OtherName properly, here is a sample SubjectAltName 
value that contains the XMPP OtherName (from 
<A HREF="http://www.xmpp.org/specs/rfc3920.html">http://www.xmpp.org/specs/rfc3920.html</A> Section 5.1.1).

30 = 00110000 - universal, constructed, type 16 (sequence)
35 = 00110101 - 53 bytes
 81 = 10000001 - context specific, primative, type 1 (email)
 12 = 00010010 - length 18
  6A 75 73 74 69 6E 40 61 66 66 69 6E 69 78 2E 63 6F 6D (<A HREF="http://mail.jabber.org/mailman/listinfo/jdev">justin at affinix.com</A>)
 A0 = 10100000 - context specific, constructed, type 0 (otherName)
 1F = 00011111 - length 31
  06 = 00000110 - universal, primitive, type 6 (object id)
  08 = 00001000 - length 8
   2B 06 01 05 05 07 08 05 -&gt; 0x2B = 43, x = 1, y = 3 (1.3.6.1.5.5.7.8.5)
  A0 = 10100000 - context specific, constructed, type 0 (otherName value)
  13 = 00010011 - length 19
   0C = 00001100 - universal, primative, type 12 (utf8 string)
   11 = 00010001 - length 17
    6A 75 73 74 69 6E 40 61 6E 64 62 69 74 2E 6E 65 74 (<A HREF="http://mail.jabber.org/mailman/listinfo/jdev">justin at andbit.net</A>)

The DER was generated by some openssl-based code that I shared with you eons 
ago, and this is my hand-decoding of the resulting OCTET STRING found inside 
SubjectAltName.  Maybe you can check this to see if it looks right (and I've 
attached the cert to this email if you want to parse it).

Right now, QCA has direct support for the XMPP OtherName.  However, I'm 
considering taking it out and having my XMPP code use the QCA extension API 
instead, as a way to &quot;prove&quot; the extension system.  Here's an example of what 
it might look like in use:

  #define XMPP_NAME &quot;1.3.6.1.5.5.7.8.5&quot;

  QString jid = &quot;<A HREF="http://mail.jabber.org/mailman/listinfo/jdev">justin at andbit.net</A>&quot;;
  QByteArray buf(19);
  buf[0] = 0xC0; // universal, primative, type 12 (utf8 string)
  buf[1] = 17;   // length 17
  buf += jid.toUtf8();

  altNames.addOtherName(XMPP_NAME, buf);

Of course, I'll probably want more advanced &quot;length&quot; encoding for larger 
UTF8String values, but you get the idea.  I think this interface shouldn't be 
too painful for minimal extension values, such as XMPP.  I guess if things 
get complex then the user will want to bring along an ASN.1 parser, but at 
least it will be possible.
--

Good luck,
-Justin

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="053483.html">[jdev] JID and X.509
</A></li>
	<LI>Next message: <A HREF="053484.html">[jdev] project news feeds
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#53485">[ date ]</a>
              <a href="thread.html#53485">[ thread ]</a>
              <a href="subject.html#53485">[ subject ]</a>
              <a href="author.html#53485">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://mail.jabber.org/mailman/listinfo/jdev">More information about the JDev
mailing list</a><br>
</body></html>
