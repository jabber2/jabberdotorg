<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [jdev] Security-related thought experiment
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:jdev%40jabber.org?Subject=%5Bjdev%5D%20Security-related%20thought%20experiment&In-Reply-To=EA45E1AD-251E-4A48-8609-E158FBBE62BA%40deepdarc.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="024324.html">
   <LINK REL="Next"  HREF="024328.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[jdev] Security-related thought experiment</H1>
    <B>Robert B Quattlebaum, Jr.</B> 
    <A HREF="mailto:jdev%40jabber.org?Subject=%5Bjdev%5D%20Security-related%20thought%20experiment&In-Reply-To=EA45E1AD-251E-4A48-8609-E158FBBE62BA%40deepdarc.com"
       TITLE="[jdev] Security-related thought experiment">darco at deepdarc.com
       </A><BR>
    <I>Mon Mar 27 08:59:53 CST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="024324.html">[jdev] Security-related thought experiment
</A></li>
        <LI>Next message: <A HREF="024328.html">[Fwd: Re: [Fwd: Re: [jdev] Re: tls + plain sasl not working]]
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24330">[ date ]</a>
              <a href="thread.html#24330">[ thread ]</a>
              <a href="subject.html#24330">[ subject ]</a>
              <a href="author.html#24330">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>*bump*

I personally think this is a rather serious issue, perhaps warranting  
a &quot;Best-practices&quot; JEP for server developers. As XMPP becomes more  
and more popular, it is only a matter of time before script-kiddies  
start causing trouble.

What I'm thinking is a JEP which describes the attack and ways to  
prevent it from being successful. Then it makes it easy for server  
authors to communicate if their server is hardened against this type  
of attack: &quot;AcmeJabD 0.3 is JEP-01xx compliant&quot;...

Any thoughts? Good idea? Better solution? Am I making this out to be  
bigger than it actually is?

On Mar 24, 2006, at 10:32 PM, Robert B Quattlebaum, Jr. wrote:

&gt;<i> I was thinking the other day about a specific type of denial-of- 
</I>&gt;<i> service attack which may possibly affect a number of servers in  
</I>&gt;<i> active use today.
</I>&gt;<i>
</I>&gt;<i> Imagine a c2s connection that has already been set up and is now  
</I>&gt;<i> moving top-level stanzas. What would happen if I sent
</I>&gt;<i>
</I>&gt;<i> &lt;message to=&quot;<A HREF="http://mail.jabber.org/mailman/listinfo/jdev">randomjid at jabber.org</A>&quot;&gt;&lt;body&gt;
</I>&gt;<i>
</I>&gt;<i> Followed by a stream of random UTF-8 characters? Assuming that  
</I>&gt;<i> those random characters do not happen to contain &lt;, &gt;, or &amp;, (which  
</I>&gt;<i> is pretty easy to ensure), I would imagine that the process which  
</I>&gt;<i> has the XML parser would get larger and larger until the process  
</I>&gt;<i> would run out of memory. Boom.
</I>&gt;<i>
</I>&gt;<i> This attack (in spirit) doesn't require a fully established jabber  
</I>&gt;<i> stream, it only needs an opportunity to inject a large amount of  
</I>&gt;<i> data into an XML element that is inside of a top-level stanza. This  
</I>&gt;<i> attack could possibly work for attributes as well.
</I>&gt;<i>
</I>&gt;<i> Limiting the size of a single stanza may or may not fix the  
</I>&gt;<i> problem, depending on implementation. If the stanza size filter is  
</I>&gt;<i> applied to the stanza after it has been parsed, then this isn't  
</I>&gt;<i> good enough--the attack will still be successful because the stanza  
</I>&gt;<i> will never finish parsing. However, if the parser kept track of how  
</I>&gt;<i> large the stanza was getting as it was parsing it, then this attack  
</I>&gt;<i> can be avoided.
</I>&gt;<i>
</I>&gt;<i> Any thoughts, or other methods of preventing this attack from being  
</I>&gt;<i> successful? Or has this already been considered and &quot;fixed&quot;?
</I>
__________________
Robert Quattlebaum
Mobile: +1(650) 223-4974
eMail:  <A HREF="http://mail.jabber.org/mailman/listinfo/jdev">darco at deepdarc.com</A>
Jabber: <A HREF="http://mail.jabber.org/mailman/listinfo/jdev">darco at deepdarc.com</A>
WWW:    <A HREF="http://www.deepdarc.com/">http://www.deepdarc.com/</A>





</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="024324.html">[jdev] Security-related thought experiment
</A></li>
	<LI>Next message: <A HREF="024328.html">[Fwd: Re: [Fwd: Re: [jdev] Re: tls + plain sasl not working]]
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24330">[ date ]</a>
              <a href="thread.html#24330">[ thread ]</a>
              <a href="subject.html#24330">[ subject ]</a>
              <a href="author.html#24330">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://mail.jabber.org/mailman/listinfo/jdev">More information about the JDev
mailing list</a><br>
</body></html>
