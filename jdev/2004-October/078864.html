<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [jdev] Re: jabberd 2.0 c2s -- an issue
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:jdev%40jabber.org?Subject=Re%3A%20%5Bjdev%5D%20Re%3A%20jabberd%202.0%20c2s%20--%20an%20issue&In-Reply-To=%3Ccjtbd7%247s7%241%40sea.gmane.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="078860.html">
   <LINK REL="Next"  HREF="078861.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[jdev] Re: jabberd 2.0 c2s -- an issue</H1>
    <B>Stephen Marquard</B> 
    <A HREF="mailto:jdev%40jabber.org?Subject=Re%3A%20%5Bjdev%5D%20Re%3A%20jabberd%202.0%20c2s%20--%20an%20issue&In-Reply-To=%3Ccjtbd7%247s7%241%40sea.gmane.org%3E"
       TITLE="[jdev] Re: jabberd 2.0 c2s -- an issue">scm at marquard.net
       </A><BR>
    <I>Tue Oct  5 00:27:37 CDT 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="078860.html">[jdev] jabberd 2.0 c2s -- an issue
</A></li>
        <LI>Next message: <A HREF="078861.html">[jdev] IETF Publishes XMPP RFCs
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#78864">[ date ]</a>
              <a href="thread.html#78864">[ thread ]</a>
              <a href="subject.html#78864">[ subject ]</a>
              <a href="author.html#78864">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Paul Curtis wrote:

&gt;<i> One of the problems we're having in deploying jabberd 2.0 is the 'c2s'
</I>&gt;<i> disconnection issue. Right now, if a client sends invalid XML, the c2s
</I>&gt;<i> disconnects from the router. This means that because of one bad client,
</I>&gt;<i> ALL clients are bounced from the router.
</I>
Could you post some example XML which causes this behaviour ? Are there 
particular clients prone to doing this ?

&gt;<i> I am willing to implement something, because without it, jabberd 2.0's
</I>&gt;<i> 'c2s' is unusable in a large, enterprise deployment. Right now, this is
</I>&gt;<i> the only complaint I've heard about Jabber and jabberd 2.0 ... frequent
</I>&gt;<i> disconnections due to a client sending bad XML. Most of the problems are
</I>&gt;<i> caused by duplicate attributes, especially in the case of messages that
</I>&gt;<i> are stored offline.
</I>
This patch from Matthew Buckett:

  <A HREF="http://www.marquard.net/jabber/patches/patch-util-nad.c">http://www.marquard.net/jabber/patches/patch-util-nad.c</A>

addresses one issue where jabberd2 was inserting an extra namespace in 
the XML retrieved from the offline store - c/f:

<A HREF="https://www.jabber.org/jabberd/2004-September/001997.html">https://www.jabber.org/jabberd/2004-September/001997.html</A>

The presence of the &quot;xml:lang='en'&quot; attribute may have been the trigger 
for the error, because it's quite hard to reproduce, but this may be 
unrelated to the broader c2s issue you describe.

However if bad XML in messages in the offline queue can cause problems, 
then it would also be worth fixing that in sm, because such messages can 
be inserted through the back-end database as well (i.e. not originating 
via c2s/s2s).

Regards
Stephen


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="078860.html">[jdev] jabberd 2.0 c2s -- an issue
</A></li>
	<LI>Next message: <A HREF="078861.html">[jdev] IETF Publishes XMPP RFCs
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#78864">[ date ]</a>
              <a href="thread.html#78864">[ thread ]</a>
              <a href="subject.html#78864">[ subject ]</a>
              <a href="author.html#78864">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://mail.jabber.org/mailman/listinfo/jdev">More information about the JDev
mailing list</a><br>
</body></html>
