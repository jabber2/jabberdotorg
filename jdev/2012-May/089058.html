<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [jdev] Minimising number of MUC rooms
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:jdev%40jabber.org?Subject=Re%3A%20%5Bjdev%5D%20Minimising%20number%20of%20MUC%20rooms&In-Reply-To=%3CF8248955-C83F-400D-ACBD-6E895AE959FA%40jivatechnology.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="089057.html">
   <LINK REL="Next"  HREF="089059.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[jdev] Minimising number of MUC rooms</H1>
    <B>Theo Cushion</B> 
    <A HREF="mailto:jdev%40jabber.org?Subject=Re%3A%20%5Bjdev%5D%20Minimising%20number%20of%20MUC%20rooms&In-Reply-To=%3CF8248955-C83F-400D-ACBD-6E895AE959FA%40jivatechnology.com%3E"
       TITLE="[jdev] Minimising number of MUC rooms">theo at jivatechnology.com
       </A><BR>
    <I>Wed May 30 15:02:06 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="089057.html">[jdev] Minimising number of MUC rooms
</A></li>
        <LI>Next message: <A HREF="089059.html">[jdev] Minimising number of MUC rooms
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#89058">[ date ]</a>
              <a href="thread.html#89058">[ thread ]</a>
              <a href="subject.html#89058">[ subject ]</a>
              <a href="author.html#89058">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
On 30 May 2012, at 15:41, Peter Saint-Andre wrote:

&gt;<i> On 5/30/12 7:28 AM, Kevin Smith wrote:
</I>&gt;&gt;<i> On Wed, May 30, 2012 at 2:27 PM, Theo Cushion &lt;<A HREF="http://mail.jabber.org/mailman/listinfo/jdev">theo at jivatechnology.com</A>&gt; wrote:
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> On 30 May 2012, at 14:13, Kevin Smith wrote:
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> On Wed, May 30, 2012 at 2:09 PM, Theo Cushion &lt;<A HREF="http://mail.jabber.org/mailman/listinfo/jdev">theo at jivatechnology.com</A>&gt;
</I>&gt;&gt;&gt;<i> wrote:
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> On 30 May 2012, at 13:21, Kevin Smith wrote:
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> On Wed, May 30, 2012 at 1:13 PM, Theo Cushion &lt;<A HREF="http://mail.jabber.org/mailman/listinfo/jdev">theo at jivatechnology.com</A>&gt;
</I>&gt;&gt;&gt;<i> wrote:
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> I agree that there is never going to be a silver bullet that will solve all
</I>&gt;&gt;&gt;<i> issues. However, there is always going to be a limit on the rate of stanzas
</I>&gt;&gt;&gt;<i> that can be dealt with in a timely manner what ever the platform.
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> I'm not sure there's a silver bullet that'll solve all your problems
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> trivially - but I'm also not sure that there isn't a solution that
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> gains you more than what you currently propose.
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> So, there are two things being discussed here:
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> 1) Your use case and the need to limit the work done by the client on
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> login. I think this is addressable for your deployment by limiting the
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> number of rooms that need to be joined prior to there being activity
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> in them (or possibly by using pubsub nodes rather that MUC rooms,
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> although this is not a clear win and requires you to do significantly
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> more client work).
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> 2) Allowing servers to 'force' or 'autojoin' users into MUCs - this is
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> a feature that's generally interesting and speccing it up seems
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> sensible even if it won't help your cases (although it might, in
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> combination with some new server code).
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> It would certainly be nice to be able to get what ever saving is possible
</I>&gt;&gt;&gt;<i> from the standards, as then everyone can benefit rather than focusing on
</I>&gt;&gt;&gt;<i> application specific code.
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> Anything that can be done to minimise it will create more breathing room. By
</I>&gt;&gt;&gt;<i> those estimates I'd say losing a 1/3 of the stanzas across the wire is a
</I>&gt;&gt;&gt;<i> significant optimisation.
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> Right, it is.
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> Perhaps the saving could be greater, why would there be 300+ back? If I were
</I>&gt;&gt;&gt;<i> only the occupant, would I not just get my own presence back?
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> It'll receive presence from anyone in the room (I've not counted this)
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> its own presence (I did count this), any message history
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> requested/sent (I've not counted this) and the room subject, which
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> indicates the join is complete (I did count this).
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> Is this possibly a great fit for the Pubsub/Muc hybrid. Clients can
</I>&gt;&gt;&gt;<i> permanently subscribe selectively to things they are interested in. For
</I>&gt;&gt;&gt;<i> example, I don't care about room subject, but presence and history I might
</I>&gt;&gt;&gt;<i> care about. Having this information map on to nodes to the MUC jid gives
</I>&gt;&gt;&gt;<i> very fine control over what information is required using an existing
</I>&gt;&gt;&gt;<i> standard. Could the Pubsub/Muc hybrid simply come down to certain predefined
</I>&gt;&gt;&gt;<i> mappings, plus room for arbitrary information.
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> You mean exposing the room as both a MUC and as MEP, both being a
</I>&gt;&gt;&gt;<i> representation onto the same data? That would certainly help in your
</I>&gt;&gt;&gt;<i> case. I wonder what other people think of it?
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> /K
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> I think we're on the same page. I'll try and illustrate with an example:
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> We have a normal MUC room residing here: &quot;<A HREF="http://mail.jabber.org/mailman/listinfo/jdev">heath at chat.shakespeare.lit</A>&quot;
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> However, we also have a Pubsub root node living at the same address, then we
</I>&gt;&gt;&gt;<i> have a number of predefined children nodes,  for sake of argument (I guess
</I>&gt;&gt;&gt;<i> advertised using the disco features):
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> - jid = &quot;<A HREF="http://mail.jabber.org/mailman/listinfo/jdev">heath at chat.shakespeare.lit</A>&quot; node = &quot;users&quot;
</I>&gt;&gt;&gt;<i> - jid = &quot;<A HREF="http://mail.jabber.org/mailman/listinfo/jdev">heath at chat.shakespeare.lit</A>&quot; node = &quot;messages&quot;
</I>&gt;&gt;&gt;<i> - jid = &quot;<A HREF="http://mail.jabber.org/mailman/listinfo/jdev">heath at chat.shakespeare.lit</A>&quot; node = &quot;subject&quot;
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> (I don't think this will conflict with anything?)
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> If I want to receive all events in Pubsub form I subscribe to
</I>&gt;&gt;&gt;<i> &quot;<A HREF="http://mail.jabber.org/mailman/listinfo/jdev">heath at chat.shakespeare.lit</A>&quot;. If I just want the messages and users I can
</I>&gt;&gt;&gt;<i> subscribe to &quot;<A HREF="http://mail.jabber.org/mailman/listinfo/jdev">heath at chat.shakespeare.lit</A>, users&quot; and
</I>&gt;&gt;&gt;<i> &quot;<A HREF="http://mail.jabber.org/mailman/listinfo/jdev">heath at chat.shakespeare.lit</A>, messages&quot; respectively. Or I could request
</I>&gt;&gt;&gt;<i> certain items, using normal pubsub messages.
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> It gives me the power of Pubsub, and the advantages of MUC without
</I>&gt;&gt;&gt;<i> introducing a load of baggage. Just as we represent some of this information
</I>&gt;&gt;&gt;<i> using Disco (who's in a room, subject, etc) we are doing the same for
</I>&gt;&gt;&gt;<i> Pubsub, except we are doing it in a push fashion.
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> Any merit?
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> It's an interesting idea, and it does address your use case quite
</I>&gt;&gt;<i> nicely. I wonder what other people think?
</I>&gt;<i> 
</I>&gt;<i> Well, you know, everything is pubsub. ;-)
</I>
Yes, I really like things like the standards such as PEP which add a bit of convention over configuration to a very powerful mechanism. It gives some great use cases and doesn't reinvent the wheel.

&gt;<i> If we had started in 1999 with just pubsub, then MUC would have been
</I>&gt;<i> simply a special instance of pubsub along the lines that Theo has
</I>&gt;<i> described. I see no harm in offering a pubsub interface to the same data
</I>&gt;<i> that flows through the MUC room. One possible glitch is destroying the
</I>&gt;<i> room -- that can be done with one atomic command in XEP-0045, but in
</I>&gt;<i> pubsub you'd need to delete all of the nodes at the same time, and we
</I>&gt;<i> don't have an atomic command for that in XEP-0060. As long as the MUC
</I>&gt;<i> room/address is primary then I think this can be handled via MUC (with
</I>&gt;<i> pubsub being an alternative interface to the same data).
</I>
Yes, I imagine the Pubsub layer to be a kind of readonly layer on top of the MUC info. This would minimise the possibility of any edge cases and provide most of the benefit.

The exception to this would be creating arbitrary nodes within the same space (can of worms?). For instance, an occupant might want to create a node and start publishing arbitrary information that makes sense to be linked with the MUC room. I think this might be what some other threads are getting at.

I remember the general consensus at FOSDEM this year was that MUC isn't what it could be (not to discredit all of the hardwork that has gone into it). Looking at the broader picture, do you think having a Pubsub layer such as this on top could provide a sensible upgrade path? The operation of a MUC room remains the same, but we can start getting the benefits of modelling it using Pubsub.

More fuel for the fire!

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="089057.html">[jdev] Minimising number of MUC rooms
</A></li>
	<LI>Next message: <A HREF="089059.html">[jdev] Minimising number of MUC rooms
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#89058">[ date ]</a>
              <a href="thread.html#89058">[ thread ]</a>
              <a href="subject.html#89058">[ subject ]</a>
              <a href="author.html#89058">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://mail.jabber.org/mailman/listinfo/jdev">More information about the JDev
mailing list</a><br>
</body></html>
