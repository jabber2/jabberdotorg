<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [jdev] Minimising number of MUC rooms
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:jdev%40jabber.org?Subject=Re%3A%20%5Bjdev%5D%20Minimising%20number%20of%20MUC%20rooms&In-Reply-To=%3CB561991E-514A-4A73-ACFC-70825B32F102%40jivatechnology.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="089047.html">
   <LINK REL="Next"  HREF="089050.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[jdev] Minimising number of MUC rooms</H1>
    <B>Theo Cushion</B> 
    <A HREF="mailto:jdev%40jabber.org?Subject=Re%3A%20%5Bjdev%5D%20Minimising%20number%20of%20MUC%20rooms&In-Reply-To=%3CB561991E-514A-4A73-ACFC-70825B32F102%40jivatechnology.com%3E"
       TITLE="[jdev] Minimising number of MUC rooms">theo at jivatechnology.com
       </A><BR>
    <I>Wed May 30 09:43:28 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="089047.html">[jdev] Minimising number of MUC rooms
</A></li>
        <LI>Next message: <A HREF="089050.html">[jdev] Minimising number of MUC rooms
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#89049">[ date ]</a>
              <a href="thread.html#89049">[ thread ]</a>
              <a href="subject.html#89049">[ subject ]</a>
              <a href="author.html#89049">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
On 29 May 2012, at 19:28, Kevin Smith wrote:

&gt;<i> On Mon, Apr 30, 2012 at 4:17 PM, Theo Cushion &lt;<A HREF="http://mail.jabber.org/mailman/listinfo/jdev">theo at jivatechnology.com</A>&gt; wrote:
</I>&gt;&gt;<i> We use MUC rooms extensively within our site. They offer us a number of neat features that make them very useful. It gives us a central way to manage who talks to who, can accommodate groups of people chatting and gives us a neat way to deal with keeping a history of everything.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> However we've started to see performance issues with using so many MUC rooms (we knew we would get stung by this eventually). Users who have had large quantities of chats need to log into a room for every conversation. We do this so that if a message is posted in one of these rooms, it gets pushed out to all of the recipients and we can then in realtime show &quot;missed messages&quot; (rooms they are not viewing, but are interested in). However, most rooms sit there totally unused.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> Each use has a PEP node of rooms they are interested in, and when they log in to the site they get this list of rooms and join it.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> The only solution I can think of is to have this PEP list updated so that only rooms which have more than one person in them are shown. The downside is I'm going to end up with a lot more logic hooked on for when people log in and out of the system.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> How would you solve this?
</I>&gt;<i> 
</I>&gt;<i> Where are you seeing the performance problems with having many MUCs?
</I>&gt;<i> It should make no odds to a client that it's present in many empty
</I>&gt;<i> MUCs (although I guess if you're talking about thousands, the number
</I>&gt;<i> of join stanzas would get onerous), and servers are likely to scale
</I>&gt;<i> well (empty MUCs will be using almost no resources).
</I>&gt;<i> 
</I>&gt;<i> /K
</I>
The performance issue is in the client, every time we have a new connection it has to send a whole bunch of join stanzas. This may not sound like a big deal, but it causes a noticeable delay in all of the processing that has to be done when a page is first loaded.

Of course there are smarter ways of dealing with this, for example prioritising what must be done straight away, giving a nice responsive UI, and then backfilling things like joining the muc rooms. However, it seems unnecessary (for our application at least) for a couple of reasons; We KNOW people will want to join everytime - so why make them ask for it, it starts to step away from dumb client - smart server that I think is the mantra for XMPP implementations.

I imagine we are a fairly isolated in our application wanting clients to auto join rooms every time they connect, so there's no point in addressing this in the standard. However, linking in with the Muc/Pubsub (MEP?) could provide a great way to get around this issue, and be universally useful.

What do you think?

Theo

</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="089047.html">[jdev] Minimising number of MUC rooms
</A></li>
	<LI>Next message: <A HREF="089050.html">[jdev] Minimising number of MUC rooms
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#89049">[ date ]</a>
              <a href="thread.html#89049">[ thread ]</a>
              <a href="subject.html#89049">[ subject ]</a>
              <a href="author.html#89049">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://mail.jabber.org/mailman/listinfo/jdev">More information about the JDev
mailing list</a><br>
</body></html>
