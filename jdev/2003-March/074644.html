<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [JDEV] s2s/dialback/SOCKS
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:jdev%40jabber.org?Subject=Re%3A%20%5BJDEV%5D%20s2s/dialback/SOCKS&In-Reply-To=%3CF163zvsjC7dYBGbEsfB000184f1%40hotmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="074643.html">
   <LINK REL="Next"  HREF="074645.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[JDEV] s2s/dialback/SOCKS</H1>
    <B>Ragavan S</B> 
    <A HREF="mailto:jdev%40jabber.org?Subject=Re%3A%20%5BJDEV%5D%20s2s/dialback/SOCKS&In-Reply-To=%3CF163zvsjC7dYBGbEsfB000184f1%40hotmail.com%3E"
       TITLE="[JDEV] s2s/dialback/SOCKS">jabber_dev at hotmail.com
       </A><BR>
    <I>Tue Mar 25 15:13:30 CST 2003</I>
    <P><UL>
        <LI>Previous message: <A HREF="074643.html">[JDEV] Yaja connection problem (was RE: please help me)
</A></li>
        <LI>Next message: <A HREF="074645.html">[JDEV] s2s/dialback/SOCKS
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#74644">[ date ]</a>
              <a href="thread.html#74644">[ thread ]</a>
              <a href="subject.html#74644">[ subject ]</a>
              <a href="author.html#74644">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello,

I am trying to setup s2s communications between 2 jabber 1.4.2 servers on 
Linux machines with static IP addresses -- one on the internet and the other 
on a company intranet (behind a firewall).

Using ssh port forwards and iptables, I am able to establish network 
connectivity between these two machines. So, for example, from the external 
server (jabber-external.company.com), I am able to telnet to port 5269 of 
the internal server (jabber-internal.company.com) and similarly, from the 
internal server I am able to telnet out (using SOCKS).

I run the jabberd process on the external machine in a straightforward 
manner, while I socksify the jabberd process on the internal machine (so it 
can go outside).

However, the dialback protocol seems to fail. Thus, even though the two 
servers have network connectivity going both sides, the actual dialback 
process doesn't get validated and I get a Server Connect Failed error. A 
look at the jabberd debug logs reveals that the external server stops with a 
&lt;db:result&gt;33345..&lt;/db:result&gt; exchange while the internal server's last 
exchange seems to be a &lt;db:verify&gt;33345..&lt;/db:verify&gt; before it reports a 
&lt;stream:error&gt;I guess we're trying to use the wrong name, 
sorry&lt;/stream:error&gt;.

So, I am curious to find out if people have successfully gotten s2s 
communications working in such a scenario (inside/outside firewall), and if 
so, was there anything other than having bi-directional network connectivity 
open? Also, does anyone know if having a SOCKS server in between affect the 
dialback process (if the SOCKS server doesn't do any form of DNS function).

If this does have something to do with the dialback protocol itself, besides 
the upcoming SASL support for s2s in jabberd2, are there other options I can 
look at?

By the way, I can post the detailed debug logs if that would be more 
helpful, but I wanted to figure out if someone already has such a setup 
working well for them. I will also continue looking into this (maybe strace 
or tcpdump).

Thanks in advance for any insights, and let me know if you need more 
clarifications.

Ragavan

_________________________________________________________________
Add photos to your e-mail with MSN 8. Get 2 months FREE*.  
<A HREF="http://join.msn.com/?page=features/featuredemail">http://join.msn.com/?page=features/featuredemail</A>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="074643.html">[JDEV] Yaja connection problem (was RE: please help me)
</A></li>
	<LI>Next message: <A HREF="074645.html">[JDEV] s2s/dialback/SOCKS
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#74644">[ date ]</a>
              <a href="thread.html#74644">[ thread ]</a>
              <a href="subject.html#74644">[ subject ]</a>
              <a href="author.html#74644">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://mail.jabber.org/mailman/listinfo/jdev">More information about the JDev
mailing list</a><br>
</body></html>
