<tt>
&lt;html&gt;&lt;head&gt;&lt;meta&nbsp;http-equiv=&quot;Content-Type&quot;&nbsp;content=&quot;text/html;&nbsp;charset=us-ascii&quot;&gt;&lt;/head&gt;&lt;body&nbsp;style=&quot;word-wrap:&nbsp;break-word;&nbsp;-webkit-nbsp-mode:&nbsp;space;&nbsp;line-break:&nbsp;after-white-space;&quot;&nbsp;class=&quot;&quot;&gt;On&nbsp;3&nbsp;Mar&nbsp;2021,&nbsp;at&nbsp;20:12,&nbsp;george&nbsp;b&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:scooterschorschi@gmail.com&quot;&nbsp;class=&quot;&quot;&gt;scooterschorschi@gmail.com&lt;/a&gt;&gt;&nbsp;wrote:&lt;br&nbsp;class=&quot;&quot;&gt;&lt;div&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;Apple-interchange-newline&quot;&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&nbsp;class=&quot;&quot;&gt;&lt;div&nbsp;class=&quot;&quot;&gt;Hello&nbsp;everyone&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;Today&nbsp;I&nbsp;have&nbsp;question,&nbsp;specific&nbsp;to&nbsp;Swiften.&nbsp;So&nbsp;maybe&nbsp;Kevin&nbsp;could&nbsp;answer&nbsp;this&nbsp;;-)?&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;My&nbsp;omemo&nbsp;implementation&nbsp;works&nbsp;as&nbsp;expected&nbsp;now.&nbsp;But&nbsp;from&nbsp;an&nbsp;architecture&nbsp;or&nbsp;performance&nbsp;point&nbsp;of&nbsp;view,&nbsp;it&nbsp;is&nbsp;not&nbsp;really&nbsp;smart&nbsp;implemented.&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;The&nbsp;LurchAdapter&nbsp;Class&nbsp;(which&nbsp;handles&nbsp;all&nbsp;the&nbsp;message&nbsp;parsing&nbsp;and&nbsp;forwarding&nbsp;to&nbsp;lurch&nbsp;[1])&nbsp;catches&nbsp;each&nbsp;incoming&nbsp;Swift::Message&nbsp;stanza.&nbsp;This&nbsp;stanza&nbsp;will&nbsp;be&nbsp;serialized&nbsp;to&nbsp;a&nbsp;std::string&nbsp;[2].&nbsp;Just&nbsp;to&nbsp;be&nbsp;able&nbsp;to&nbsp;parse&nbsp;out&nbsp;the&nbsp;&lt;items&gt;&nbsp;or&nbsp;the&nbsp;&lt;encrypted&gt;&nbsp;xml&nbsp;part&nbsp;within&nbsp;a&nbsp;message&nbsp;[3].&nbsp;This&nbsp;part&nbsp;will&nbsp;then&nbsp;be&nbsp;forwarded&nbsp;to&nbsp;lurch,&nbsp;which&nbsp;does&nbsp;the&nbsp;real&nbsp;work&nbsp;on&nbsp;it.&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;While&nbsp;this&nbsp;works,&nbsp;especially&nbsp;on&nbsp;an&nbsp;embedded&nbsp;device&nbsp;(mobile&nbsp;phone)&nbsp;this&nbsp;has&nbsp;an&nbsp;huge&nbsp;resource&nbsp;impact.&nbsp;I&nbsp;tried&nbsp;to&nbsp;get&nbsp;into&nbsp;swiften&nbsp;in&nbsp;more&nbsp;depth&nbsp;and&nbsp;tried&nbsp;to&nbsp;implement&nbsp;a&nbsp;class,&nbsp;derived&nbsp;from&nbsp;Swift::Payload,&nbsp;which&nbsp;should&nbsp;do&nbsp;the&nbsp;parsing&nbsp;for&nbsp;the&nbsp;'items'&nbsp;or&nbsp;'encrypted'&nbsp;payload&nbsp;part.&nbsp;But&nbsp;I&nbsp;don't&nbsp;know&nbsp;how&nbsp;to&nbsp;integrate&nbsp;it&nbsp;in&nbsp;the&nbsp;overall&nbsp;parsing&nbsp;of&nbsp;incoming&nbsp;stanzas.&nbsp;My&nbsp;target&nbsp;would&nbsp;be&nbsp;to&nbsp;have&nbsp;it&nbsp;somehow&nbsp;integrated&nbsp;in&nbsp;a&nbsp;derived&nbsp;class&nbsp;of&nbsp;Swift::Message&nbsp;which&nbsp;could&nbsp;provide&nbsp;me&nbsp;with&nbsp;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;std::string&nbsp;Message::getItems()&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;std::string&nbsp;Message::getEncrypted()&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;Any&nbsp;hints&nbsp;on&nbsp;how&nbsp;to&nbsp;do&nbsp;this,&nbsp;or&nbsp;any&nbsp;clever&nbsp;alternatives&nbsp;are&nbsp;appreciated&nbsp;:-).&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&gt;If&nbsp;you&nbsp;want&nbsp;a&nbsp;new&nbsp;payload&nbsp;type&nbsp;in&nbsp;Swiften,&nbsp;the&nbsp;quickest&nbsp;way&nbsp;is&nbsp;to&nbsp;follow&nbsp;the&nbsp;dev&nbsp;guide&nbsp;-&nbsp;&lt;a&nbsp;href=&quot;https://swift.im/swiften/guide/#Section-Extending&quot;&nbsp;class=&quot;&quot;&gt;https://swift.im/swiften/guide/#Section-Extending&lt;/a&gt;&lt;/div&gt;&lt;div&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&gt;/K&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;
</tt>
