<tt>
&lt;div&gt;&lt;p&gt;I&nbsp;think&nbsp;you&nbsp;might&nbsp;see&nbsp;this&nbsp;if&nbsp;there's&nbsp;no&nbsp;XEP-0198&nbsp;between&nbsp;servers&nbsp;and&nbsp;the&nbsp;old&nbsp;TCP&nbsp;session&nbsp;is&nbsp;still&nbsp;present&nbsp;on&nbsp;server2.&lt;br/&gt;&lt;br/&gt;The&nbsp;presence&nbsp;response&nbsp;would&nbsp;go&nbsp;down&nbsp;this&nbsp;dead&nbsp;session,&nbsp;then&nbsp;it'd&nbsp;be&nbsp;detected&nbsp;as&nbsp;dead&nbsp;(TCP&nbsp;RST&nbsp;from&nbsp;server1),&nbsp;but&nbsp;typically&nbsp;the&nbsp;presence&nbsp;won't&nbsp;be&nbsp;resent,&nbsp;as&nbsp;it'll&nbsp;have&nbsp;been&nbsp;lost&nbsp;on&nbsp;the&nbsp;wire.&lt;br/&gt;&lt;br/&gt;The&nbsp;solution&nbsp;is&nbsp;basically&nbsp;XEP-0198&nbsp;on&nbsp;S2S&nbsp;links&nbsp;-&nbsp;you&nbsp;don't&nbsp;even&nbsp;need&nbsp;to&nbsp;do&nbsp;session&nbsp;resumption&nbsp;for&nbsp;it&nbsp;to&nbsp;be&nbsp;a&nbsp;substantial&nbsp;improvement&nbsp;here.&lt;br/&gt;&lt;br/&gt;&lt;font&nbsp;color&nbsp;=&quot;#888888&quot;&gt;&lt;p&gt;&lt;font&nbsp;color&nbsp;=&quot;#888888&quot;&gt;Sent&nbsp;from&nbsp;my&nbsp;android&nbsp;device.&lt;/font&gt;&lt;/p&gt;<br>
&lt;/font&gt;&lt;/p&gt;<br>
&lt;br/&gt;&lt;br/&gt;-----Original&nbsp;Message-----&lt;br/&gt;From:&nbsp;Kevin&nbsp;Smith&nbsp;&lt;kevin@kismith.co.uk&gt;&lt;br/&gt;To:&nbsp;Jabber/XMPP&nbsp;software&nbsp;development&nbsp;list&nbsp;&lt;jdev@jabber.org&gt;&lt;br/&gt;Sent:&nbsp;Wed,&nbsp;21&nbsp;Mar&nbsp;2012&nbsp;9:20&nbsp;AM&lt;br/&gt;Subject:&nbsp;Re:&nbsp;[jdev]&nbsp;Problem&nbsp;receiving&nbsp;presence&nbsp;after&nbsp;power&nbsp;outage&lt;br/&gt;&lt;br/&gt;&lt;/div&gt;&lt;p&gt;On&nbsp;Wed,&nbsp;Mar&nbsp;21,&nbsp;2012&nbsp;at&nbsp;9:12&nbsp;AM,&nbsp;Mark&nbsp;Gabriel&nbsp;Paylaga&#13;&lt;br&gt;<br>
&lt;&lt;a&nbsp;href=&quot;mailto:mpaylaga@gmail.com&quot;&gt;mpaylaga@gmail.com&lt;/a&gt;&gt;&nbsp;wrote:&#13;&lt;br&gt;<br>
&gt;&nbsp;Hello,&#13;&lt;br&gt;<br>
&gt;&#13;&lt;br&gt;<br>
&gt;&nbsp;Has&nbsp;anyone&nbsp;tried&nbsp;this&nbsp;before?&nbsp;:&#13;&lt;br&gt;<br>
&gt;&#13;&lt;br&gt;<br>
&gt;&nbsp;1.)&#160;&nbsp;Server1&nbsp;receives&nbsp;presence&nbsp;from&nbsp;Server2.&#13;&lt;br&gt;<br>
&gt;&#13;&lt;br&gt;<br>
&gt;&nbsp;2.)&#160;&nbsp;Power&nbsp;off&nbsp;Server1&nbsp;(meaning&nbsp;no&nbsp;graceful&nbsp;exit,&nbsp;jabber&nbsp;still&nbsp;running&nbsp;and&#13;&lt;br&gt;<br>
&gt;&nbsp;other&nbsp;services&nbsp;then&nbsp;literally&nbsp;just&nbsp;switch&nbsp;off&nbsp;the&nbsp;server&nbsp;or&nbsp;unplug&nbsp;it).&#13;&lt;br&gt;<br>
&gt;&#13;&lt;br&gt;<br>
&gt;&nbsp;3.)&#160;&nbsp;Restart&nbsp;Server1&nbsp;(start&nbsp;all&nbsp;services&nbsp;including&nbsp;jabber).&#13;&lt;br&gt;<br>
&gt;&#13;&lt;br&gt;<br>
&gt;&nbsp;Result:&#160;&nbsp;Server1&nbsp;does&nbsp;not&nbsp;receive&nbsp;Server2's&nbsp;presence.&#13;&lt;br&gt;<br>
&gt;&nbsp;Solution:&nbsp;Restart&nbsp;services&nbsp;in&nbsp;Server2.&#160;&nbsp;Server1&nbsp;will&nbsp;receive&nbsp;the&nbsp;presence.&#13;&lt;br&gt;<br>
&gt;&#13;&lt;br&gt;<br>
&gt;&nbsp;Is&nbsp;this&nbsp;because&nbsp;Server2&nbsp;is&nbsp;still&nbsp;holding&nbsp;on&nbsp;to&nbsp;the&nbsp;old&nbsp;jabber&nbsp;session&nbsp;ID&nbsp;or&#13;&lt;br&gt;<br>
&gt;&nbsp;something?&#13;&lt;br&gt;<br>
&#13;&lt;br&gt;<br>
This&nbsp;shouldn't&nbsp;happen.&nbsp;When&nbsp;Server1&nbsp;comes&nbsp;back&nbsp;online,&nbsp;it'll&nbsp;signal&#13;&lt;br&gt;<br>
that&nbsp;it&nbsp;wants&nbsp;presence&nbsp;for&nbsp;the&nbsp;newly&nbsp;online&nbsp;user@server1,&nbsp;and&nbsp;server2&#13;&lt;br&gt;<br>
should&nbsp;be&nbsp;willing&nbsp;to&nbsp;provide&nbsp;it&nbsp;(subject&nbsp;to&nbsp;subscription&nbsp;states&nbsp;being&#13;&lt;br&gt;<br>
right,&nbsp;etc.).&#13;&lt;br&gt;<br>
&#13;&lt;br&gt;<br>
Is&nbsp;this&nbsp;a&nbsp;&nbsp;general&nbsp;problem&nbsp;you&nbsp;see,&nbsp;or&nbsp;with&nbsp;specific&nbsp;services?&#13;&lt;br&gt;<br>
&#13;&lt;br&gt;<br>
/K&#13;&lt;br&gt;<br>
_______________________________________________&#13;&lt;br&gt;<br>
JDev&nbsp;mailing&nbsp;list&#13;&lt;br&gt;<br>
Info:&nbsp;&lt;a&nbsp;href=&quot;http://mail.jabber.org/mailman/listinfo/jdev&quot;&gt;http://mail.jabber.org/mailman/listinfo/jdev&lt;/a&gt;&#13;&lt;br&gt;<br>
Unsubscribe:&nbsp;&lt;a&nbsp;href=&quot;mailto:JDev-unsubscribe@jabber.org&quot;&gt;JDev-unsubscribe@jabber.org&lt;/a&gt;&#13;&lt;br&gt;<br>
_______________________________________________&#13;&lt;br&gt;<br>
&lt;/p&gt;<br>

</tt>
