<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [jdev] Swiften Question about payload parsing
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:jdev%40jabber.org?Subject=Re%3A%20%5Bjdev%5D%20Swiften%20Question%20about%20payload%20parsing&In-Reply-To=%3CCAL30P%2BZXea8udGMJwDix9a7ed2uX%3DtvrfgHJQ0NmRk1aGwpgqg%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   
   <LINK REL="Next"  HREF="090446.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[jdev] Swiften Question about payload parsing</H1>
    <B>george b</B> 
    <A HREF="mailto:jdev%40jabber.org?Subject=Re%3A%20%5Bjdev%5D%20Swiften%20Question%20about%20payload%20parsing&In-Reply-To=%3CCAL30P%2BZXea8udGMJwDix9a7ed2uX%3DtvrfgHJQ0NmRk1aGwpgqg%40mail.gmail.com%3E"
       TITLE="[jdev] Swiften Question about payload parsing">scooterschorschi at gmail.com
       </A><BR>
    <I>Wed Mar  3 20:12:29 UTC 2021</I>
    <P><UL>
        
        <LI>Next message: <A HREF="090446.html">[jdev] Swiften Question about payload parsing
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#90445">[ date ]</a>
              <a href="thread.html#90445">[ thread ]</a>
              <a href="subject.html#90445">[ subject ]</a>
              <a href="author.html#90445">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello everyone

Today I have question, specific to Swiften. So maybe Kevin could answer
this ;-)?

My omemo implementation works as expected now. But from an architecture or
performance point of view, it is not really smart implemented.

The LurchAdapter Class (which handles all the message parsing and
forwarding to lurch [1]) catches each incoming Swift::Message stanza. This
stanza will be serialized to a std::string [2]. Just to be able to parse
out the &lt;items&gt; or the &lt;encrypted&gt; xml part within a message [3]. This part
will then be forwarded to lurch, which does the real work on it.

While this works, especially on an embedded device (mobile phone) this has
an huge resource impact. I tried to get into swiften in more depth and
tried to implement a class, derived from Swift::Payload, which should do
the parsing for the 'items' or 'encrypted' payload part. But I don't know
how to integrate it in the overall parsing of incoming stanzas. My target
would be to have it somehow integrated in a derived class of Swift::Message
which could provide me with
std::string Message::getItems()
std::string Message::getEncrypted()

Any hints on how to do this, or any clever alternatives are appreciated :-).

Best regards
George

[1] <A HREF="https://github.com/gkdr/lurch/">https://github.com/gkdr/lurch/</A>
[2]
<A HREF="https://github.com/geobra/harbour-shmoose/blob/80da28bc87aa0fb3ed600db9ba6cb2b8e18f5500/source/xep/omemo/LurchAdapter.cpp#L448">https://github.com/geobra/harbour-shmoose/blob/80da28bc87aa0fb3ed600db9ba6cb2b8e18f5500/source/xep/omemo/LurchAdapter.cpp#L448</A>
[3] <A HREF="https://xmpp.org/extensions/xep-0384.html">https://xmpp.org/extensions/xep-0384.html</A>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="https://www.jabber.org/jdev/attachments/20210303/99483170/attachment.html">https://www.jabber.org/jdev/attachments/20210303/99483170/attachment.html</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	
	<LI>Next message: <A HREF="090446.html">[jdev] Swiften Question about payload parsing
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#90445">[ date ]</a>
              <a href="thread.html#90445">[ thread ]</a>
              <a href="subject.html#90445">[ subject ]</a>
              <a href="author.html#90445">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://mail.jabber.org/mailman/listinfo/jdev">More information about the JDev
mailing list</a><br>
</body></html>
