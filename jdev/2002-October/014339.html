<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [JDEV] jabberd behind NAT fails s2s interoperation
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:jdev%40jabber.org?Subject=%5BJDEV%5D%20jabberd%20behind%20NAT%20fails%20s2s%20interoperation&In-Reply-To=3D9B5017.7010507%40unboundtech.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014338.html">
   <LINK REL="Next"  HREF="014341.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[JDEV] jabberd behind NAT fails s2s interoperation</H1>
    <B>Trent Melcher</B> 
    <A HREF="mailto:jdev%40jabber.org?Subject=%5BJDEV%5D%20jabberd%20behind%20NAT%20fails%20s2s%20interoperation&In-Reply-To=3D9B5017.7010507%40unboundtech.com"
       TITLE="[JDEV] jabberd behind NAT fails s2s interoperation">tmelcher at trilogytel.com
       </A><BR>
    <I>Wed Oct  2 15:33:29 CDT 2002</I>
    <P><UL>
        <LI>Previous message: <A HREF="014338.html">[JDEV] jabberd behind NAT fails s2s interoperation
</A></li>
        <LI>Next message: <A HREF="014341.html">[JDEV] jabberd behind NAT fails s2s interoperation
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14339">[ date ]</a>
              <a href="thread.html#14339">[ thread ]</a>
              <a href="subject.html#14339">[ subject ]</a>
              <a href="author.html#14339">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>yes c2s behind a NAT firewall works fine, but have you gotten a s2s
connection to work from behind a NAT firewall??

Trent

-----Original Message-----
From: <A HREF="http://mail.jabber.org/mailman/listinfo/jdev">jdev-admin at jabber.org</A> [mailto:<A HREF="http://mail.jabber.org/mailman/listinfo/jdev">jdev-admin at jabber.org</A>]On Behalf Of
Justin Georgeson
Sent: Wednesday, October 02, 2002 2:59 PM
To: <A HREF="http://mail.jabber.org/mailman/listinfo/jdev">jdev at jabber.org</A>
Subject: Re: [JDEV] jabberd behind NAT fails s2s interoperation


My server behind a NAT is configured with the public FQDN in the &lt;host&gt;
tag, and has &lt;alias to='name'&gt; in the c2s section. I don't ever bind to
a specific IP address (&lt;ip port='5222'/&gt;  binds to all available
interfaces). The FQDN resolves to the public IP address, and I have port
5222, 5223, and 5269 forwarded to the jabber server. I guess the only
thinkg left I can think of to check is if the NATis actually working.
For example, try to telnet to goof.com on port 5269 from outside the
NAT. Also, you can see the public internet form the jabberd box (like
browse the web and such)?

matthew c. mead wrote:
&gt;<i> I've still not been able to get this going.
</I>&gt;<i>
</I>&gt;<i> Is anyone else out there running a jabber server behind a nat
</I>&gt;<i> firewall and getting s2s to work with success?
</I>&gt;<i>
</I>&gt;<i> Thanks.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> -matt
</I>&gt;<i>
</I>&gt;<i> On Thu, Sep 26, 2002 at 01:55:20PM -0400, matthew c. mead wrote:
</I>&gt;<i>
</I>&gt;&gt;<i>I do not use the -h switch.  I do have the following in
</I>&gt;&gt;<i>jabber.xml as an element in the &lt;service id=&quot;sessions&quot;&gt; element:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>&lt;host&gt;goof.com&lt;/host&gt;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>-matt
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>On Thu, Sep 26, 2002 at 12:07:28PM -0500, Justin Georgeson wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>No, the receiving server does a dns lookup of the hostname given to find
</I>&gt;&gt;&gt;<i>the ip address to contact for verification. When you start jabber, do
</I>&gt;&gt;&gt;<i>you give it a -h flag? If so that value needs to resolve, via DNS to the
</I>&gt;&gt;&gt;<i>ip of your nat. If not, use the value of the &lt;host&gt; tag right after the
</I>&gt;&gt;&gt;<i>start of the &lt;service id=&quot;sessions&quot;&gt; tag in jabber.xml. From what you
</I>&gt;&gt;&gt;<i>have said so far, you should be using goof.com as the &lt;host&gt;/-h value.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>matthew c. mead wrote:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>On Thu, Sep 26, 2002 at 04:58:51PM +0100, Richard Dobson wrote:
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i>Yeah, I found that one out by trying.  I still don't see what's
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i>going wrong.
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i>Does dialback require that the ip address specified by the A
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i>record for the server name have a PTR which points back to the
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i>server name?
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>No you do not need a PTR but the domain your server is claiming to be
</I>needs
&gt;&gt;&gt;&gt;&gt;<i>to point to the machine you are trying to use.
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>I have an A record for goof.com that points to a NAT box.  That
</I>&gt;&gt;&gt;&gt;<i>box forwards packets on the jabber ports to a box on my internal
</I>&gt;&gt;&gt;&gt;<i>network that runs the jabber server.
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>I do not have a PTR record for the ip address that points to the
</I>&gt;&gt;&gt;&gt;<i>canonical name &quot;goof.com.&quot;
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>Given this, I can't figure out what's wrong.  Does the dialback
</I>&gt;&gt;&gt;&gt;<i>code pass the IP address of the interface to which it is bound to
</I>&gt;&gt;&gt;&gt;<i>the remote server?  If so, this could be the problem - in my
</I>&gt;&gt;&gt;&gt;<i>case, it would be passing the internal ip address, rather than
</I>&gt;&gt;&gt;&gt;<i>the external.
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>Thanks for helping me eliminate the worry of needing a PTR
</I>&gt;&gt;&gt;&gt;<i>record.  My guess is what I've described above is happening.
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>-matt
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>--
</I>&gt;&gt;&gt;<i>Justin Georgeson
</I>&gt;&gt;&gt;<i>UnBound Technologies, Inc.
</I>&gt;&gt;&gt;<i><A HREF="http://www.unboundtech.com">http://www.unboundtech.com</A>
</I>&gt;&gt;&gt;<i>Main   713.329.9330
</I>&gt;&gt;&gt;<i>Fax    713.460.4051
</I>&gt;&gt;&gt;<i>Mobile 512.789.1962
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>5295 Hollister Road
</I>&gt;&gt;&gt;<i>Houston, TX 77040
</I>&gt;&gt;&gt;<i>Real Applications using Real Wireless Intelligence(tm)
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>_______________________________________________
</I>&gt;&gt;&gt;<i>jdev mailing list
</I>&gt;&gt;&gt;<i><A HREF="http://mail.jabber.org/mailman/listinfo/jdev">jdev at jabber.org</A>
</I>&gt;&gt;&gt;<i><A HREF="http://mailman.jabber.org/listinfo/jdev">http://mailman.jabber.org/listinfo/jdev</A>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>--
</I>&gt;&gt;<i>matthew c. mead
</I>&gt;&gt;<i>
</I>&gt;&gt;<i><A HREF="http://www.goof.com/~mmead/">http://www.goof.com/~mmead/</A>
</I>&gt;&gt;<i>_______________________________________________
</I>&gt;&gt;<i>jdev mailing list
</I>&gt;&gt;<i><A HREF="http://mail.jabber.org/mailman/listinfo/jdev">jdev at jabber.org</A>
</I>&gt;&gt;<i><A HREF="http://mailman.jabber.org/listinfo/jdev">http://mailman.jabber.org/listinfo/jdev</A>
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>
--
Justin Georgeson
UnBound Technologies, Inc.
<A HREF="http://www.unboundtech.com">http://www.unboundtech.com</A>
Main   713.329.9330
Fax    713.460.4051
Mobile 512.789.1962

5295 Hollister Road
Houston, TX 77040
Real Applications using Real Wireless Intelligence(tm)

_______________________________________________
jdev mailing list
<A HREF="http://mail.jabber.org/mailman/listinfo/jdev">jdev at jabber.org</A>
<A HREF="http://mailman.jabber.org/listinfo/jdev">http://mailman.jabber.org/listinfo/jdev</A>



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="014338.html">[JDEV] jabberd behind NAT fails s2s interoperation
</A></li>
	<LI>Next message: <A HREF="014341.html">[JDEV] jabberd behind NAT fails s2s interoperation
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14339">[ date ]</a>
              <a href="thread.html#14339">[ thread ]</a>
              <a href="subject.html#14339">[ subject ]</a>
              <a href="author.html#14339">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://mail.jabber.org/mailman/listinfo/jdev">More information about the JDev
mailing list</a><br>
</body></html>
