<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [jdev] Managing Subscriptions
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:jdev%40jabber.org?Subject=Re%3A%20%5Bjdev%5D%20Managing%20Subscriptions&In-Reply-To=%3C471C9DD9.9090507%40measham.id.au%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="055983.html">
   <LINK REL="Next"  HREF="055986.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[jdev] Managing Subscriptions</H1>
    <B>Rick Measham</B> 
    <A HREF="mailto:jdev%40jabber.org?Subject=Re%3A%20%5Bjdev%5D%20Managing%20Subscriptions&In-Reply-To=%3C471C9DD9.9090507%40measham.id.au%3E"
       TITLE="[jdev] Managing Subscriptions">rick at measham.id.au
       </A><BR>
    <I>Mon Oct 22 07:55:53 CDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="055983.html">[jdev] How to specify username with SASL ANONYMOUS
</A></li>
        <LI>Next message: <A HREF="055986.html">[jdev] Managing Subscriptions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#55985">[ date ]</a>
              <a href="thread.html#55985">[ thread ]</a>
              <a href="subject.html#55985">[ subject ]</a>
              <a href="author.html#55985">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I'm trying to sort out how to get a bot to deal with subscriptions and 
the RFC is just confusing me -- it switches between what a server should 
do and what a client should do too often!

The docs here: 
<A HREF="http://wiki.jabber.org/index.php/Programming_Jabber_Clients">http://wiki.jabber.org/index.php/Programming_Jabber_Clients</A> :are really 
good .. but they don't talk about subscriptions at all.

Can someone help me work this out?

I'm using the perl module Net::XMPP if anyone has any code lying around :-D

I want to receive subscription requests and, if the subscriber matches 
particular criteria I want to accept the subscription. If they don't, I 
want to refuse it.

It all feels rather easy really. But GMail users are telling me that the 
bot never appears on their user list. I use gaim personally, and have no 
problem at all. Parts of the RFC make me think I need to manually update 
the roster, and then other parts make me think the server will do all 
that for me.

I figure I should be putting my handling in a place that handles 
'subscribe' presences:
	&lt;presence from='<A HREF="http://mail.jabber.org/mailman/listinfo/jdev">whoever at gmail.com</A>' to='<A HREF="http://mail.jabber.org/mailman/listinfo/jdev">example at jabber.org</A>/bot' 
type='subscribe'/&gt;

And I figure that I should reply with a 'subscribed' presence:
$Connection-&gt;Subscription(
	type =&gt; &quot;subscribed&quot;,
	to   =&gt; '<A HREF="http://mail.jabber.org/mailman/listinfo/jdev">whoever at gmail.com</A>'
);

Should I then follow that up with a reciprocal 'subscribe' request?
$Connection-&gt;Subscription(
	type =&gt; &quot;subscribe&quot;,
	to   =&gt; '<A HREF="http://mail.jabber.org/mailman/listinfo/jdev">whoever at gmail.com</A>'
);

Coz that's what I'm doing .. and it doesn't seem to be working. When I 
look at my 'roster', there's a lot of 'None' in there ... which leads me 
to think maybe I have to update the roster myself. But I tried that, and 
getting the roster again showed that it hadn't changed at all.

ANY help would be greatly appreciated.

Cheers!
Rick Measham

















-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/x-pkcs7-signature
Size: 3241 bytes
Desc: S/MIME Cryptographic Signature
URL: &lt;<A HREF="https://www.jabber.org/jdev/attachments/20071022/82e53461/attachment-0001.bin">https://www.jabber.org/jdev/attachments/20071022/82e53461/attachment-0001.bin</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="055983.html">[jdev] How to specify username with SASL ANONYMOUS
</A></li>
	<LI>Next message: <A HREF="055986.html">[jdev] Managing Subscriptions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#55985">[ date ]</a>
              <a href="thread.html#55985">[ thread ]</a>
              <a href="subject.html#55985">[ subject ]</a>
              <a href="author.html#55985">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://mail.jabber.org/mailman/listinfo/jdev">More information about the JDev
mailing list</a><br>
</body></html>
