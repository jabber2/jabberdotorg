<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [JDEV] XDB_SQL: Problems with the stored &quot;token&quot; value in &quot;users0k&quot; table
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:jdev%40jabber.org?Subject=%5BJDEV%5D%20XDB_SQL%3A%20Problems%20with%20the%20stored%20%22token%22%20value%20in%20%22users0k%22%20table&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016234.html">
   <LINK REL="Next"  HREF="016263.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[JDEV] XDB_SQL: Problems with the stored &quot;token&quot; value in &quot;users0k&quot; table</H1>
    <B>Tijl Houtbeckers</B> 
    <A HREF="mailto:jdev%40jabber.org?Subject=%5BJDEV%5D%20XDB_SQL%3A%20Problems%20with%20the%20stored%20%22token%22%20value%20in%20%22users0k%22%20table&In-Reply-To="
       TITLE="[JDEV] XDB_SQL: Problems with the stored &quot;token&quot; value in &quot;users0k&quot; table">thoutbeckers at splendo.com
       </A><BR>
    <I>Thu Apr 17 12:26:32 CDT 2003</I>
    <P><UL>
        <LI>Previous message: <A HREF="016234.html">[JDEV] Jabber Client for Windows CE....Help!!
</A></li>
        <LI>Next message: <A HREF="016263.html">[JDEV] XDB_SQL: Problems with the stored &quot;token&quot; value in &quot;users0k&quot; table
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16232">[ date ]</a>
              <a href="thread.html#16232">[ thread ]</a>
              <a href="subject.html#16232">[ subject ]</a>
              <a href="author.html#16232">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&quot;Alexis Darnois&quot; &lt;<A HREF="http://mail.jabber.org/mailman/listinfo/jdev">alexis.darnois at terravirtual.net</A>&gt; wrote on 15-4-2003 
19:07:40: 
&gt;<i>
</I>&gt;<i>Hi all,
</I>&gt;<i>
</I>&gt;<i>About the &quot;token&quot; field written by XDB_SQL module  in the &quot;users0k&quot; 
</I>&gt;<i>table, it seems that the original token is transformed before beeing 
</I>&gt;<i>inserted, the token is generated by this line in &quot;mod_auth_0k.c&quot; (line 
</I>&gt;<i>94):
</I>
Note that there are important issues with 0k.

Here is a repost (from someone else) from the SJIG mailinglist:

----------

Matthias Wimmer &lt;<A HREF="http://mail.jabber.org/mailman/listinfo/jdev">m at tthias.net</A>&gt; wrote on 12-4-2003 20:00:36:

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
 
Hi!
 
 
I see two problems with the 0k authentication protocol of Jabber and
would like to get some comments on these two issues.
 
1.
With each login a counter is decremented by the server. This counter is
sent to the client before it authenticates with the server. (To tell the
client which hash it has to send to the server.)
This counter can be queried by everybody as it is send to the client
before it is authenticated. With this information everybody can
determine how often a user (that uses 0k) has logged in to its account.
By checking the counter regularly one can check at which times a user
(that uses 0k) logs in to the Jabber server.
 
2.
If an attacker manages to redirect a login attempt to its own server
(e.g. by a DNS attack) he can query a hash value with a low sequence
number from the client. With this hash value he can calculate all the
following hash values and use them to login to the (real) Jabber server.
Especially he can use this hashes not only at the moment he gets them.
As he knows all hash values with a higher sequence number he can use
them later - after he has removed everything that could be used to
identify the attacker.
 
I think these two problems make 0k-authentication less secure than
digenst authentication. I propose that Jabber server administrators
should disable 0k as most clients will use digest authentication then.
 
One small note: Jabber's 0k authentication protocol is not a &quot;zero
knowledge authentication&quot; protocol as this term is defined in 
cryptology. 
 
 
Tot kijk
~    Matthias
 
- --
Fon: +49-(0)70 0770 07770       <A HREF="http://matthias.wimmer.name/">http://matthias.wimmer.name/</A>
Fax: +49-(0)89-312 88 654         <A HREF="jabber://mawis@charente.de">jabber://mawis@charente.de</A>
HAM: DB1MW     OpenPGP: <A HREF="http://matthias.wimmer.name/encrypt/">http://matthias.wimmer.name/encrypt/</A>
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.1 (MingW32)
Comment: Using GnuPG with Mozilla - <A HREF="http://enigmail.mozdev.org">http://enigmail.mozdev.org</A>
 
iD8DBQE+mFRDJ/5jVqqDmvkRArB2AJ4/xChJ61w1n+qrbHxhxejU1sjWcACfdsSS
7+FM81PhysGqcJA/AevAFMM=
=kazY
-----END PGP SIGNATURE-----
 
_______________________________________________
Standards-JIG mailing list
<A HREF="http://mail.jabber.org/mailman/listinfo/jdev">Standards-JIG at jabber.org</A>
<A HREF="http://mailman.jabber.org/listinfo/standards-jig">http://mailman.jabber.org/listinfo/standards-jig</A>

-- 
Tijl Houtbeckers
Software Engineer @ Splendo
The Netherlands


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="016234.html">[JDEV] Jabber Client for Windows CE....Help!!
</A></li>
	<LI>Next message: <A HREF="016263.html">[JDEV] XDB_SQL: Problems with the stored &quot;token&quot; value in &quot;users0k&quot; table
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16232">[ date ]</a>
              <a href="thread.html#16232">[ thread ]</a>
              <a href="subject.html#16232">[ subject ]</a>
              <a href="author.html#16232">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://mail.jabber.org/mailman/listinfo/jdev">More information about the JDev
mailing list</a><br>
</body></html>
