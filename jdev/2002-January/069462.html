<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [standards-jig] Re: [JDEV] XML Conformance
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:jdev%40jabber.org?Subject=Re%3A%20%5Bstandards-jig%5D%20Re%3A%20%5BJDEV%5D%20XML%20Conformance&In-Reply-To=%3C20020117144603.F2BB92411A%40lito.aspect.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="069454.html">
   <LINK REL="Next"  HREF="069467.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[standards-jig] Re: [JDEV] XML Conformance</H1>
    <B>Julian Missig</B> 
    <A HREF="mailto:jdev%40jabber.org?Subject=Re%3A%20%5Bstandards-jig%5D%20Re%3A%20%5BJDEV%5D%20XML%20Conformance&In-Reply-To=%3C20020117144603.F2BB92411A%40lito.aspect.net%3E"
       TITLE="[standards-jig] Re: [JDEV] XML Conformance">julian at aspect.net
       </A><BR>
    <I>Thu Jan 17 08:46:03 CST 2002</I>
    <P><UL>
        <LI>Previous message: <A HREF="069454.html">[JDEV] jabber over ipv6
</A></li>
        <LI>Next message: <A HREF="069467.html">[standards-jig] Re: [JDEV] XML Conformance
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#69462">[ date ]</a>
              <a href="thread.html#69462">[ thread ]</a>
              <a href="subject.html#69462">[ subject ]</a>
              <a href="author.html#69462">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Daniel Veillard wrote:
*SNIP*

/me admits defeat and crossposts

&gt;<i> 
</I>&gt;&gt;<i>First off, the id attribute: the id *MUST* start with an alphabetic 
</I>&gt;&gt;<i>character, but can contain numbers after that.
</I>&gt;&gt;<i>Reference: XML 1.0 Recommendation:
</I>&gt;&gt;<i>&quot;Values of type ID must match the Name production. A name must not 
</I>&gt;&gt;<i>appear more than once in an XML document as a value of this type; i.e., 
</I>&gt;&gt;<i>ID values must uniquely identify the elements which bear them.&quot;
</I>&gt;&gt;<i>The definition of Name:
</I>&gt;&gt;<i>Name    ::=    (Letter | '_' | ':') (NameChar)*
</I>&gt;&gt;<i>definition of NameChar:
</I>&gt;&gt;<i>NameChar    ::=    Letter | Digit | '.' | '-' | '_' | ':' | 
</I>&gt;&gt;<i>CombiningChar | Extender
</I>&gt;&gt;<i>definition of Letter: <A HREF="http://www.w3.org/TR/2000/REC-xml-20001006#NT-Letter">http://www.w3.org/TR/2000/REC-xml-20001006#NT-Letter</A>
</I>&gt;&gt;<i>So therefore, ids may start with a letter, an underscore, or a colon, 
</I>&gt;&gt;<i>and then have all the numbers your pretty little heart desires. However, 
</I>&gt;&gt;<i>'2' is not a valid id.
</I>&gt;&gt;<i>
</I>&gt;<i> 
</I>&gt;<i>   NOTE: this is a validity error, not a well formedness error ! Does Jabber
</I>&gt;<i>         require validity level (and in this case where is the DTD because
</I>&gt;<i> 	there is no way in hell you have the right to define a validity
</I>&gt;<i> 	constraints if you don't have a DTD &gt;:-&gt; . I found some at
</I>&gt;<i> 	<A HREF="http://www.saint-andre.com/jabber/dtds/">http://www.saint-andre.com/jabber/dtds/</A> but not on the Jabber site,
</I>&gt;<i> 	so I'm tempted to say so far Jabber conformance didn't require
</I>&gt;<i> 	validity conformance. And without DTD loading you have no way
</I>&gt;<i> 	(unless you start adding internal subset, but I doubt anybody wants
</I>&gt;<i> 	to go that route) to know that something is an ID.
</I>&gt;<i> 
</I>&gt;<i>   I'm all for clarity and cleannes w.r.t. the specifications, but make sure
</I>&gt;<i> you understand them really well before building rules on top of them.
</I>&gt;<i> 
</I>
Right now, there's nothing to base validity off of, but we do plan on 
eventually having schemas some day, which is why I brought it up.


&gt;<i> 
</I>&gt;&gt;<i>Second, namespaces. Contrary to what some people believe, Jabber's usage 
</I>&gt;&gt;<i>of namespaces conforms with the specification. &lt;x&gt; and &lt;query&gt; are 
</I>&gt;&gt;<i>actually a parent element of everything within in the same namespace. 
</I>&gt;&gt;<i>Schemas will conform with this statement. The &quot;problem&quot; is that current 
</I>&gt;&gt;<i>Jabber implementations do not fully support namespaces via Qualified 
</I>&gt;&gt;<i>Names. (Such as &lt;last:query xmlns:last=&quot;jabber:iq:last&quot;&gt; and then being 
</I>&gt;&gt;<i>able to use last: thereafter) - However, there is NOTHING WRONG with 
</I>&gt;&gt;<i>Jabber being even more restrictive than the XML Namespaces 
</I>&gt;&gt;<i>Recommendation. I feel that we should continue to enforce the fact that 
</I>&gt;&gt;<i>jabber:x: and jabber:iq: namespaces within jabber:client are only 
</I>&gt;&gt;<i>allowed in certain places (&lt;x&gt; within &lt;message&gt; and &lt;presence&gt;, &lt;query&gt; 
</I>&gt;&gt;<i>within &lt;iq&gt; and so on). If the protocol remains strict here, Jabber 
</I>&gt;&gt;<i>implementations will not have as much to compensate for and can be much 
</I>&gt;&gt;<i>better optimized. It's also much easier to program when you expect 
</I>&gt;&gt;<i>namespaces to always use certain element names in certain places. Again 
</I>&gt;&gt;<i>I stress that this does not break the XML Namespaces Recommendation in 
</I>&gt;&gt;<i>any fashion, we are simply adding additional restrictions to Jabber.
</I>&gt;&gt;<i>
</I>&gt;<i> 
</I>&gt;<i>   Right, but adding this restriction can pose a serious problem, depending
</I>&gt;<i> on the tools you are using. It all depends what conformance level you
</I>&gt;<i> want to add to this. If Jabber requires it then any client based
</I>&gt;<i> on a DOM api may have troubles. The DOM serializer may remap the prefix,
</I>&gt;<i> more precisely when one create a node only the namespace name and the
</I>&gt;<i> node CNAME are really binding, the prefixes may be &quot;cleaned up&quot; when
</I>&gt;<i> the documents/nodes are serialized. So this approach *can* have drawbacks.
</I>&gt;<i> And if you think that the documents are better produced with just a bunch
</I>&gt;<i> of printf() you should not get surprized if clients tends to break the
</I>&gt;<i> encoding rules as soon as characters outside of the ascii range starts
</I>&gt;<i> to get used.
</I>&gt;<i>   Contrary to what you seems to think this kind of decisions have a cost,
</I>&gt;<i> and may actually result in having poorly conformants clients. Not something
</I>&gt;<i> I would argue as a Good Thing...
</I>&gt;<i>
</I>
Hrmm, I see what you're saying. So you feel there's nothing wrong with 
requiring clients and servers to support prefixes? I'm just under the 
impression that things like palm clients will have difficulty with that, 
  moreso than it would be difficult to require they not be used... 
Correct me if I'm wrong ;)

Are there really that many XML Namespaces-conforming parsers which will randomly
start using prefixes which cannot be turned off? From my point of view, it's more
difficult for many parts of jabber to support prefixes. Servers will have to keep
track of all the prefixes a client uses... because a client could declare a prefix
when sending to one person and use it in a message to another, so the server will
have to tack the xmlns:prefix definition on the packets sent to other people.
Prefixes also hurt stream compression and any routing optimizations since the tag
names could be virtually anything (There has already been some work on routing
optimization since the basic structure of most Jabber packets is very similar - it
would be somewhat negated by having to support namespace prefixes, and I get the
feeling that SSL compression won't be as effective when prefixes are changing). So
from my point of view it seems easier and more efficient to not allow prefixes. I
know in Gabber it will take a major overhaul of Jabberoo and Gabber to properly
support prefixes. Also, are XML Namespace-conforming parsers available everywhere we
have Jabber clients right now? I know it could be argued that the existing XML
parsers should be made XML Namespace-conforming, but it's an additional argument
against it in Jabber.

No, I don't think printf() is the way to go ;) - I do want conforming parsers, but it
may be possible for us to get away with not requiring a fully Namespace-conforming
parser...

Julian
-- 
email: <A HREF="http://mail.jabber.org/mailman/listinfo/jdev">julian at jabber.org</A>
jabber:<A HREF="http://mail.jabber.org/mailman/listinfo/jdev">julian at jabber.org</A>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="069454.html">[JDEV] jabber over ipv6
</A></li>
	<LI>Next message: <A HREF="069467.html">[standards-jig] Re: [JDEV] XML Conformance
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#69462">[ date ]</a>
              <a href="thread.html#69462">[ thread ]</a>
              <a href="subject.html#69462">[ subject ]</a>
              <a href="author.html#69462">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://mail.jabber.org/mailman/listinfo/jdev">More information about the JDev
mailing list</a><br>
</body></html>
