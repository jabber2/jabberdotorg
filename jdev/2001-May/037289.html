<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [JDEV] JabberCOM c++ sample
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:jdev%40jabber.org?Subject=Re%3A%20%5BJDEV%5D%20JabberCOM%20c%2B%2B%20sample&In-Reply-To=%3CFF2AF4D762A0D3119E86009027C39A060BBA4BD0%40sea-ex0.starwave.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="037301.html">
   <LINK REL="Next"  HREF="037294.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[JDEV] JabberCOM c++ sample</H1>
    <B>Robert Temple</B> 
    <A HREF="mailto:jdev%40jabber.org?Subject=Re%3A%20%5BJDEV%5D%20JabberCOM%20c%2B%2B%20sample&In-Reply-To=%3CFF2AF4D762A0D3119E86009027C39A060BBA4BD0%40sea-ex0.starwave.com%3E"
       TITLE="[JDEV] JabberCOM c++ sample">robert.temple at dig.com
       </A><BR>
    <I>Wed May 23 19:59:58 CDT 2001</I>
    <P><UL>
        <LI>Previous message: <A HREF="037301.html">[JDEV] Multiple logins
</A></li>
        <LI>Next message: <A HREF="037294.html">[JDEV] Handling Undeliverable Messages
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#37289">[ date ]</a>
              <a href="thread.html#37289">[ thread ]</a>
              <a href="subject.html#37289">[ subject ]</a>
              <a href="author.html#37289">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Sorry, thats not my project.  Never heard of it.

-Robert

&gt;<i> -----Original Message-----
</I>&gt;<i> From: Dai Jin [mailto:<A HREF="http://mail.jabber.org/mailman/listinfo/jdev">dai_jin at email.com.cn</A>]
</I>&gt;<i> Sent: Wednesday, May 23, 2001 5:24 PM
</I>&gt;<i> To: <A HREF="http://mail.jabber.org/mailman/listinfo/jdev">jdev at jabber.org</A>
</I>&gt;<i> Subject: Re: RE: [JDEV] JabberCOM c++ sample
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> Hello, Robert Temple,
</I>&gt;<i> 
</I>&gt;<i>     I have imitated your jabbin project. When i inherit from 
</I>&gt;<i> a CDocument
</I>&gt;<i> class, it run. But when i inherit from a CDialog class, it can't run.
</I>&gt;<i> Can u give me some help?
</I>&gt;<i> 
</I>&gt;<i> Best Regard,
</I>&gt;<i> Jim
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> // JabberDlg.cpp : implementation file
</I>&gt;<i> //
</I>&gt;<i> 
</I>&gt;<i> #include &quot;stdafx.h&quot;
</I>&gt;<i> #include &quot;Jabber.h&quot;
</I>&gt;<i> #include &quot;JabberDlg.h&quot;
</I>&gt;<i> 
</I>&gt;<i> #ifdef _DEBUG
</I>&gt;<i> #define new DEBUG_NEW
</I>&gt;<i> #undef THIS_FILE
</I>&gt;<i> static char THIS_FILE[] = __FILE__;
</I>&gt;<i> #endif
</I>&gt;<i> 
</I>&gt;<i> #define MIN_TRACK_WIDTH				120
</I>&gt;<i> #define MIN_TRACK_LENGTH			180
</I>&gt;<i> 
</I>&gt;<i> //////////////////////////////////////////////////////////////
</I>&gt;<i> ///////////////
</I>&gt;<i> // CAboutDlg dialog used for App About
</I>&gt;<i> 
</I>&gt;<i> class CAboutDlg : public CDialog
</I>&gt;<i> {
</I>&gt;<i> public:
</I>&gt;<i> 	CAboutDlg();
</I>&gt;<i> 
</I>&gt;<i> // Dialog Data
</I>&gt;<i> 	//{{AFX_DATA(CAboutDlg)
</I>&gt;<i> 	enum { IDD = IDD_ABOUTBOX };
</I>&gt;<i> 	//}}AFX_DATA
</I>&gt;<i> 
</I>&gt;<i> 	// ClassWizard generated virtual function overrides
</I>&gt;<i> 	//{{AFX_VIRTUAL(CAboutDlg)
</I>&gt;<i> 	protected:
</I>&gt;<i> 	virtual void DoDataExchange(CDataExchange* pDX);    // 
</I>&gt;<i> DDX/DDV support
</I>&gt;<i> 	//}}AFX_VIRTUAL
</I>&gt;<i> 
</I>&gt;<i> // Implementation
</I>&gt;<i> protected:
</I>&gt;<i> 	//{{AFX_MSG(CAboutDlg)
</I>&gt;<i> 	//}}AFX_MSG
</I>&gt;<i> 	DECLARE_MESSAGE_MAP()
</I>&gt;<i> };
</I>&gt;<i> 
</I>&gt;<i> CAboutDlg::CAboutDlg() : CDialog(CAboutDlg::IDD)
</I>&gt;<i> {
</I>&gt;<i> 	//{{AFX_DATA_INIT(CAboutDlg)
</I>&gt;<i> 	//}}AFX_DATA_INIT
</I>&gt;<i> }
</I>&gt;<i> 
</I>&gt;<i> void CAboutDlg::DoDataExchange(CDataExchange* pDX)
</I>&gt;<i> {
</I>&gt;<i> 	CDialog::DoDataExchange(pDX);
</I>&gt;<i> 	//{{AFX_DATA_MAP(CAboutDlg)
</I>&gt;<i> 	//}}AFX_DATA_MAP
</I>&gt;<i> }
</I>&gt;<i> 
</I>&gt;<i> BEGIN_MESSAGE_MAP(CAboutDlg, CDialog)
</I>&gt;<i> 	//{{AFX_MSG_MAP(CAboutDlg)
</I>&gt;<i> 		// No message handlers
</I>&gt;<i> 	//}}AFX_MSG_MAP
</I>&gt;<i> END_MESSAGE_MAP()
</I>&gt;<i> 
</I>&gt;<i> //////////////////////////////////////////////////////////////
</I>&gt;<i> ///////////////
</I>&gt;<i> // CJabberDlg dialog
</I>&gt;<i> 
</I>&gt;<i> CJabberDlg::CJabberDlg(CWnd* pParent /*=NULL*/)
</I>&gt;<i> 	: CDialog(CJabberDlg::IDD, pParent)
</I>&gt;<i> {
</I>&gt;<i> 	//{{AFX_DATA_INIT(CJabberDlg)
</I>&gt;<i> 		// NOTE: the ClassWizard will add member 
</I>&gt;<i> initialization here
</I>&gt;<i> 	//}}AFX_DATA_INIT
</I>&gt;<i> 	// Note that LoadIcon does not require a subsequent 
</I>&gt;<i> DestroyIcon in Win32
</I>&gt;<i> 	m_hIcon = AfxGetApp()-&gt;LoadIcon(IDR_MAINFRAME);
</I>&gt;<i> 
</I>&gt;<i> 	HRESULT hr = CoInitialize(NULL);
</I>&gt;<i> 	ASSERT(SUCCEEDED(hr));
</I>&gt;<i> 
</I>&gt;<i> 	hr = spJabberSession.CreateInstance(__uuidof(JabberSession));
</I>&gt;<i> 	ASSERT(SUCCEEDED(hr));
</I>&gt;<i> 
</I>&gt;<i> 	// &#36830;&#25509;Jabber&#26381;&#21153;&#22120;
</I>&gt;<i> 	ConnectSink();
</I>&gt;<i> }
</I>&gt;<i> 
</I>&gt;<i> void CJabberDlg::DoDataExchange(CDataExchange* pDX)
</I>&gt;<i> {
</I>&gt;<i> 	CDialog::DoDataExchange(pDX);
</I>&gt;<i> 	//{{AFX_DATA_MAP(CJabberDlg)
</I>&gt;<i> 		// NOTE: the ClassWizard will add DDX and DDV calls here
</I>&gt;<i> 	//}}AFX_DATA_MAP
</I>&gt;<i> }
</I>&gt;<i> 
</I>&gt;<i> BEGIN_DISPATCH_MAP(CJabberDlg, CDialog)
</I>&gt;<i> 	//{{AFX_DISPATCH_MAP(CJabberDlg)
</I>&gt;<i> 	DISP_FUNCTION(CJabberDlg, &quot;OnConnect&quot;,               
</I>&gt;<i> OnConnect,               VT_EMPTY, VTS_NONE)
</I>&gt;<i> 	DISP_FUNCTION(CJabberDlg, &quot;OnDisconnect&quot;,            
</I>&gt;<i> OnDisconnect,            VT_EMPTY, VTS_NONE)
</I>&gt;<i> 	DISP_FUNCTION(CJabberDlg, &quot;OnAuthError&quot;,             
</I>&gt;<i> OnAuthError,             VT_EMPTY, VTS_BSTR)
</I>&gt;<i> 	DISP_FUNCTION(CJabberDlg, &quot;OnCommError&quot;,             
</I>&gt;<i> OnCommError,             VT_EMPTY, VTS_BSTR)
</I>&gt;<i> 	DISP_FUNCTION(CJabberDlg, &quot;OnQueryError&quot;,            
</I>&gt;<i> OnQueryError,            VT_EMPTY, VTS_BSTR VTS_BSTR VTS_DISPATCH)
</I>&gt;<i> 	DISP_FUNCTION(CJabberDlg, &quot;OnRosterStart&quot;,           
</I>&gt;<i> OnRosterStart,           VT_EMPTY, VTS_NONE)
</I>&gt;<i> 	DISP_FUNCTION(CJabberDlg, &quot;OnRosterItem&quot;,            
</I>&gt;<i> OnRosterItem,            VT_EMPTY, VTS_DISPATCH)
</I>&gt;<i> 	DISP_FUNCTION(CJabberDlg, &quot;OnRosterEnd&quot;,             
</I>&gt;<i> OnRosterEnd,             VT_EMPTY, VTS_NONE)
</I>&gt;<i> 	DISP_FUNCTION(CJabberDlg, &quot;OnMessage&quot;,               
</I>&gt;<i> OnMessage,               VT_EMPTY, VTS_DISPATCH VTS_DISPATCH)
</I>&gt;<i> 	DISP_FUNCTION(CJabberDlg, &quot;OnPresence&quot;,              
</I>&gt;<i> OnPresence,              VT_EMPTY, VTS_BSTR VTS_BOOL VTS_BSTR 
</I>&gt;<i> VTS_BOOL VTS_DISPATCH)
</I>&gt;<i> 	DISP_FUNCTION(CJabberDlg, &quot;OnSubscriptionRequest&quot;,   
</I>&gt;<i> OnSubscriptionRequest,   VT_EMPTY, VTS_BSTR VTS_BSTR VTS_BSTR)
</I>&gt;<i> 	DISP_FUNCTION(CJabberDlg, &quot;OnSubscriptionApproved&quot;,  
</I>&gt;<i> OnSubscriptionApproved,  VT_EMPTY, VTS_BSTR VTS_BSTR)
</I>&gt;<i> 	DISP_FUNCTION(CJabberDlg, &quot;OnSubscriptionDenied&quot;,    
</I>&gt;<i> OnSubscriptionDenied,    VT_EMPTY, VTS_BSTR VTS_BSTR)
</I>&gt;<i> 	DISP_FUNCTION(CJabberDlg, &quot;OnXML&quot;,                   
</I>&gt;<i> OnXML,                   VT_EMPTY, VTS_I4 VTS_BSTR)
</I>&gt;<i> 	DISP_FUNCTION(CJabberDlg, &quot;OnJabberIQ&quot;,              
</I>&gt;<i> OnJabberIQ,              VT_EMPTY, VTS_BSTR VTS_DISPATCH)
</I>&gt;<i> 	DISP_FUNCTION(CJabberDlg, &quot;OnUnhandledQuery&quot;,        
</I>&gt;<i> OnUnhandledQuery,        VT_EMPTY, VTS_BSTR VTS_DISPATCH)
</I>&gt;<i> 	DISP_FUNCTION(CJabberDlg, &quot;OnAgentsStart&quot;,           
</I>&gt;<i> OnAgentsStart,           VT_EMPTY, VTS_NONE)
</I>&gt;<i> 	DISP_FUNCTION(CJabberDlg, &quot;OnAgentItem&quot;,             
</I>&gt;<i> OnAgentItem,             VT_EMPTY, VTS_DISPATCH VTS_BSTR)
</I>&gt;<i> 	DISP_FUNCTION(CJabberDlg, &quot;OnAgentsEnd&quot;,             
</I>&gt;<i> OnAgentsEnd,             VT_EMPTY, VTS_NONE)
</I>&gt;<i> 	DISP_FUNCTION(CJabberDlg, &quot;OnXMLTag&quot;,                
</I>&gt;<i> OnXMLTag,                VT_EMPTY, VTS_DISPATCH)
</I>&gt;<i> 	DISP_FUNCTION(CJabberDlg, &quot;OnVersionGet&quot;,            
</I>&gt;<i> OnVersionGet,            VT_EMPTY, VTS_BSTR VTS_DISPATCH)
</I>&gt;<i> 	DISP_FUNCTION(CJabberDlg, &quot;OnTimeGet&quot;,               
</I>&gt;<i> OnTimeGet,               VT_EMPTY, VTS_BSTR VTS_DISPATCH)
</I>&gt;<i> 	DISP_FUNCTION(CJabberDlg, &quot;OnGetOOB&quot;,                
</I>&gt;<i> OnGetOOB,                VT_EMPTY, VTS_BSTR VTS_BSTR VTS_BSTR 
</I>&gt;<i> VTS_DISPATCH)
</I>&gt;<i> 	//}}AFX_DISPATCH_MAP
</I>&gt;<i> END_DISPATCH_MAP()
</I>&gt;<i> 
</I>&gt;<i> BEGIN_INTERFACE_MAP(CJabberDlg, CDialog)
</I>&gt;<i> 	INTERFACE_PART(CJabberDlg, 
</I>&gt;<i> __uuidof(IJabberSessionEvents), Dispatch)
</I>&gt;<i> END_INTERFACE_MAP()
</I>&gt;<i> 
</I>&gt;<i> BEGIN_MESSAGE_MAP(CJabberDlg, CDialog)
</I>&gt;<i> 	//{{AFX_MSG_MAP(CJabberDlg)
</I>&gt;<i> 	ON_WM_SYSCOMMAND()
</I>&gt;<i> 	ON_WM_PAINT()
</I>&gt;<i> 	ON_WM_QUERYDRAGICON()
</I>&gt;<i> 	ON_WM_GETMINMAXINFO()
</I>&gt;<i> 	ON_WM_CLOSE()
</I>&gt;<i> 	//}}AFX_MSG_MAP
</I>&gt;<i> END_MESSAGE_MAP()
</I>&gt;<i> 
</I>&gt;<i> //////////////////////////////////////////////////////////////
</I>&gt;<i> ///////////////
</I>&gt;<i> // CJabberDlg message handlers
</I>&gt;<i> 
</I>&gt;<i> BOOL CJabberDlg::OnInitDialog()
</I>&gt;<i> {
</I>&gt;<i> 	CDialog::OnInitDialog();
</I>&gt;<i> 
</I>&gt;<i> 	// Add &quot;About...&quot; menu item to system menu.
</I>&gt;<i> 
</I>&gt;<i> 	// IDM_ABOUTBOX must be in the system command range.
</I>&gt;<i> 	ASSERT((IDM_ABOUTBOX &amp; 0xFFF0) == IDM_ABOUTBOX);
</I>&gt;<i> 	ASSERT(IDM_ABOUTBOX &lt; 0xF000);
</I>&gt;<i> 
</I>&gt;<i> 	CMenu* pSysMenu = GetSystemMenu(FALSE);
</I>&gt;<i> 	if (pSysMenu != NULL)
</I>&gt;<i> 	{
</I>&gt;<i> 		CString strAboutMenu;
</I>&gt;<i> 		strAboutMenu.LoadString(IDS_ABOUTBOX);
</I>&gt;<i> 		if (!strAboutMenu.IsEmpty())
</I>&gt;<i> 		{
</I>&gt;<i> 			pSysMenu-&gt;AppendMenu(MF_SEPARATOR);
</I>&gt;<i> 			pSysMenu-&gt;AppendMenu(MF_STRING, 
</I>&gt;<i> IDM_ABOUTBOX, strAboutMenu);
</I>&gt;<i> 		}
</I>&gt;<i> 	}
</I>&gt;<i> 
</I>&gt;<i> 	// Set the icon for this dialog.  The framework does 
</I>&gt;<i> this automatically
</I>&gt;<i> 	//  when the application's main window is not a dialog
</I>&gt;<i> 	SetIcon(m_hIcon, TRUE);			// Set big icon
</I>&gt;<i> 	SetIcon(m_hIcon, FALSE);		// Set small icon
</I>&gt;<i> 	
</I>&gt;<i> 	// TODO: Add extra initialization here
</I>&gt;<i> 	m_sJabberID = m_sUsername + '@' + m_sServer;
</I>&gt;<i> 
</I>&gt;<i> 	Connect();
</I>&gt;<i> 
</I>&gt;<i> 	return TRUE;  // return TRUE  unless you set the focus 
</I>&gt;<i> to a control
</I>&gt;<i> }
</I>&gt;<i> 
</I>&gt;<i> void CJabberDlg::OnSysCommand(UINT nID, LPARAM lParam)
</I>&gt;<i> {
</I>&gt;<i> 	if ((nID &amp; 0xFFF0) == IDM_ABOUTBOX)
</I>&gt;<i> 	{
</I>&gt;<i> 		CAboutDlg dlgAbout;
</I>&gt;<i> 		dlgAbout.DoModal();
</I>&gt;<i> 	}
</I>&gt;<i> 	else
</I>&gt;<i> 	{
</I>&gt;<i> 		CDialog::OnSysCommand(nID, lParam);
</I>&gt;<i> 	}
</I>&gt;<i> }
</I>&gt;<i> 
</I>&gt;<i> // If you add a minimize button to your dialog, you will need 
</I>&gt;<i> the code below
</I>&gt;<i> //  to draw the icon.  For MFC applications using the 
</I>&gt;<i> document/view model,
</I>&gt;<i> //  this is automatically done for you by the framework.
</I>&gt;<i> 
</I>&gt;<i> void CJabberDlg::OnPaint() 
</I>&gt;<i> {
</I>&gt;<i> 	if (IsIconic())
</I>&gt;<i> 	{
</I>&gt;<i> 		CPaintDC dc(this); // device context for painting
</I>&gt;<i> 
</I>&gt;<i> 		SendMessage(WM_ICONERASEBKGND, (WPARAM) 
</I>&gt;<i> dc.GetSafeHdc(), 0);
</I>&gt;<i> 
</I>&gt;<i> 		// Center icon in client rectangle
</I>&gt;<i> 		int cxIcon = GetSystemMetrics(SM_CXICON);
</I>&gt;<i> 		int cyIcon = GetSystemMetrics(SM_CYICON);
</I>&gt;<i> 		CRect rect;
</I>&gt;<i> 		GetClientRect(&amp;rect);
</I>&gt;<i> 		int x = (rect.Width() - cxIcon + 1) / 2;
</I>&gt;<i> 		int y = (rect.Height() - cyIcon + 1) / 2;
</I>&gt;<i> 
</I>&gt;<i> 		// Draw the icon
</I>&gt;<i> 		dc.DrawIcon(x, y, m_hIcon);
</I>&gt;<i> 	}
</I>&gt;<i> 	else
</I>&gt;<i> 	{
</I>&gt;<i> 		CDialog::OnPaint();
</I>&gt;<i> 	}
</I>&gt;<i> }
</I>&gt;<i> 
</I>&gt;<i> // The system calls this to obtain the cursor to display 
</I>&gt;<i> while the user drags
</I>&gt;<i> //  the minimized window.
</I>&gt;<i> HCURSOR CJabberDlg::OnQueryDragIcon()
</I>&gt;<i> {
</I>&gt;<i> 	return (HCURSOR) m_hIcon;
</I>&gt;<i> }
</I>&gt;<i> 
</I>&gt;<i> void CJabberDlg::OnGetMinMaxInfo(MINMAXINFO FAR* lpMMI) 
</I>&gt;<i> {
</I>&gt;<i> 	// TODO: Add your message handler code here and/or call default
</I>&gt;<i> 	lpMMI-&gt;ptMinTrackSize.x = MIN_TRACK_WIDTH;
</I>&gt;<i> 	lpMMI-&gt;ptMinTrackSize.y = MIN_TRACK_LENGTH;
</I>&gt;<i> 	
</I>&gt;<i> 	CDialog::OnGetMinMaxInfo(lpMMI);
</I>&gt;<i> }
</I>&gt;<i> 
</I>&gt;<i> BOOL CJabberDlg::PreTranslateMessage(MSG* pMsg) 
</I>&gt;<i> {
</I>&gt;<i> 	// TODO: Add your specialized code here and/or call the 
</I>&gt;<i> base class
</I>&gt;<i> 	if ((pMsg-&gt;message == WM_KEYDOWN) &amp;&amp; 
</I>&gt;<i> 		(pMsg-&gt;wParam == VK_RETURN || pMsg-&gt;wParam == 
</I>&gt;<i> VK_ESCAPE))
</I>&gt;<i> 	{
</I>&gt;<i> 		return TRUE;
</I>&gt;<i> 	}
</I>&gt;<i> 	
</I>&gt;<i> 	return CDialog::PreTranslateMessage(pMsg);
</I>&gt;<i> }
</I>&gt;<i> 
</I>&gt;<i> void CJabberDlg::ConnectSink()
</I>&gt;<i> {
</I>&gt;<i> 	// &#24471;&#21040;JabberSession&#32452;&#20214;&#30340;IDispatch&#25509;&#21475;&#25351;&#38024;
</I>&gt;<i> 	IUnknown* pUnkSink = GetIDispatch(FALSE);
</I>&gt;<i> 	// &#19982;&#20107;&#20214;&#25509;&#21463;&#22120;&#24314;&#31435;&#36830;&#25509;
</I>&gt;<i> 	BOOL bSucceed = AfxConnectionAdvise(spJabberSession, 
</I>&gt;<i> 								
</I>&gt;<i> 		__uuidof(IJabberSessionEvents), 
</I>&gt;<i> 								
</I>&gt;<i> 		pUnkSink, FALSE, &amp;m_dwCookie);
</I>&gt;<i> 	ASSERT(bSucceed);
</I>&gt;<i> }
</I>&gt;<i> 
</I>&gt;<i> void CJabberDlg::DisConnectSink()
</I>&gt;<i> {
</I>&gt;<i> 	// &#24471;&#21040;JabberSession&#32452;&#20214;&#30340;IDispatch&#25509;&#21475;&#25351;&#38024;
</I>&gt;<i> 	IUnknown* pUnkSink = GetIDispatch(FALSE);
</I>&gt;<i> 	// &#19982;&#20107;&#20214;&#25509;&#21463;&#22120;&#24314;&#31435;&#36830;&#25509;
</I>&gt;<i> 	BOOL bSucceed = AfxConnectionUnadvise(spJabberSession,
</I>&gt;<i> 								
</I>&gt;<i> 		  __uuidof(IJabberSessionEvents),
</I>&gt;<i> 								
</I>&gt;<i> 		  pUnkSink, FALSE, m_dwCookie);
</I>&gt;<i> 	ASSERT(bSucceed);
</I>&gt;<i> }
</I>&gt;<i> 
</I>&gt;<i> void CJabberDlg::OnConnect()
</I>&gt;<i> {
</I>&gt;<i> 	MessageBox(&quot;OK&quot;);
</I>&gt;<i> }
</I>&gt;<i> 
</I>&gt;<i> void CJabberDlg::OnDisconnect()
</I>&gt;<i> {
</I>&gt;<i> }
</I>&gt;<i> 
</I>&gt;<i> void CJabberDlg::OnAuthError(LPSTR pTxt)
</I>&gt;<i> {
</I>&gt;<i> }
</I>&gt;<i> 
</I>&gt;<i> void CJabberDlg::OnCommError(LPSTR PTxt)
</I>&gt;<i> {
</I>&gt;<i> }
</I>&gt;<i> 
</I>&gt;<i> void CJabberDlg::OnQueryError(LPSTR PTxt, LPSTR fromjid, 
</I>&gt;<i> IXMLTagPtr tag)
</I>&gt;<i> {
</I>&gt;<i> }
</I>&gt;<i> 
</I>&gt;<i> void CJabberDlg::OnRosterStart()
</I>&gt;<i> {
</I>&gt;<i> }
</I>&gt;<i> 
</I>&gt;<i> void CJabberDlg::OnRosterItem(IJabberRosterItemPtr item)
</I>&gt;<i> {
</I>&gt;<i> }
</I>&gt;<i> 
</I>&gt;<i> void CJabberDlg::OnRosterEnd()
</I>&gt;<i> {
</I>&gt;<i> }
</I>&gt;<i> 
</I>&gt;<i> void CJabberDlg::OnMessage(IJabberMsgPtr msg, IXMLTagPtr tag)
</I>&gt;<i> {
</I>&gt;<i> }
</I>&gt;<i> 
</I>&gt;<i> void CJabberDlg::OnPresence(LPSTR presJID, BOOL available, 
</I>&gt;<i> LPSTR status, BOOL inRoster, IXMLTagPtr tag)
</I>&gt;<i> {
</I>&gt;<i> }
</I>&gt;<i> 
</I>&gt;<i> void CJabberDlg::OnSubscriptionRequest(LPSTR fromJID, LPSTR 
</I>&gt;<i> subType, LPSTR status)
</I>&gt;<i> {
</I>&gt;<i> }
</I>&gt;<i> 
</I>&gt;<i> void CJabberDlg::OnSubscriptionApproved(LPSTR fromJID, LPSTR status)
</I>&gt;<i> {
</I>&gt;<i> }
</I>&gt;<i> 
</I>&gt;<i> void CJabberDlg::OnSubscriptionDenied(LPSTR fromJID, LPSTR status)
</I>&gt;<i> {
</I>&gt;<i> }
</I>&gt;<i> 
</I>&gt;<i> void CJabberDlg::OnXML(long direction, LPSTR txt)
</I>&gt;<i> {
</I>&gt;<i> }
</I>&gt;<i> 
</I>&gt;<i> void CJabberDlg::OnJabberIQ(LPSTR nameSpace, IJabberIQPtr iq)
</I>&gt;<i> {
</I>&gt;<i> }
</I>&gt;<i> 
</I>&gt;<i> void CJabberDlg::OnUnhandledQuery(LPSTR nameSpace, IXMLTagPtr tag)
</I>&gt;<i> {
</I>&gt;<i> }
</I>&gt;<i> 
</I>&gt;<i> void CJabberDlg::OnAgentsStart()
</I>&gt;<i> {
</I>&gt;<i> }
</I>&gt;<i> 
</I>&gt;<i> void CJabberDlg::OnAgentItem(IJabberAgentItemPtr agent, LPSTR iqID)
</I>&gt;<i> {
</I>&gt;<i> }
</I>&gt;<i> 
</I>&gt;<i> void CJabberDlg::OnAgentsEnd()
</I>&gt;<i> {
</I>&gt;<i> }
</I>&gt;<i> 
</I>&gt;<i> void CJabberDlg::OnXMLTag(IXMLTagPtr Tag)
</I>&gt;<i> {
</I>&gt;<i> }
</I>&gt;<i> 
</I>&gt;<i> void CJabberDlg::OnVersionGet(LPSTR fromJID, IXMLTagPtr Tag)
</I>&gt;<i> {
</I>&gt;<i> }
</I>&gt;<i> 
</I>&gt;<i> void CJabberDlg::OnTimeGet(LPSTR fromJID, IXMLTagPtr Tag)
</I>&gt;<i> {
</I>&gt;<i> }
</I>&gt;<i> 
</I>&gt;<i> void CJabberDlg::OnGetOOB(LPSTR fromJID, LPSTR URL, LPSTR 
</I>&gt;<i> Desc, IXMLTagPtr Tag)
</I>&gt;<i> {
</I>&gt;<i> }
</I>&gt;<i> 
</I>&gt;<i> void CJabberDlg::OnClose() 
</I>&gt;<i> {
</I>&gt;<i> 	// TODO: Add your message handler code here and/or call default
</I>&gt;<i> 	DisConnectSink();
</I>&gt;<i> 	DisConnect();
</I>&gt;<i> 
</I>&gt;<i> 	CoUninitialize();
</I>&gt;<i> 
</I>&gt;<i> 	CDialog::OnClose();
</I>&gt;<i> }
</I>&gt;<i> 
</I>&gt;<i> void CJabberDlg::Connect()
</I>&gt;<i> {
</I>&gt;<i> 	spJabberSession-&gt;PutPassword((LPCSTR)m_sUsername);
</I>&gt;<i> 	spJabberSession-&gt;PutPassword((LPCSTR)m_sPassword);
</I>&gt;<i> 	spJabberSession-&gt;PutServer((LPCSTR)m_sServer);
</I>&gt;<i> 	spJabberSession-&gt;PutPort(5222);
</I>&gt;<i> 	spJabberSession-&gt;DoConnect(VARIANT_FALSE, jatDigest);
</I>&gt;<i> }
</I>&gt;<i> 
</I>&gt;<i> void CJabberDlg::DisConnect()
</I>&gt;<i> {
</I>&gt;<i> 	spJabberSession-&gt;PutAvailable(VARIANT_FALSE);
</I>&gt;<i> 	spJabberSession-&gt;DoDisconnect(VARIANT_FALSE);
</I>&gt;<i> }
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i>             Dai Jin
</I>&gt;<i>             <A HREF="http://mail.jabber.org/mailman/listinfo/jdev">dai_jin at email.com.cn</A>
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> jdev mailing list
</I>&gt;<i> <A HREF="http://mail.jabber.org/mailman/listinfo/jdev">jdev at jabber.org</A>
</I>&gt;<i> <A HREF="http://mailman.jabber.org/listinfo/jdev">http://mailman.jabber.org/listinfo/jdev</A>
</I>&gt;<i> 
</I>
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="037301.html">[JDEV] Multiple logins
</A></li>
	<LI>Next message: <A HREF="037294.html">[JDEV] Handling Undeliverable Messages
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#37289">[ date ]</a>
              <a href="thread.html#37289">[ thread ]</a>
              <a href="subject.html#37289">[ subject ]</a>
              <a href="author.html#37289">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://mail.jabber.org/mailman/listinfo/jdev">More information about the JDev
mailing list</a><br>
</body></html>
