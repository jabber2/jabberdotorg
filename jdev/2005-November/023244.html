<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [jdev] SASL EXTERNAL for s2s in jabberd14
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:jdev%40jabber.org?Subject=%5Bjdev%5D%20SASL%20EXTERNAL%20for%20s2s%20in%20jabberd14&In-Reply-To=200511041559.13552.justin-keyword-jabber.093179%40affinix.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023243.html">
   <LINK REL="Next"  HREF="023245.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[jdev] SASL EXTERNAL for s2s in jabberd14</H1>
    <B>Matthias Wimmer</B> 
    <A HREF="mailto:jdev%40jabber.org?Subject=%5Bjdev%5D%20SASL%20EXTERNAL%20for%20s2s%20in%20jabberd14&In-Reply-To=200511041559.13552.justin-keyword-jabber.093179%40affinix.com"
       TITLE="[jdev] SASL EXTERNAL for s2s in jabberd14">m at tthias.net
       </A><BR>
    <I>Fri Nov  4 18:07:06 CST 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="023243.html">[jdev] SASL EXTERNAL for s2s in jabberd14
</A></li>
        <LI>Next message: <A HREF="023245.html">[jdev] SASL EXTERNAL for s2s in jabberd14
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23244">[ date ]</a>
              <a href="thread.html#23244">[ thread ]</a>
              <a href="subject.html#23244">[ subject ]</a>
              <a href="author.html#23244">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Justin Karneges schrieb:

&gt;<i>On Friday 04 November 2005 15:22, Matthias Wimmer wrote:
</I>&gt;<i>  
</I>&gt;<i>
</I>&gt;&gt;<i>If there is no from attribute, I offer SASL EXTERNAL whenever I can
</I>&gt;&gt;<i>verify the certificate to be valid, doesn't matter for which identity it
</I>&gt;&gt;<i>is valid.
</I>&gt;&gt;<i>If there is a from attribute, I make the same checks as if there is no
</I>&gt;&gt;<i>from attribute, but in addition I check if the content of the from
</I>&gt;&gt;<i>attribute (after stringprep) matches one of the identities in the
</I>&gt;&gt;<i>certificate (after stringprep).
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>With SASL EXTERNAL the client sends the authorization identity in the
</I>&gt;&gt;<i>initial response (base64 encoded as CDATA in the &lt;auth/&gt; element). At
</I>&gt;&gt;<i>that point I recheck the certificate, if it contains the authorization
</I>&gt;&gt;<i>identity and authenticate and authorize this ID (even if it differs from
</I>&gt;&gt;<i>the domain sent in the from attribute).
</I>&gt;&gt;<i>    
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i>Since the authzid overrides the from attribute, what is the purpose of using 
</I>&gt;<i>the from attribute at all?  What problem are you solving with this 
</I>&gt;<i>mini-optimization?
</I>&gt;<i>  
</I>&gt;<i>
</I>I do not want to offer SASL (EXTERNAL), if I already know that it will 
fail. Therefore force the peer not trying to use SASL, which would cause 
the stream to be closed / authentication to fail.
With this optimization, the connecting server can already use dialback 
on the first connection attempt.

You might argue, that all I should check is if I trust the CA of the 
certificate and make my decission based on this. But in reallity I see, 
that it seems to be common, that I get connects with certificates, that 
will fail on the domain check. Due to my logs all servers connecting 
with transport IDs at present use certificates for the server domain, 
not for the transport domain.
If I'd offer SASL to these connects, they'd all try SASL first, that 
would fail and the server would have to reconnect and try dialback.


Tot kijk
     Matthias

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="023243.html">[jdev] SASL EXTERNAL for s2s in jabberd14
</A></li>
	<LI>Next message: <A HREF="023245.html">[jdev] SASL EXTERNAL for s2s in jabberd14
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23244">[ date ]</a>
              <a href="thread.html#23244">[ thread ]</a>
              <a href="subject.html#23244">[ subject ]</a>
              <a href="author.html#23244">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://mail.jabber.org/mailman/listinfo/jdev">More information about the JDev
mailing list</a><br>
</body></html>
