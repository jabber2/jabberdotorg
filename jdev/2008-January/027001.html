<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [jdev] last presence confusion
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:jdev%40jabber.org?Subject=%5Bjdev%5D%20last%20presence%20confusion&In-Reply-To=479A33EA.8050309%40stpeter.im">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="027000.html">
   <LINK REL="Next"  HREF="027011.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[jdev] last presence confusion</H1>
    <B>Justin Karneges</B> 
    <A HREF="mailto:jdev%40jabber.org?Subject=%5Bjdev%5D%20last%20presence%20confusion&In-Reply-To=479A33EA.8050309%40stpeter.im"
       TITLE="[jdev] last presence confusion">justin-keyword-jabber.093179 at affinix.com
       </A><BR>
    <I>Fri Jan 25 13:43:33 CST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="027000.html">[jdev] last presence confusion
</A></li>
        <LI>Next message: <A HREF="027011.html">[jdev] last presence confusion
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27001">[ date ]</a>
              <a href="thread.html#27001">[ thread ]</a>
              <a href="subject.html#27001">[ subject ]</a>
              <a href="author.html#27001">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Friday 25 January 2008 11:09 am, Peter Saint-Andre wrote:
&gt;<i> Maciek Niedzielski wrote:
</I>&gt;<i> &gt; Peter Saint-Andre wrote:
</I>&gt;<i> &gt;&gt; Maciek Niedzielski wrote:
</I>&gt;<i> &gt;&gt;&gt; On Sat, Dec 22, 2007 at 12:23:38PM -0800, Justin Karneges wrote:
</I>&gt;<i> &gt;&gt;&gt;&gt; On Thursday 20 December 2007 2:52 pm, Peter Saint-Andre wrote:
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt; So a nice server will return the last unavailable presence
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt; information (with a Delayed Delivery flag), thus obviating the need
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt; for a flood of jabber:iq:last requests.
</I>&gt;<i> &gt;&gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;&gt; How about emphasizing the first option as a SHOULD?  This would
</I>&gt;<i> &gt;&gt;&gt;&gt; hopefully encourage new servers to always reply, while not causing
</I>&gt;<i> &gt;&gt;&gt;&gt; existing servers to become non-compliant.
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt; On the other hand, usually just 1/3 of my roster is online. So if
</I>&gt;<i> &gt;&gt;&gt; server starts sending presence for all contacts, initial &quot;presence
</I>&gt;<i> &gt;&gt;&gt; flood&quot; from the server increases 3 times.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; So do I take that as an objection to the modified text in rfc3921bis?
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Not an objection. But I am a bit worried by this change when I look at
</I>&gt;<i> &gt; my roster. However, at the same time I know that my roster is most
</I>&gt;<i> &gt; probably not a very typical one. Do we have any stats? What's the
</I>&gt;<i> &gt; percent of offline contacts? And what's typical roster size? Maybe it
</I>&gt;<i> &gt; doesn't matter that presence list increases 3 times if this means
</I>&gt;<i> &gt; increasing from 3 to 9 presence stanzas?
</I>&gt;<i>
</I>&gt;<i> I have 1770 people in my roster, so yes I'm concerned. :)
</I>&gt;<i>
</I>&gt;<i> I'll look up some stats on the jabber.org service to see what the
</I>&gt;<i> average roster size is.
</I>
It seems funny that it should be a concern if all of your contacts are 
available at the same time.  It is possible for it to happen, and your client 
and internet connection shouldn't explode if it does.  However, maybe it is 
best to optimize out the offline contacts, if a presence response from an 
offline contact isn't useful enough to justify the increase in traffic.

My interest in having the server return a presence response for every contact 
was to aid in determining when a client login is &quot;complete&quot;.  Right now 
there's really no way to know when a client is finished receiving an initial 
list of presence.  Clients often want to give the user a notification when 
presence activity changes, but only for changes after the initial list.  Psi 
considers the initial presence list to be received once 10 seconds have 
passed after the roster was received.  This is, of course, not very accurate, 
and when Peter takes more than 10 seconds to login, probably 1000 contacts 
trigger sound events.  However, maybe there's a better solution to the 
initial presence list problem.

That clients may want jabber:iq:last information available for all contacts, 
and without polling for it, is valid, IMO.  It relates very much to the 
desire to have jabber:iq:version information without polling.  I smell a 
push-based solution ahead...

-Justin

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="027000.html">[jdev] last presence confusion
</A></li>
	<LI>Next message: <A HREF="027011.html">[jdev] last presence confusion
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27001">[ date ]</a>
              <a href="thread.html#27001">[ thread ]</a>
              <a href="subject.html#27001">[ subject ]</a>
              <a href="author.html#27001">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://mail.jabber.org/mailman/listinfo/jdev">More information about the JDev
mailing list</a><br>
</body></html>
