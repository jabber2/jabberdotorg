<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [jdev] s2s connections and presence
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:jdev%40jabber.org?Subject=%5Bjdev%5D%20s2s%20connections%20and%20presence&In-Reply-To=5b698f5a0605191020l76c82dfdua761519595186e14%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="024632.html">
   <LINK REL="Next"  HREF="024631.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[jdev] s2s connections and presence</H1>
    <B>Michal vorner Vaner</B> 
    <A HREF="mailto:jdev%40jabber.org?Subject=%5Bjdev%5D%20s2s%20connections%20and%20presence&In-Reply-To=5b698f5a0605191020l76c82dfdua761519595186e14%40mail.gmail.com"
       TITLE="[jdev] s2s connections and presence">michal.vaner at kdemail.net
       </A><BR>
    <I>Fri May 19 13:08:00 CDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="024632.html">[jdev] s2s connections and presence
</A></li>
        <LI>Next message: <A HREF="024631.html">[jdev] Java XMPP libraries
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24633">[ date ]</a>
              <a href="thread.html#24633">[ thread ]</a>
              <a href="subject.html#24633">[ subject ]</a>
              <a href="author.html#24633">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Fri, May 19, 2006 at 07:20:13PM +0200, Norman Rasmussen wrote:
&gt;<i> On 5/19/06, Wendell Turner &lt;<A HREF="http://mail.jabber.org/mailman/listinfo/jdev">wendell at adsi-m4.com</A>&gt; wrote:
</I>&gt;<i> &gt;Question 1:
</I>&gt;<i> &gt;Is this how it is supposed to work?  Is this behavior affected
</I>&gt;<i> &gt;by the queuetimeout or idletimeout in the s2s section of the
</I>&gt;<i> &gt;config file?
</I>&gt;<i> This is how it works at the moment.  (not sure how much it's by design
</I>&gt;<i> choice, or how-it-happens to work)
</I>&gt;<i> 
</I>&gt;<i> &gt;Would other servers (jabberd2, ejabberd) behave differently
</I>&gt;<i> &gt;(i.e., remove the presence indication when s2s tcp connections
</I>&gt;<i> &gt;die)?
</I>&gt;<i> I think they do, yes.
</I>
Well, I guess they can not. Dead connection does not mean the server is
dead and the user is not online. However, I think it could mark the
other contact offline when there is unsuccessful attempt to send a
stanza.

&gt;<i> &gt;Even when romeo tries to send a chat msg, an error is evenutally
</I>&gt;<i> &gt;sent back to the client, yet still the presence doesn't change.
</I>&gt;<i> unfortunately that's the way it is at the moment.
</I>&gt;<i> 
</I>&gt;<i> &gt;Question 2:
</I>&gt;<i> &gt;Both montague.com and capulet.com try to establish tcp
</I>&gt;<i> &gt;connections to each other, but are unsuccessful (Verona's
</I>&gt;<i> &gt;network is down).  When Verona's networks come back up, what
</I>&gt;<i> &gt;mechanism in either server causes presence to 'reconnect'?
</I>&gt;<i> there is none.  (this is probably an implementation consideration,
</I>&gt;<i> most implementations drop the packets, and give up)
</I>
What are they supposed to do? If it is message, they respond by service
unavailable, if iq, then the same. Presence is something that is
broadcasted and the client does not really want to know someone did not
get it.

If the other side just usually crashed/rebooted/whatever, it asks for
the presence once it becomes online itself by a probe.

&gt;<i> &gt;If either romeo or juliet sets their status to offline, then
</I>&gt;<i> &gt;back to online, that triggers the servers to re-try the
</I>&gt;<i> &gt;connections, but will the servers do it by themselves?
</I>&gt;<i> implementation specific, most don't at the moment.
</I>&gt;<i> 
</I>&gt;<i> There's an assumption in the xmpp spec that all servers are 'well 
</I>&gt;<i> connected'.
</I>&gt;<i> 
</I>&gt;<i> If a servers IP changes often (like eg: it's on a 24hr dhcp licence
</I>&gt;<i> via adsl), then there are issues - depending on which servers, how dns
</I>&gt;<i> is set up, etc.
</I>&gt;<i> 
</I>&gt;<i> If links are 'dead' between servers, then the data just doesn't make
</I>&gt;<i> it, and the server state hasn't changed.
</I>&gt;<i> 
</I>
-- 
One semi-random fortune:

Einstein argued that there must be simplified explanations of nature, because
God is not capricious or arbitrary.  No such faith comforts the software
engineer.
                -- Fred Brooks

Michal &quot;vorner&quot; Vaner
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : <A HREF="https://www.jabber.org/jdev/attachments/20060519/03fc5bfb/attachment.pgp">https://www.jabber.org/jdev/attachments/20060519/03fc5bfb/attachment.pgp</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="024632.html">[jdev] s2s connections and presence
</A></li>
	<LI>Next message: <A HREF="024631.html">[jdev] Java XMPP libraries
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24633">[ date ]</a>
              <a href="thread.html#24633">[ thread ]</a>
              <a href="subject.html#24633">[ subject ]</a>
              <a href="author.html#24633">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://mail.jabber.org/mailman/listinfo/jdev">More information about the JDev
mailing list</a><br>
</body></html>
