<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [jdev] customized authentication not working
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:jdev%40jabber.org?Subject=Re%3A%20%5Bjdev%5D%20customized%20authentication%20not%20working&In-Reply-To=%3Cd4jtar%24mm6%241%40sea.gmane.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="080362.html">
   <LINK REL="Next"  HREF="080366.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[jdev] customized authentication not working</H1>
    <B>andrew</B> 
    <A HREF="mailto:jdev%40jabber.org?Subject=Re%3A%20%5Bjdev%5D%20customized%20authentication%20not%20working&In-Reply-To=%3Cd4jtar%24mm6%241%40sea.gmane.org%3E"
       TITLE="[jdev] customized authentication not working">kaspicka at shaw.ca
       </A><BR>
    <I>Mon Apr 25 18:14:24 CDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="080362.html">[jdev] ANN: Jive Messenger 2.1.3
</A></li>
        <LI>Next message: <A HREF="080366.html">[jdev] Please help me update my address book on Ringo
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#80364">[ date ]</a>
              <a href="thread.html#80364">[ thread ]</a>
              <a href="subject.html#80364">[ subject ]</a>
              <a href="author.html#80364">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi there,

I've searched through the archives and found some details pertaining to my 
problem, but couldn't find follow up posts to some peoples questions.

I'm trying to write a component that adds one more step to the 
authentication process.  Along with the user/pass, I want to send a version 
number of the client that I'm using.  If the version number isn't acceptable 
(ie. older and not supported) I want to return an error.

In my jabber.xml I've added the xml for my service and used 
&lt;auth&gt;mycomponentname&lt;/auth&gt; in order to have my component receive auth 
notifications.

I'm using Perl and Net::Jabber and can get the component to successfully 
work with the server (handshake is successful), but I can't get my component 
to handle any jabber:iq:auth messages.

I've tried using both of these methods to trap the message, but neither work 
(I am not using both at the same time)...

$component-&gt;SetCallBacks(iq=&gt;\&amp;iqCB);

$component-&gt;SetIQCallBacks(&quot;jabber:iq:auth&quot;=&gt;{ set =&gt; \&amp;iqCB });

I've added some debug statements to the callback functions, but they never 
show up.  I see the jabber:iq:auth message in the debug info for the 
component wrapped in a &lt;route&gt; tag.  This is some of the output from the 
debug statements of the component...

NJ::Component: CallBack: sid(426D77B0) received(&lt;route from='<A HREF="http://mail.jabber.org/mailman/listinfo/jdev">18 at c2s</A>/8123D70' 
oto='<A HREF="http://mail.jabber.org/mailman/listinfo/jdev">user at host</A>' to='versioncheck' type='auth'&gt;&lt;iq id='j0' type='get'&gt;&lt;query 
xmlns='jabber:iq:auth'&gt;&lt;username&gt;user&lt;/username&gt;&lt;/query&gt;&lt;/iq&gt;&lt;/route&gt;)

NJ::Component: CallBack: sid(426D77B0) received(&lt;route from='<A HREF="http://mail.jabber.org/mailman/listinfo/jdev">18 at c2s</A>/8123D70' 
oto='<A HREF="http://mail.jabber.org/mailman/listinfo/jdev">user at host</A>/Resource' to='versioncheck' type='auth'&gt;&lt;iq id='j1' 
type='set'&gt;&lt;query 
xmlns='jabber:iq:auth'&gt;&lt;username&gt;user&lt;/username&gt;&lt;resource&gt;Resource&lt;/resource&gt;&lt;digest 
sid='426D77BF'&gt;###digestvalue###&lt;/digest&gt;&lt;/query&gt;&lt;/iq&gt;&lt;/route&gt;)

This also appears which seems to be why authentication halts (freezes) on 
the client side...
NJ::Component: CallBack: a packet that no one wants... how sad. =(

Does anybody have any ideas?  Thanks.

Andrew




</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="080362.html">[jdev] ANN: Jive Messenger 2.1.3
</A></li>
	<LI>Next message: <A HREF="080366.html">[jdev] Please help me update my address book on Ringo
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#80364">[ date ]</a>
              <a href="thread.html#80364">[ thread ]</a>
              <a href="subject.html#80364">[ subject ]</a>
              <a href="author.html#80364">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://mail.jabber.org/mailman/listinfo/jdev">More information about the JDev
mailing list</a><br>
</body></html>
