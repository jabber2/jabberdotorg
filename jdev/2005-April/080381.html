<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [jdev] Detecting multiple resource connections
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:jdev%40jabber.org?Subject=Re%3A%20%5Bjdev%5D%20Detecting%20multiple%20resource%20connections&In-Reply-To=%3C20050427112134.GA56743%40ik.nu%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="080380.html">
   <LINK REL="Next"  HREF="080397.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[jdev] Detecting multiple resource connections</H1>
    <B>Ralph Meijer</B> 
    <A HREF="mailto:jdev%40jabber.org?Subject=Re%3A%20%5Bjdev%5D%20Detecting%20multiple%20resource%20connections&In-Reply-To=%3C20050427112134.GA56743%40ik.nu%3E"
       TITLE="[jdev] Detecting multiple resource connections">jabber.org at ralphm.ik.nu
       </A><BR>
    <I>Wed Apr 27 06:21:34 CDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="080380.html">[jdev] Detecting multiple resource connections
</A></li>
        <LI>Next message: <A HREF="080397.html">[jdev] Detecting multiple resource connections
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#80381">[ date ]</a>
              <a href="thread.html#80381">[ thread ]</a>
              <a href="subject.html#80381">[ subject ]</a>
              <a href="author.html#80381">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Wed, Apr 27, 2005 at 01:08:19PM +0200, Jesus Cea wrote:
&gt;<i> I would suggest to &quot;JEP&quot; a non destructive bind. That is, if the 
</I>&gt;<i> resource is already in use, the bind would fail.
</I>&gt;<i> 
</I>&gt;<i> But since a server can be hours with undetected failed connections, 
</I>&gt;<i> perhaps a more sensible approach could be to bind with a random 
</I>&gt;<i> resource, send a stanza to the demanded resource, and if the resource is 
</I>&gt;<i> offline or not answers in X seconds, rebind to it.
</I>
Well, section 7 of RFC 3920, that discusses resource binding, does mention
a way to have the server assign a new resource. That is, you don't request
a specific resource, but the server makes one up for you. Excerpt:

    If the client wishes to allow the server to generate the resource
    identifier on its behalf, it sends an IQ stanza of type &quot;set&quot; that contains
    an empty &lt;bind/&gt; element:

    Client asks server to bind a resource:

        &lt;iq type='set' id='bind_1'&gt;
          &lt;bind xmlns='urn:ietf:params:xml:ns:xmpp-bind'/&gt;
        &lt;/iq&gt;

    A server that supports resource binding MUST be able to generate a resource
    identifier on behalf of a client. A resource identifier generated by the
    server MUST be unique for that &lt;<A HREF="http://mail.jabber.org/mailman/listinfo/jdev">node at domain</A>&gt;.

    If the client wishes to specify the resource identifier, it sends an IQ
    stanza of type &quot;set&quot; that contains the desired resource identifier as the
    XML character data of a &lt;resource/&gt; element that is a child of the &lt;bind/&gt;
    element:

    Client binds a resource:

        &lt;iq type='set' id='bind_2'&gt;
          &lt;bind xmlns='urn:ietf:params:xml:ns:xmpp-bind'&gt;
            &lt;resource&gt;someresource&lt;/resource&gt;
          &lt;/bind&gt;
        &lt;/iq&gt;

    Once the server has generated a resource identifier for the client or
    accepted the resource identifier provided by the client, it MUST return an
    IQ stanza of type &quot;result&quot; to the client, which MUST include a &lt;jid/&gt; child
    element that specifies the full JID for the connected resource as
    determined by the server:

    Server informs client of successful resource binding:

        &lt;iq type='result' id='bind_2'&gt;
          &lt;bind xmlns='urn:ietf:params:xml:ns:xmpp-bind'&gt;
            &lt;jid&gt;<A HREF="http://mail.jabber.org/mailman/listinfo/jdev">somenode at example.com</A>/someresource&lt;/jid&gt;
          &lt;/bind&gt;
        &lt;/iq&gt;

The text further mentions that a client may get an error back when a resource
is already in use, and the server doesn't allow rebinding. There is also some
text about the fact that a server may alter the suggested resource, so the
actual bound resource must always (!) be taken from the resulting iq. It could
be used to just give out another resource, if the requested resource was
already taken

-- 
Groetjes,

ralphm

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="080380.html">[jdev] Detecting multiple resource connections
</A></li>
	<LI>Next message: <A HREF="080397.html">[jdev] Detecting multiple resource connections
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#80381">[ date ]</a>
              <a href="thread.html#80381">[ thread ]</a>
              <a href="subject.html#80381">[ subject ]</a>
              <a href="author.html#80381">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://mail.jabber.org/mailman/listinfo/jdev">More information about the JDev
mailing list</a><br>
</body></html>
