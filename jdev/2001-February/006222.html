<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [JDEV] Parent PID changed, exiting...
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:jdev%40jabber.org?Subject=%5BJDEV%5D%20Parent%20PID%20changed%2C%20exiting...&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="006225.html">
   <LINK REL="Next"  HREF="006223.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[JDEV] Parent PID changed, exiting...</H1>
    <B>Ayite Gaba</B> 
    <A HREF="mailto:jdev%40jabber.org?Subject=%5BJDEV%5D%20Parent%20PID%20changed%2C%20exiting...&In-Reply-To="
       TITLE="[JDEV] Parent PID changed, exiting...">ayite at hotmail.com
       </A><BR>
    <I>Wed Feb 14 06:23:08 CST 2001</I>
    <P><UL>
        <LI>Previous message: <A HREF="006225.html">[JDEV] cons of jabber technology
</A></li>
        <LI>Next message: <A HREF="006223.html">[JDEV] Parent PID changed, exiting...
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6222">[ date ]</a>
              <a href="thread.html#6222">[ thread ]</a>
              <a href="subject.html#6222">[ subject ]</a>
              <a href="author.html#6222">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Keith,
My jabber.xml does not have any &lt;stdout/&gt; tag in it. :(
-- Ayite



&gt;<i>From: Keith Minkler Reply-To: <A HREF="http://mail.jabber.org/mailman/listinfo/jdev">jdev at jabber.org</A> To: <A HREF="http://mail.jabber.org/mailman/listinfo/jdev">jdev at jabber.org</A> Subject: 
</I>&gt;<i>Re: [JDEV] Parent PID changed, exiting... Date: Mon, 12 Feb 2001 23:04:39 
</I>&gt;<i>-0500
</I>&gt;<i>
</I>&gt;<i>No, that function is correct... A jabberd using base_stdout should die when 
</I>&gt;<i>it's parent dies, since the parent will be another jabberd.
</I>&gt;<i>
</I>&gt;<i>Check your config file for the flag... you should not be using this flag in 
</I>&gt;<i>a standalone jabberd.
</I>&gt;<i>
</I>&gt;<i>Keith Minkler
</I>&gt;<i>
</I>&gt;<i>On Tue, Feb 13, 2001 at 02:07:25AM +0000, Ayite Gaba wrote: &gt; Let's me see 
</I>&gt;<i>if i get this right. &gt; To fix the &quot;Parent PID changed&quot; problem i have to 
</I>&gt;<i>modify the body of this &gt; function: result base_stdout_heartbeat(void *arg) 
</I>&gt;<i> &gt; &gt; Is that it? I do not need to modify any other config files? if i still 
</I>&gt;<i>do &gt; have to do more modifications, please let me known which ones. Thanks 
</I>&gt;<i>a lot &gt; for your help, -- Ayite &gt; &gt; &gt; &gt;From: Keith Minkler &gt; &gt;Reply-To: 
</I>&gt;<i><A HREF="http://mail.jabber.org/mailman/listinfo/jdev">jdev at jabber.org</A> &gt; &gt;To: <A HREF="http://mail.jabber.org/mailman/listinfo/jdev">jdev at jabber.org</A> &gt; &gt;Subject: Re: [JDEV] Parent PID 
</I>&gt;<i>changed, exiting... &gt; &gt;Date: Mon, 12 Feb 2001 15:51:58 -0500 &gt; &gt; &gt; &gt;On Mon, 
</I>&gt;<i>Feb 12, 2001 at 01:13:21PM -0600, Thomas Muldowney wrote: &gt; &gt; &gt; It's 
</I>&gt;<i>possible that it's legacy code from 1.2, but I'm not sure. It was &gt; &gt;missed 
</I>&gt;<i> &gt; &gt; &gt; by all of us as jabber.org runs in scripts to capture all the debug 
</I>&gt;<i> &gt; &gt;output, we &gt; &gt; &gt; apologize. &gt; &gt; &gt; &gt; &gt; &gt; --temas &gt; &gt; &gt; &gt;this one has to 
</I>&gt;<i>do with linking two jabberd's together.. it was put in as a &gt; &gt;way &gt; &gt;for 
</I>&gt;<i>the child process to know when it is supposed to exit (when the parent &gt; 
</I>&gt;<i> &gt;process &gt; &gt;exits). &gt; &gt; &gt; &gt;you should ONLY be using a flag in a config 
</I>&gt;<i>file that is to be &gt; &gt;'d &gt; &gt;inside of another PARENT jabberd. &gt; &gt; &gt; &gt;There 
</I>&gt;<i>is another section where it checks it's PID, and that is in dnsrv.. a &gt; 
</I>&gt;<i> &gt;similar &gt; &gt;instance is when dnsrv is used, the process forks itself, to 
</I>&gt;<i>run a child &gt; &gt;dnsrv &gt; &gt;module. This child process also checks it's parent 
</I>&gt;<i>PID to see if it &gt; &gt;changes to 1, &gt; &gt;then exits if it does. &gt; &gt; &gt; &gt;This has 
</I>&gt;<i>worked for some time, and is only meant to happen in those two &gt; &gt;very 
</I>&gt;<i>distinct &gt; &gt;instances.. if you are running a single jabberd, and have a 
</I>&gt;<i>flag &gt; &gt;inside &gt; &gt;of it, then that is WRONG, and you need to take that flag 
</I>&gt;<i>out.. &gt; &gt;that is &gt; &gt;only meant to be used while linking jabberd's together 
</I>&gt;<i>with a config &gt; &gt;section such as: &gt; &gt;./jabberd/jabberd -c ./jabber2.xml &gt; &gt; 
</I>&gt;<i> &gt; &gt;Please check your config for errors, thank you! &gt; &gt; &gt; &gt;also, if there 
</I>&gt;<i>is an easier/better way for a child process to check if its &gt; &gt;parent &gt; 
</I>&gt;<i> &gt;has died, I'd love to change this code... I've looked in a lot of places 
</I>&gt;<i> &gt; &gt;for code &gt; &gt;that accomplishes this, with no luck... this was the best I 
</I>&gt;<i>could do in &gt; &gt;short notice, &gt; &gt;and it fixed all of our &quot;zombie&quot; jabberd 
</I>&gt;<i>problems. &gt; &gt; &gt; &gt;Keith Minkler &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; On Mon, Feb 12, 2001 at 
</I>&gt;<i>09:34:04AM -0800, james rogers wrote: &gt; &gt; &gt; &gt; In the 
</I>&gt;<i>jabber-1.4RC/jabberd/base direcrtory in a file called &gt; &gt;base_stdout.c on 
</I>&gt;<i>line 51 is the function that was added for jabberd version &gt; &gt;1.4 (i.e. not 
</I>&gt;<i>found in jabberd 1.2). This is the function that is needless &gt; &gt;and causing 
</I>&gt;<i>the server to exit when it's parent process is changed.o &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
</I>&gt;<i>Here it is: &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; result base_stdout_heartbeat(void *arg) &gt; &gt; &gt; &gt; 
</I>&gt;<i>{ &gt; &gt; &gt; &gt; static int parent = 0; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; if(parent == 0) parent = 
</I>&gt;<i>getppid(); &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; if(parent != getppid()) &gt; &gt; &gt; &gt; { &gt; &gt; &gt; &gt; /* 
</I>&gt;<i>parent pid has changed, bail */ &gt; &gt; &gt; &gt; log_alert(&quot;stdout&quot;,&quot;Parent PID has 
</I>&gt;<i>changed, Server Exiting&quot;); &gt; &gt; &gt; &gt; exit(1); &gt; &gt; &gt; &gt; } &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
</I>&gt;<i>return r_DONE; &gt; &gt; &gt; &gt; } &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; I am guessing that if we change it 
</I>&gt;<i>to the following that we will keep &gt; &gt;running when we logout of the 
</I>&gt;<i>shell... &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; result base_stdout_heartbeat(void *arg) &gt; &gt; &gt; &gt; { 
</I>&gt;<i> &gt; &gt; &gt; &gt; return r_DONE; &gt; &gt; &gt; &gt; } &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; But before I do this in 
</I>&gt;<i>my own installation... Why was this check &gt; &gt;added? What are we actually 
</I>&gt;<i>checking for here and is there another way to &gt; &gt;do the same check? &gt; &gt; &gt; &gt; 
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; ___________________________________________________ &gt; &gt; &gt; 
</I>&gt;<i> &gt; GO.com Mail &gt; &gt; &gt; &gt; Get Your Free, Private E-mail at <A HREF="http://mail.go.com">http://mail.go.com</A> 
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
</I>&gt;<i>_______________________________________________ &gt; &gt; &gt; &gt; jdev mailing list &gt; 
</I>&gt;<i> &gt; &gt; &gt; <A HREF="http://mail.jabber.org/mailman/listinfo/jdev">jdev at jabber.org</A> &gt; &gt; &gt; &gt; <A HREF="http://mailman.jabber.org/listinfo/jdev">http://mailman.jabber.org/listinfo/jdev</A> &gt; &gt; 
</I>&gt;<i> &gt; &gt; &gt; &gt;&lt;&lt; attach3 &gt;&gt; &gt; &gt; 
</I>&gt;<i>_________________________________________________________________ &gt; Get 
</I>&gt;<i>your FREE download of MSN Explorer at <A HREF="http://explorer.msn.com">http://explorer.msn.com</A> &gt; &gt; &gt; 
</I>&gt;<i>_______________________________________________ &gt; jdev mailing list &gt; 
</I>&gt;<i><A HREF="http://mail.jabber.org/mailman/listinfo/jdev">jdev at jabber.org</A> &gt; <A HREF="http://mailman.jabber.org/listinfo/jdev">http://mailman.jabber.org/listinfo/jdev</A> &lt;&lt; attach3 &gt;&gt;
</I>_________________________________________________________________
Get your FREE download of MSN Explorer at <A HREF="http://explorer.msn.com">http://explorer.msn.com</A>



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="006225.html">[JDEV] cons of jabber technology
</A></li>
	<LI>Next message: <A HREF="006223.html">[JDEV] Parent PID changed, exiting...
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6222">[ date ]</a>
              <a href="thread.html#6222">[ thread ]</a>
              <a href="subject.html#6222">[ subject ]</a>
              <a href="author.html#6222">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://mail.jabber.org/mailman/listinfo/jdev">More information about the JDev
mailing list</a><br>
</body></html>
